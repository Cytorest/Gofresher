!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).firebase=t()}(this,function(){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function e(e,a,s,l){return new(s=s||Promise)(function(n,t){function r(e){try{o(l.next(e))}catch(e){t(e)}}function i(e){try{o(l.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((l=l.apply(e,a||[])).next())})}function i(n,r){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function f(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function a(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}function h(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=h(e[n],t[n]));return e}var o=(t.prototype.wrapCallback=function(n){var r=this;return function(e,t){e?r.reject(e):r.resolve(t),"function"==typeof n&&(r.promise.catch(function(){}),1===n.length?n(e):n(e,t))}},t);function t(){var n=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})}var s,l="FirebaseError",c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(u,s=Error),u);function u(e,t,n){t=s.call(this,t)||this;return t.code=e,t.customData=n,t.name=l,Object.setPrototypeOf(t,u.prototype),Error.captureStackTrace&&Error.captureStackTrace(t,d.prototype.create),t}var d=(v.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=t[0]||{},o=this.service+"/"+e,e=this.errors[e],e=e?(r=i,e.replace(m,function(e,t){var n=r[t];return null!=n?String(n):"<"+t+"?>"})):"Error",e=this.serviceName+": "+e+" ("+o+").";return new c(o,e,i)},v);function v(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var m=/\{\$([^}]+)}/g;function y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function g(e,t){t=new b(e,t);return t.subscribe.bind(t)}var b=(I.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},I.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},I.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},I.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),n},I.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],--this.observerCount,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},I.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},I.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},I.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},I);function I(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}function w(){}var O=(E.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},E.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},E.prototype.setServiceProps=function(e){return this.serviceProps=e,this},E.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},E);function E(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}var _="[DEFAULT]",N=(C.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){e=new o;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{var n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise},C.prototype.getImmediate=function(t){var e=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),t=null!==(t=null==t?void 0:t.optional)&&void 0!==t&&t;if(!this.isInitialized(e)&&!this.shouldAutoInitialize()){if(t)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:e})}catch(e){if(t)return null;throw e}},C.prototype.getComponent=function(){return this.component},C.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:_})}catch(e){}try{for(var r=p(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=f(i.value,2),a=o[0],s=o[1],l=this.normalizeInstanceIdentifier(a);try{var c=this.getOrInitializeService({instanceIdentifier:l});s.resolve(c)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},C.prototype.clearInstance=function(e){this.instancesDeferred.delete(e=void 0===e?_:e),this.instancesOptions.delete(e),this.instances.delete(e)},C.prototype.delete=function(){return e(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(a(a([],f(t.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}))),f(t.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))))];case 1:return e.sent(),[2]}})})},C.prototype.isComponentSet=function(){return null!=this.component},C.prototype.isInitialized=function(e){return this.instances.has(e=void 0===e?_:e)},C.prototype.getOptions=function(e){return this.instancesOptions.get(e=void 0===e?_:e)||{}},C.prototype.initialize=function(e){var t,n,r=(e=void 0===e?{}:e).options,r=void 0===r?{}:r,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(this.name+"("+i+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var o=this.getOrInitializeService({instanceIdentifier:i,options:r});try{for(var a=p(this.instancesDeferred.entries()),s=a.next();!s.done;s=a.next()){var l=f(s.value,2),c=l[0],u=l[1];i===this.normalizeInstanceIdentifier(c)&&u.resolve(o)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return o},C.prototype.onInit=function(e,t){var n=this.normalizeInstanceIdentifier(t),r=null!==(t=this.onInitCallbacks.get(n))&&void 0!==t?t:new Set;r.add(e),this.onInitCallbacks.set(n,r);t=this.instances.get(n);return t&&e(t,n),function(){r.delete(e)}},C.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var o=p(i),a=o.next();!a.done;a=o.next()){var s=a.value;try{s(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},C.prototype.getOrInitializeService=function(e){var t=e.instanceIdentifier,n=e.options,r=void 0===n?{}:n,e=this.instances.get(t);if(!e&&this.component&&(e=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t)===_?void 0:n,options:r}),this.instances.set(t,e),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(e,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,e)}catch(e){}return e||null},C.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=_),!this.component||this.component.multipleInstances?e:_},C.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},C);function C(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}var S=(L.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},L.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},L.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new N(e,this);return this.providers.set(e,t),t},L.prototype.getProviders=function(){return Array.from(this.providers.values())},L);function L(e){this.name=e,this.providers=new Map}var R,A=[];(z=R=R||{})[z.DEBUG=0]="DEBUG",z[z.VERBOSE=1]="VERBOSE",z[z.INFO=2]="INFO",z[z.WARN=3]="WARN",z[z.ERROR=4]="ERROR",z[z.SILENT=5]="SILENT";function P(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=j[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,a(["["+i+"]  "+e.name+":"],n))}}var k={debug:R.DEBUG,verbose:R.VERBOSE,info:R.INFO,warn:R.WARN,error:R.ERROR,silent:R.SILENT},D=R.INFO,j=((H={})[R.DEBUG]="log",H[R.VERBOSE]="log",H[R.INFO]="info",H[R.WARN]="warn",H[R.ERROR]="error",H),z=(Object.defineProperty(F.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in R))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),F.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?k[e]:e},Object.defineProperty(F.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),F.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,a([this,R.DEBUG],e)),this._logHandler.apply(this,a([this,R.DEBUG],e))},F.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,a([this,R.VERBOSE],e)),this._logHandler.apply(this,a([this,R.VERBOSE],e))},F.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,a([this,R.INFO],e)),this._logHandler.apply(this,a([this,R.INFO],e))},F.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,a([this,R.WARN],e)),this._logHandler.apply(this,a([this,R.WARN],e))},F.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,a([this,R.ERROR],e)),this._logHandler.apply(this,a([this,R.ERROR],e))},F);function F(e){this.name=e,this._logLevel=D,this._logHandler=P,this._userLogHandler=null,A.push(this)}function T(t){A.forEach(function(e){e.setLogLevel(t)})}function x(a,t){for(var e=0,n=A;e<n.length;e++)!function(e){var o=null;t&&t.level&&(o=k[t.level]),e.userLogHandler=null===a?null:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=n.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(function(e){return e}).join(" ");t>=(null!=o?o:e.logLevel)&&a({level:R[t].toLowerCase(),message:i,args:n,type:e.name})}}(n[e])}var H=((H={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",H["bad-app-name"]="Illegal App name: '{$appName}",H["duplicate-app"]="Firebase App named '{$appName}' already exists",H["app-deleted"]="Firebase App named '{$appName}' already deleted",H["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",H["invalid-log-argument"]="First argument to `onLog` must be null or a function.",H),V=new d("app","Firebase",H),B="@firebase/app",M="[DEFAULT]",U=((H={})[B]="fire-core",H["@firebase/analytics"]="fire-analytics",H["@firebase/app-check"]="fire-app-check",H["@firebase/auth"]="fire-auth",H["@firebase/database"]="fire-rtdb",H["@firebase/functions"]="fire-fn",H["@firebase/installations"]="fire-iid",H["@firebase/messaging"]="fire-fcm",H["@firebase/performance"]="fire-perf",H["@firebase/remote-config"]="fire-rc",H["@firebase/storage"]="fire-gcs",H["@firebase/firestore"]="fire-fst",H["fire-js"]="fire-js",H["firebase-wrapper"]="fire-js-all",H),W=new z("@firebase/app"),G=(Object.defineProperty($.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),$.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(e){return e.delete()}))}).then(function(){t.isDeleted_=!0})},$.prototype._getService=function(e,t){void 0===t&&(t=M),this.checkDestroyed_();var n=this.container.getProvider(e);return n.isInitialized()||"EXPLICIT"!==(null===(e=n.getComponent())||void 0===e?void 0:e.instantiationMode)||n.initialize(),n.getImmediate({identifier:t})},$.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=M),this.container.getProvider(e).clearInstance(t)},$.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){W.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},$.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},$.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},$.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw V.create("app-deleted",{appName:this.name_})},$);function $(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=h(void 0,e),this.container=new S(t.name),this._addComponent(new O("app",function(){return r},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(e){return r._addComponent(e)})}G.prototype.name&&G.prototype.options||G.prototype.delete||console.log("dc");var K="8.10.0";function Y(a){var s={},l=new Map,c={__esModule:!0,initializeApp:function(e,t){void 0===t&&(t={});"object"==typeof t&&null!==t||(t={name:t});var n=t;void 0===n.name&&(n.name=M);t=n.name;if("string"!=typeof t||!t)throw V.create("bad-app-name",{appName:String(t)});if(y(s,t))throw V.create("duplicate-app",{appName:t});n=new a(e,n,c);return s[t]=n},app:u,registerVersion:function(e,t,n){var r=null!==(i=U[e])&&void 0!==i?i:e;n&&(r+="-"+n);var i=r.match(/\s|\//),e=t.match(/\s|\//);i||e?(n=['Unable to register library "'+r+'" with version "'+t+'":'],i&&n.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),i&&e&&n.push("and"),e&&n.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),W.warn(n.join(" "))):o(new O(r+"-version",function(){return{library:r,version:t}},"VERSION"))},setLogLevel:T,onLog:function(e,t){if(null!==e&&"function"!=typeof e)throw V.create("invalid-log-argument");x(e,t)},apps:null,SDK_VERSION:K,INTERNAL:{registerComponent:o,removeApp:function(e){delete s[e]},components:l,useAsService:function(e,t){return"serverAuth"!==t?t:null}}};function u(e){if(!y(s,e=e||M))throw V.create("no-app",{appName:e});return s[e]}function o(n){var e,r=n.name;if(l.has(r))return W.debug("There were multiple attempts to register component "+r+"."),"PUBLIC"===n.type?c[r]:null;l.set(r,n),"PUBLIC"===n.type&&(e=function(e){if("function"!=typeof(e=void 0===e?u():e)[r])throw V.create("invalid-app-argument",{appName:r});return e[r]()},void 0!==n.serviceProps&&h(e,n.serviceProps),c[r]=e,a.prototype[r]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,r).apply(this,n.multipleInstances?e:[])});for(var t=0,i=Object.keys(s);t<i.length;t++){var o=i[t];s[o]._addComponent(n)}return"PUBLIC"===n.type?c[r]:null}return c.default=c,Object.defineProperty(c,"apps",{get:function(){return Object.keys(s).map(function(e){return s[e]})}}),u.App=a,c}var H=function e(){var t=Y(G);return t.INTERNAL=n(n({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){h(t,e)},createSubscribe:g,ErrorFactory:d,deepExtend:h}),t}(),J=(X.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(function(e){e=e.getComponent();return"VERSION"===(null==e?void 0:e.type)}(e)){e=e.getImmediate();return e.library+"/"+e.version}return null}).filter(function(e){return e}).join(" ")},X);function X(e){this.container=e}"object"==typeof self&&self.self===self&&void 0!==self.firebase&&(W.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  "),(z=self.firebase.SDK_VERSION)&&0<=z.indexOf("LITE")&&W.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    "));var Z=H.initializeApp;H.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return}}()&&W.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),Z.apply(void 0,e)};var q,Q,ee=H;(q=ee).INTERNAL.registerComponent(new O("platform-logger",function(e){return new J(e)},"PRIVATE")),q.registerVersion(B,"0.6.30",Q),q.registerVersion("fire-js","");return ee.registerVersion("firebase","8.10.0","app"),ee.SDK_VERSION="8.10.0",ee});
//# sourceMappingURL=firebase-app.js.map
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).firebase)}(this,function(mt){"use strict";try{!function(){function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=e(mt),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function p(e,a,s,u){return new(s=s||Promise)(function(n,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,i)}o((u=u.apply(e,a||[])).next())})}function h(n,r){var i,o,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=2&t[0]?o.return:t[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,t[1])).done)return a;switch(o=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}function c(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function v(){return"indexedDB"in self&&null!=indexedDB}function g(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})}function l(){return!(!navigator||!navigator.cookieEnabled)}var i,o="FirebaseError",f=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(d,i=Error),d);function d(e,t,n){t=i.call(this,t)||this;return t.code=e,t.customData=n,t.name=o,Object.setPrototypeOf(t,d.prototype),Error.captureStackTrace&&Error.captureStackTrace(t,m.prototype.create),t}var m=(n.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=t[0]||{},o=this.service+"/"+e,e=this.errors[e],e=e?(r=i,e.replace(y,function(e,t){var n=r[t];return null!=n?String(n):"<"+t+"?>"})):"Error",e=this.serviceName+": "+e+" ("+o+").";return new f(o,e,i)},n);function n(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var y=/\{\$([^}]+)}/g,b=1e3,w=2,I=144e5,_=.5;function E(e,t,n){void 0===n&&(n=w);n=(t=void 0===t?b:t)*Math.pow(n,e),e=Math.round(_*n*(Math.random()-.5)*2);return Math.min(I,n+e)}var T=(S.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},S.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},S.prototype.setServiceProps=function(e){return this.serviceProps=e,this},S.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},S);function S(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}function C(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function O(n,r,i){var o,e=new Promise(function(e,t){C(o=n[r].apply(n,i)).then(e,t)});return e.request=o,e}function N(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function D(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return O(this[n],e,arguments)})})}function P(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function A(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=O(e,n,arguments)).then(function(e){if(e)return new k(e,t.request)});var e,t})})}function x(e){this._index=e}function k(e,t){this._cursor=e,this._request=t}function j(e){this._store=e}function L(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function R(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new L(n)}function F(e){this._db=e}N(x,"_index",["name","keyPath","multiEntry","unique"]),D(x,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),A(x,"_index",IDBIndex,["openCursor","openKeyCursor"]),N(k,"_cursor",["direction","key","primaryKey","value"]),D(k,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(k.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),C(t._request).then(function(e){if(e)return new k(e,t._request)})})})}),j.prototype.createIndex=function(){return new x(this._store.createIndex.apply(this._store,arguments))},j.prototype.index=function(){return new x(this._store.index.apply(this._store,arguments))},N(j,"_store",["name","keyPath","indexNames","autoIncrement"]),D(j,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),A(j,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),P(j,"_store",IDBObjectStore,["deleteIndex"]),L.prototype.objectStore=function(){return new j(this._tx.objectStore.apply(this._tx,arguments))},N(L,"_tx",["objectStoreNames","mode"]),P(L,"_tx",IDBTransaction,["abort"]),R.prototype.createObjectStore=function(){return new j(this._db.createObjectStore.apply(this._db,arguments))},N(R,"_db",["name","version","objectStoreNames"]),P(R,"_db",IDBDatabase,["deleteObjectStore","close"]),F.prototype.transaction=function(){return new L(this._db.transaction.apply(this._db,arguments))},N(F,"_db",["name","version","objectStoreNames"]),P(F,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[j,x].forEach(function(e){i in e.prototype&&(e.prototype[i.replace("open","iterate")]=function(){var e=(n=arguments,Array.prototype.slice.call(n)),t=e[e.length-1],n=this._store||this._index,r=n[i].apply(n,e.slice(0,-1));r.onsuccess=function(){t(r.result)}})})}),[x,j].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,i=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(i.push(e.value),void 0===n||i.length!=n?e.continue():t(i)):t(i)})})})});var M="0.4.32",B=1e4,H="w:"+M,q="FIS_v2",V="https://firebaseinstallations.googleapis.com/v1",G=36e5,K=((Re={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Re["not-registered"]="Firebase Installation is not registered.",Re["installation-not-found"]="Firebase Installation not found.",Re["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Re["app-offline"]="Could not process request. Application offline.",Re["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Re),U=new m("installations","Installations",K);function W(e){return e instanceof f&&e.code.includes("request-failed")}function $(e){e=e.projectId;return V+"/projects/"+e+"/installations"}function z(e){return{token:e.token,requestStatus:2,expiresIn:(e=e.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()}}function J(n,r){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return[4,r.json()];case 1:return t=e.sent(),t=t.error,[2,U.create("request-failed",{requestName:n,serverCode:t.code,serverMessage:t.message,serverStatus:t.status})]}})})}function Y(e){e=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function X(e,t){t=t.refreshToken,e=Y(e);return e.append("Authorization",q+" "+t),e}function Z(n){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return[4,n()];case 1:return 500<=(t=e.sent()).status&&t.status<600?[2,n()]:[2,t]}})})}function Q(t){return new Promise(function(e){setTimeout(e,t)})}function ee(e){return btoa(String.fromCharCode.apply(String,u([],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(e)))).replace(/\+/g,"-").replace(/\//g,"_")}var te=/^[cdef][\w-]{21}$/,ne="";function re(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=ee(e).substr(0,22);return te.test(t)?t:ne}catch(e){return ne}}function ie(e){return e.appName+"!"+e.appId}var oe=new Map;function ae(e,t){e=ie(e);se(e,t),function(e,t){var n=ce();n&&n.postMessage({key:e,fid:t});le()}(e,t)}function se(e,t){var n,r,e=oe.get(e);if(e)try{for(var i=a(e),o=i.next();!o.done;o=i.next())(0,o.value)(t)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}var ue=null;function ce(){return!ue&&"BroadcastChannel"in self&&((ue=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){se(e.data.key,e.data.fid)}),ue}function le(){0===oe.size&&ue&&(ue.close(),ue=null)}var fe,de,pe="firebase-installations-database",he=1,ve="firebase-installations-store",ge=null;function me(){var e,t,n;return ge||(e=he,t=function(e){0===e.oldVersion&&e.createObjectStore(ve)},(n=(e=O(indexedDB,"open",[pe,he])).request)&&(n.onupgradeneeded=function(e){t&&t(new R(n.result,e.oldVersion,n.transaction))}),ge=e.then(function(e){return new F(e)})),ge}function ye(o,a){return p(this,void 0,void 0,function(){var t,n,r,i;return h(this,function(e){switch(e.label){case 0:return t=ie(o),[4,me()];case 1:return r=e.sent(),n=r.transaction(ve,"readwrite"),[4,(r=n.objectStore(ve)).get(t)];case 2:return i=e.sent(),[4,r.put(a,t)];case 3:return e.sent(),[4,n.complete];case 4:return e.sent(),i&&i.fid===a.fid||ae(o,a.fid),[2,a]}})})}function be(r){return p(this,void 0,void 0,function(){var t,n;return h(this,function(e){switch(e.label){case 0:return t=ie(r),[4,me()];case 1:return n=e.sent(),[4,(n=n.transaction(ve,"readwrite")).objectStore(ve).delete(t)];case 2:return e.sent(),[4,n.complete];case 3:return e.sent(),[2]}})})}function we(a,s){return p(this,void 0,void 0,function(){var t,n,r,i,o;return h(this,function(e){switch(e.label){case 0:return t=ie(a),[4,me()];case 1:return r=e.sent(),n=r.transaction(ve,"readwrite"),[4,(r=n.objectStore(ve)).get(t)];case 2:return i=e.sent(),void 0!==(o=s(i))?[3,4]:[4,r.delete(t)];case 3:return e.sent(),[3,6];case 4:return[4,r.put(o,t)];case 5:e.sent(),e.label=6;case 6:return[4,n.complete];case 7:return e.sent(),!o||i&&i.fid===o.fid||ae(a,o.fid),[2,o]}})})}function Ie(i){return p(this,void 0,void 0,function(){var t,n,r;return h(this,function(e){switch(e.label){case 0:return[4,we(i,function(e){e=Ee(e||{fid:re(),registrationStatus:0}),e=function(e,t){{if(0!==t.registrationStatus)return 1===t.registrationStatus?{installationEntry:t,registrationPromise:function(i){return p(this,void 0,void 0,function(){var t,n,r;return h(this,function(e){switch(e.label){case 0:return[4,_e(i)];case 1:t=e.sent(),e.label=2;case 2:return 1!==t.registrationStatus?[3,5]:[4,Q(100)];case 3:return e.sent(),[4,_e(i)];case 4:return t=e.sent(),[3,2];case 5:return 0!==t.registrationStatus?[3,7]:[4,Ie(i)];case 6:return r=e.sent(),n=r.installationEntry,(r=r.registrationPromise)?[2,r]:[2,n];case 7:return[2,t]}})})}(e)}:{installationEntry:t};if(!navigator.onLine){var n=Promise.reject(U.create("app-offline"));return{installationEntry:t,registrationPromise:n}}t={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},e=function(r,i){return p(this,void 0,void 0,function(){var t,n;return h(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,7]),[4,function(a,e){var s=e.fid;return p(this,void 0,void 0,function(){var t,n,r,i,o;return h(this,function(e){switch(e.label){case 0:return t=$(a),n=Y(a),o={fid:s,authVersion:q,appId:a.appId,sdkVersion:H},r={method:"POST",headers:n,body:JSON.stringify(o)},[4,Z(function(){return fetch(t,r)})];case 1:return(i=e.sent()).ok?[4,i.json()]:[3,3];case 2:return o=e.sent(),[2,{fid:o.fid||s,registrationStatus:2,refreshToken:o.refreshToken,authToken:z(o.authToken)}];case 3:return[4,J("Create Installation",i)];case 4:throw e.sent()}})})}(r,i)];case 1:return t=e.sent(),[2,ye(r,t)];case 2:return W(n=e.sent())&&409===n.customData.serverCode?[4,be(r)]:[3,4];case 3:return e.sent(),[3,6];case 4:return[4,ye(r,{fid:i.fid,registrationStatus:0})];case 5:e.sent(),e.label=6;case 6:throw n;case 7:return[2]}})})}(e,t);return{installationEntry:t,registrationPromise:e}}}(i,e);return t=e.registrationPromise,e.installationEntry})];case 1:return(n=e.sent()).fid!==ne?[3,3]:(r={},[4,t]);case 2:return[2,(r.installationEntry=e.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:t}]}})})}function _e(e){return we(e,function(e){if(!e)throw U.create("installation-not-found");return Ee(e)})}function Ee(e){return 1===(t=e).registrationStatus&&t.registrationTime+B<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}function Te(e,a){var s=e.appConfig,u=e.platformLoggerProvider;return p(this,void 0,void 0,function(){var t,n,r,i,o;return h(this,function(e){switch(e.label){case 0:return t=function(e,t){t=t.fid;return $(e)+"/"+t+"/authTokens:generate"}(s,a),n=X(s,a),(o=u.getImmediate({optional:!0}))&&n.append("x-firebase-client",o.getPlatformInfoString()),o={installation:{sdkVersion:H}},r={method:"POST",headers:n,body:JSON.stringify(o)},[4,Z(function(){return fetch(t,r)})];case 1:return(i=e.sent()).ok?[4,i.json()]:[3,3];case 2:return o=e.sent(),[2,z(o)];case 3:return[4,J("Generate Auth Token",i)];case 4:throw e.sent()}})})}function Se(i,o){return void 0===o&&(o=!1),p(this,void 0,void 0,function(){var r,t,n;return h(this,function(e){switch(e.label){case 0:return[4,we(i.appConfig,function(e){if(!Oe(e))throw U.create("not-registered");var t,n=e.authToken;if(o||2!==(t=n).requestStatus||function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+G}(t)){if(1===n.requestStatus)return r=function(n,r){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return[4,Ce(n.appConfig)];case 1:t=e.sent(),e.label=2;case 2:return 1!==t.authToken.requestStatus?[3,5]:[4,Q(100)];case 3:return e.sent(),[4,Ce(n.appConfig)];case 4:return t=e.sent(),[3,2];case 5:return 0===(t=t.authToken).requestStatus?[2,Se(n,r)]:[2,t]}})})}(i,o),e;if(!navigator.onLine)throw U.create("app-offline");n=(t=e,n={requestStatus:1,requestTime:Date.now()},s(s({},t),{authToken:n}));return r=function(i,o){return p(this,void 0,void 0,function(){var t,n,r;return h(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,8]),[4,Te(i,o)];case 1:return t=e.sent(),r=s(s({},o),{authToken:t}),[4,ye(i.appConfig,r)];case 2:return e.sent(),[2,t];case 3:return!W(n=e.sent())||401!==n.customData.serverCode&&404!==n.customData.serverCode?[3,5]:[4,be(i.appConfig)];case 4:return e.sent(),[3,7];case 5:return r=s(s({},o),{authToken:{requestStatus:0}}),[4,ye(i.appConfig,r)];case 6:e.sent(),e.label=7;case 7:throw n;case 8:return[2]}})})}(i,n),n}return e})];case 1:return t=e.sent(),r?[4,r]:[3,3];case 2:return n=e.sent(),[3,4];case 3:n=t.authToken,e.label=4;case 4:return[2,n]}})})}function Ce(e){return we(e,function(e){if(!Oe(e))throw U.create("not-registered");var t=e.authToken;return 1===(t=t).requestStatus&&t.requestTime+B<Date.now()?s(s({},e),{authToken:{requestStatus:0}}):e})}function Oe(e){return void 0!==e&&2===e.registrationStatus}function Ne(t,n){return void 0===n&&(n=!1),p(this,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:return[4,function(n){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return[4,Ie(n)];case 1:return(t=e.sent().registrationPromise)?[4,t]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})}(t.appConfig)];case 1:return e.sent(),[4,Se(t,n)];case 2:return[2,e.sent().token]}})})}function De(i,o){return p(this,void 0,void 0,function(){var t,n,r;return h(this,function(e){switch(e.label){case 0:return t=function(e,t){t=t.fid;return $(e)+"/"+t}(i,o),r=X(i,o),n={method:"DELETE",headers:r},[4,Z(function(){return fetch(t,n)})];case 1:return(r=e.sent()).ok?[3,3]:[4,J("Delete Installation",r)];case 2:throw e.sent();case 3:return[2]}})})}function Pe(e,r){var i=e.appConfig;return function(e,t){ce();var n=ie(e);(e=oe.get(n))||(e=new Set,oe.set(n,e)),e.add(t)}(i,r),function(){var e,t,n;t=r,n=ie(e=i),(e=oe.get(n))&&(e.delete(t),0===e.size&&oe.delete(n),le())}}function Ae(e){return U.create("missing-app-config-values",{valueName:e})}(fe=t.default).INTERNAL.registerComponent(new T("installations",function(e){var t=e.getProvider("app").getImmediate(),n={appConfig:function(e){var t,n;if(!e||!e.options)throw Ae("App Configuration");if(!e.name)throw Ae("App Name");try{for(var r=a(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!e.options[o])throw Ae(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:e.getProvider("platform-logger")};return{app:t,getId:function(){return function(r){return p(this,void 0,void 0,function(){var t,n;return h(this,function(e){switch(e.label){case 0:return[4,Ie(r.appConfig)];case 1:return t=e.sent(),n=t.installationEntry,(t.registrationPromise||Se(r)).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(e){return Ne(n,e)},delete:function(){return function(r){return p(this,void 0,void 0,function(){var t,n;return h(this,function(e){switch(e.label){case 0:return[4,we(t=r.appConfig,function(e){if(!e||0!==e.registrationStatus)return e})];case 1:if(!(n=e.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw U.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw U.create("app-offline");case 3:return[4,De(t,n)];case 4:return e.sent(),[4,be(t)];case 5:e.sent(),e.label=6;case 6:return[2]}})})}(n)},onIdChange:function(e){return Pe(n,e)}}},"PUBLIC")),fe.registerVersion("@firebase/installations",M),(Re=de=de||{})[Re.DEBUG=0]="DEBUG",Re[Re.VERBOSE=1]="VERBOSE",Re[Re.INFO=2]="INFO",Re[Re.WARN=3]="WARN",Re[Re.ERROR=4]="ERROR",Re[Re.SILENT=5]="SILENT";function xe(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=Le[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,u(["["+i+"]  "+e.name+":"],n))}}var ke={debug:de.DEBUG,verbose:de.VERBOSE,info:de.INFO,warn:de.WARN,error:de.ERROR,silent:de.SILENT},je=de.INFO,Le=((K={})[de.DEBUG]="log",K[de.VERBOSE]="log",K[de.INFO]="info",K[de.WARN]="warn",K[de.ERROR]="error",K),Re=(Object.defineProperty(Fe.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in de))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),Fe.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?ke[e]:e},Object.defineProperty(Fe.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(Fe.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),Fe.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,u([this,de.DEBUG],e)),this._logHandler.apply(this,u([this,de.DEBUG],e))},Fe.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,u([this,de.VERBOSE],e)),this._logHandler.apply(this,u([this,de.VERBOSE],e))},Fe.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,u([this,de.INFO],e)),this._logHandler.apply(this,u([this,de.INFO],e))},Fe.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,u([this,de.WARN],e)),this._logHandler.apply(this,u([this,de.WARN],e))},Fe.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,u([this,de.ERROR],e)),this._logHandler.apply(this,u([this,de.ERROR],e))},Fe);function Fe(e){this.name=e,this._logLevel=je,this._logHandler=xe,this._userLogHandler=null}var Me,Be,He="firebase_id",qe="origin",Ve=6e4,Ge="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Ke="https://www.googletagmanager.com/gtag/js";(K=Me=Me||{}).EVENT="event",K.SET="set",K.CONFIG="config",(K=Be=Be||{}).ADD_SHIPPING_INFO="add_shipping_info",K.ADD_PAYMENT_INFO="add_payment_info",K.ADD_TO_CART="add_to_cart",K.ADD_TO_WISHLIST="add_to_wishlist",K.BEGIN_CHECKOUT="begin_checkout",K.CHECKOUT_PROGRESS="checkout_progress",K.EXCEPTION="exception",K.GENERATE_LEAD="generate_lead",K.LOGIN="login",K.PAGE_VIEW="page_view",K.PURCHASE="purchase",K.REFUND="refund",K.REMOVE_FROM_CART="remove_from_cart",K.SCREEN_VIEW="screen_view",K.SEARCH="search",K.SELECT_CONTENT="select_content",K.SELECT_ITEM="select_item",K.SELECT_PROMOTION="select_promotion",K.SET_CHECKOUT_OPTION="set_checkout_option",K.SHARE="share",K.SIGN_UP="sign_up",K.TIMING_COMPLETE="timing_complete",K.VIEW_CART="view_cart",K.VIEW_ITEM="view_item",K.VIEW_ITEM_LIST="view_item_list",K.VIEW_PROMOTION="view_promotion",K.VIEW_SEARCH_RESULTS="view_search_results";var Ue=new Re("@firebase/analytics");function We(o,a,s,u){return function(n,r,i){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return e.trys.push([0,6,,7]),n!==Me.EVENT?[3,2]:[4,function(u,c,l,f,d){return p(this,void 0,void 0,function(){var n,r,t,i,o,a,s;return h(this,function(e){switch(e.label){case 0:return(e.trys.push([0,4,,5]),n=[],d&&d.send_to)?(s=d.send_to,Array.isArray(s)||(s=[s]),[4,Promise.all(l)]):[3,2];case 1:for(r=e.sent(),t=function(t){var e=r.find(function(e){return e.measurementId===t}),e=e&&c[e.appId];if(!e)return n=[],"break";n.push(e)},i=0,o=s;i<o.length&&(a=o[i],"break"!==t(a));i++);e.label=2;case 2:return 0===n.length&&(n=Object.values(c)),[4,Promise.all(n)];case 3:return e.sent(),u(Me.EVENT,f,d||{}),[3,5];case 4:return s=e.sent(),Ue.error(s),[3,5];case 5:return[2]}})})}(o,a,s,r,i)];case 1:return e.sent(),[3,5];case 2:return n!==Me.CONFIG?[3,4]:[4,function(r,i,o,a,s,u){return p(this,void 0,void 0,function(){var t,n;return h(this,function(e){switch(e.label){case 0:t=a[s],e.label=1;case 1:return e.trys.push([1,7,,8]),t?[4,i[t]]:[3,3];case 2:return e.sent(),[3,6];case 3:return[4,Promise.all(o)];case 4:return n=e.sent(),(n=n.find(function(e){return e.measurementId===s}))?[4,i[n.appId]]:[3,6];case 5:e.sent(),e.label=6;case 6:return[3,8];case 7:return n=e.sent(),Ue.error(n),[3,8];case 8:return r(Me.CONFIG,s,u),[2]}})})}(o,a,s,u,r,i)];case 3:return e.sent(),[3,5];case 4:o(Me.SET,r),e.label=5;case 5:return[3,7];case 6:return t=e.sent(),Ue.error(t),[3,7];case 7:return[2]}})})}}var Re=((Re={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",Re["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",Re["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",Re["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Re["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Re["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",Re["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",Re["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',Re["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',Re),$e=new m("analytics","Analytics",Re),ze=30;function Je(e,t){void 0===t&&(t=1e3),this.throttleMetadata=e=void 0===e?{}:e,this.intervalMillis=t}var Ye=new(Je.prototype.getThrottleMetadata=function(e){return this.throttleMetadata[e]},Je.prototype.setThrottleMetadata=function(e,t){this.throttleMetadata[e]=t},Je.prototype.deleteThrottleMetadata=function(e){delete this.throttleMetadata[e]},Je);function Xe(o){var a;return p(this,void 0,void 0,function(){var t,n,r,i;return h(this,function(e){switch(e.label){case 0:return t=o.appId,i=o.apiKey,i={method:"GET",headers:new Headers({Accept:"application/json","x-goog-api-key":i})},t=Ge.replace("{app-id}",t),[4,fetch(t,i)];case 1:if(200===(n=e.sent()).status||304===n.status)return[3,6];r="",e.label=2;case 2:return e.trys.push([2,4,,5]),[4,n.json()];case 3:return i=e.sent(),null!==(a=i.error)&&void 0!==a&&a.message&&(r=i.error.message),[3,5];case 4:return e.sent(),[3,5];case 5:throw $e.create("config-fetch-failed",{httpStatus:n.status,responseMessage:r});case 6:return[2,n.json()]}})})}function Ze(s,u,c){return void 0===u&&(u=Ye),p(this,void 0,void 0,function(){var t,n,r,i,o,a=this;return h(this,function(e){if(i=s.options,t=i.appId,n=i.apiKey,r=i.measurementId,!t)throw $e.create("no-app-id");if(n)return i=u.getThrottleMetadata(t)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new tt,setTimeout(function(){return p(a,void 0,void 0,function(){return h(this,function(e){return o.abort(),[2]})})},void 0!==c?c:Ve),[2,function a(s,e,u,c){var l=e.throttleEndTimeMillis,f=e.backoffCount;void 0===c&&(c=Ye);return p(this,void 0,void 0,function(){var t,n,r,i,o;return h(this,function(e){switch(e.label){case 0:t=s.appId,n=s.measurementId,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Qe(u,l)];case 2:return e.sent(),[3,4];case 3:if(i=e.sent(),n)return Ue.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+n+' provided in the "measurementId" field in the local Firebase config. ['+i.message+"]"),[2,{appId:t,measurementId:n}];throw i;case 4:return e.trys.push([4,6,,7]),[4,Xe(s)];case 5:return o=e.sent(),c.deleteThrottleMetadata(t),[2,o];case 6:if(et(r=e.sent()))return i=503===Number(r.customData.httpStatus)?E(f,c.intervalMillis,ze):E(f,c.intervalMillis),o={throttleEndTimeMillis:Date.now()+i,backoffCount:f+1},c.setThrottleMetadata(t,o),Ue.debug("Calling attemptFetch again in "+i+" millis"),[2,a(s,o,u,c)];if(c.deleteThrottleMetadata(t),n)return Ue.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+n+' provided in the "measurementId" field in the local Firebase config. ['+r.message+"]"),[2,{appId:t,measurementId:n}];throw r;case 7:return[2]}})})}({appId:t,apiKey:n,measurementId:r},i,o,u)];if(r)return[2,{measurementId:r,appId:t}];throw $e.create("no-api-key")})})}function Qe(i,o){return new Promise(function(e,t){var n=Math.max(o-Date.now(),0),r=setTimeout(e,n);i.addEventListener(function(){clearTimeout(r),t($e.create("fetch-throttle",{throttleEndTimeMillis:o}))})})}function et(e){if(e instanceof f&&e.customData){e=Number(e.customData.httpStatus);return 429===e||500===e||503===e||504===e}}var tt=(nt.prototype.addEventListener=function(e){this.listeners.push(e)},nt.prototype.abort=function(){this.listeners.forEach(function(e){return e()})},nt);function nt(){this.listeners=[]}function rt(s,u,c,l,f,d){return p(this,void 0,void 0,function(){var i,o,a;return h(this,function(e){switch(e.label){case 0:return(i=Ze(s)).then(function(e){c[e.measurementId]=e.appId,s.options.measurementId&&e.measurementId!==s.options.measurementId&&Ue.warn("The measurement ID in the local Firebase config ("+s.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(function(e){return Ue.error(e)}),u.push(i),o=function(){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return v()?[3,1]:(Ue.warn($e.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,g()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),Ue.warn($e.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}})})}().then(function(e){if(e)return l.getId()}),[4,Promise.all([i,o])];case 1:return a=e.sent(),i=a[0],o=a[1],function(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(Ke))return r}}()||(t=d,n=i.measurementId,(r=document.createElement("script")).src=Ke+"?l="+t+"&id="+n,r.async=!0,document.head.appendChild(r)),f("js",new Date),(a={})[qe]="firebase",a.update=!0,a=a,null!=o&&(a[He]=o),f(Me.CONFIG,i.measurementId,a),[2,i.measurementId]}var t,n,r})})}var it,ot,at={},st=[],ut={},ct="dataLayer",lt="gtag",ft=!1;function dt(e){if(ft)throw $e.create("already-initialized");e.dataLayerName&&(ct=e.dataLayerName),e.gtagName&&(lt=e.gtagName)}function pt(e,t){i=[],c()&&i.push("This is a browser extension environment."),l()||i.push("Cookies are not available."),0<i.length&&(i=i.map(function(e,t){return"("+(t+1)+") "+e}).join(" "),i=$e.create("invalid-analytics-context",{errorInfo:i}),Ue.warn(i.message));var n,r,i,o=e.options.appId;if(!o)throw $e.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw $e.create("no-api-key");Ue.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+e.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=at[o])throw $e.create("already-exists",{id:o});return ft||(r=ct,i=[],Array.isArray(window[r])?i=window[r]:window[r]=i,n=ct,r=lt,i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window[n].push(arguments)},window[r]&&"function"==typeof window[r]&&(i=window[r]),window[r]=We(i,at,st,ut),r={gtagCore:i,wrappedGtag:window[r]},ot=r.wrappedGtag,it=r.gtagCore,ft=!0),at[o]=rt(e,st,ut,t,it,ct),{app:e,logEvent:function(e,t,n){!function(n,r,i,o,a){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return a&&a.global?(n(Me.EVENT,i,o),[2]):[3,1];case 1:return[4,r];case 2:t=e.sent(),t=s(s({},o),{send_to:t}),n(Me.EVENT,i,t),e.label=3;case 3:return[2]}})})}(ot,at[o],e,t,n).catch(function(e){return Ue.error(e)})},setCurrentScreen:function(e,t){!function(n,r,i,o){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return o&&o.global?(n(Me.SET,{screen_name:i}),[2,Promise.resolve()]):[3,1];case 1:return[4,r];case 2:t=e.sent(),n(Me.CONFIG,t,{update:!0,screen_name:i}),e.label=3;case 3:return[2]}})})}(ot,at[o],e,t).catch(function(e){return Ue.error(e)})},setUserId:function(e,t){!function(n,r,i,o){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return o&&o.global?(n(Me.SET,{user_id:i}),[2,Promise.resolve()]):[3,1];case 1:return[4,r];case 2:t=e.sent(),n(Me.CONFIG,t,{update:!0,user_id:i}),e.label=3;case 3:return[2]}})})}(ot,at[o],e,t).catch(function(e){return Ue.error(e)})},setUserProperties:function(e,t){!function(a,s,u,c){return p(this,void 0,void 0,function(){var t,n,r,i,o;return h(this,function(e){switch(e.label){case 0:if(!c||!c.global)return[3,1];for(t={},n=0,r=Object.keys(u);n<r.length;n++)i=r[n],t["user_properties."+i]=u[i];return a(Me.SET,t),[2,Promise.resolve()];case 1:return[4,s];case 2:o=e.sent(),a(Me.CONFIG,o,{update:!0,user_properties:u}),e.label=3;case 3:return[2]}})})}(ot,at[o],e,t).catch(function(e){return Ue.error(e)})},setAnalyticsCollectionEnabled:function(e){!function(n,r){return p(this,void 0,void 0,function(){var t;return h(this,function(e){switch(e.label){case 0:return[4,n];case 1:return t=e.sent(),window["ga-disable-"+t]=!r,[2]}})})}(at[o],e).catch(function(e){return Ue.error(e)})},INTERNAL:{delete:function(){return delete at[o],Promise.resolve()}}}}var ht,vt="analytics";function gt(){return p(this,void 0,void 0,function(){return h(this,function(e){switch(e.label){case 0:if(c())return[2,!1];if(!l())return[2,!1];if(!v())return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,g()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,!1];case 4:return[2]}})})}(ht=t.default).INTERNAL.registerComponent(new T(vt,function(e){return pt(e.getProvider("app").getImmediate(),e.getProvider("installations").getImmediate())},"PUBLIC").setServiceProps({settings:dt,EventName:Be,isSupported:gt})),ht.INTERNAL.registerComponent(new T("analytics-internal",function(e){try{return{logEvent:e.getProvider(vt).getImmediate().logEvent}}catch(e){throw $e.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),ht.registerVersion("@firebase/analytics","0.6.18")}.apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-analytics.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-analytics.js.map
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(wm){"use strict";try{!function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=t(wm),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function y(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function g(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}function i(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,e[n++]=i>>6&63|128),e[n++]=63&i|128)}return e}function u(t){return function(t){t=i(t);return o.encodeByteArray(t,!0)}(t).replace(/\./g,"")}var o={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=(15&a)<<2|c>>6,c=63&c;u||(c=64,s||(h=64)),r.push(n[o>>2],n[(3&o)<<4|a>>4],n[h],n[c])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i,o,s,a=t[n++];a<128?e[r++]=String.fromCharCode(a):191<a&&a<224?(o=t[n++],e[r++]=String.fromCharCode((31&a)<<6|63&o)):239<a&&a<365?(i=((7&a)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536,e[r++]=String.fromCharCode(55296+(i>>10)),e[r++]=String.fromCharCode(56320+(1023&i))):(o=t[n++],s=t[n++],e[r++]=String.fromCharCode((15&a)<<12|(63&o)<<6|63&s))}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();r.push(o<<2|s>>4),64!==a&&(r.push(s<<4&240|a>>2),64!==u&&r.push(a<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function c(){return!function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}var l,f="FirebaseError",d=(n(p,l=Error),p);function p(t,e,n){e=l.call(this,e)||this;return e.code=t,e.customData=n,e.name=f,Object.setPrototypeOf(e,p.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,m.prototype.create),e}var m=(v.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(b,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new d(o,t,i)},v);function v(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var w,b=/\{\$([^}]+)}/g;function E(t){return t&&t._delegate?t._delegate:t}(k=w=w||{})[k.DEBUG=0]="DEBUG",k[k.VERBOSE=1]="VERBOSE",k[k.INFO=2]="INFO",k[k.WARN=3]="WARN",k[k.ERROR=4]="ERROR",k[k.SILENT=5]="SILENT";function T(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=S[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var I={debug:w.DEBUG,verbose:w.VERBOSE,info:w.INFO,warn:w.WARN,error:w.ERROR,silent:w.SILENT},_=w.INFO,S=((Ie={})[w.DEBUG]="log",Ie[w.VERBOSE]="log",Ie[w.INFO]="info",Ie[w.WARN]="warn",Ie[w.ERROR]="error",Ie),A=(Object.defineProperty(D.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in w))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),D.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?I[t]:t},Object.defineProperty(D.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),D.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,w.DEBUG],t)),this._logHandler.apply(this,s([this,w.DEBUG],t))},D.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,w.VERBOSE],t)),this._logHandler.apply(this,s([this,w.VERBOSE],t))},D.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,w.INFO],t)),this._logHandler.apply(this,s([this,w.INFO],t))},D.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,w.WARN],t)),this._logHandler.apply(this,s([this,w.WARN],t))},D.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,w.ERROR],t)),this._logHandler.apply(this,s([this,w.ERROR],t))},D);function D(t){this.name=t,this._logLevel=_,this._logHandler=T,this._userLogHandler=null}var N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function C(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var k,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},x={},O=R||self;function L(){}function P(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function M(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var F="closure_uid_"+(1e9*Math.random()>>>0),V=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function q(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function B(t,e,n){return(B=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:q).apply(null,arguments)}function j(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function K(t,o){function e(){}e.prototype=o.prototype,t.Z=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Vb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function G(){this.s=this.s,this.o=this.o}var Q={};G.prototype.s=!1,G.prototype.na=function(){var t;!this.s&&(this.s=!0,this.M(),0)&&(t=this,t=Object.prototype.hasOwnProperty.call(t,F)&&t[F]||(t[F]=++V),delete Q[t])},G.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var H=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(){return Array.prototype.concat.apply([],arguments)}function Y(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function X(t){return/^[\s\xa0]*$/.test(t)}var $,J=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Z(t,e){return-1!=t.indexOf(e)}function tt(t,e){return t<e?-1:e<t?1:0}t:{var et=O.navigator;if(et){et=et.userAgent;if(et){$=et;break t}}$=""}function nt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function rt(t){var e,n={};for(e in t)n[e]=t[e];return n}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ot(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<it.length;i++)e=it[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function st(t){return st[" "](t),t}st[" "]=L;var at,ut=Z($,"Opera"),ct=Z($,"Trident")||Z($,"MSIE"),ht=Z($,"Edge"),lt=ht||ct,ft=Z($,"Gecko")&&!(Z($.toLowerCase(),"webkit")&&!Z($,"Edge"))&&!(Z($,"Trident")||Z($,"MSIE"))&&!Z($,"Edge"),dt=Z($.toLowerCase(),"webkit")&&!Z($,"Edge");function pt(){var t=O.document;return t?t.documentMode:void 0}t:{var yt="",gt=(gt=$,ft?/rv:([^\);]+)(\)|;)/.exec(gt):ht?/Edge\/([\d\.]+)/.exec(gt):ct?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(gt):dt?/WebKit\/(\S+)/.exec(gt):ut?/(?:Version)[ \/]?(\S+)/.exec(gt):void 0);if(gt&&(yt=gt?gt[1]:""),ct){gt=pt();if(null!=gt&&gt>parseFloat(yt)){at=String(gt);break t}}at=yt}var mt={};function vt(){return t=function(){for(var t=0,e=J(String(at)).split("."),n=J("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=tt(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||tt(0==o[2].length,0==s[2].length)||tt(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},e=mt,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9);var t,e}var wt=O.document&&ct&&(pt()||parseInt(at,10))||void 0,bt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",L,e),O.removeEventListener("test",L,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ft){t:{try{st(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",this.state=t.state,(this.i=t).defaultPrevented&&Tt.Z.h.call(this)}}Et.prototype.h=function(){this.defaultPrevented=!0},K(Tt,Et);var It={2:"touch",3:"pen",4:"mouse"};Tt.prototype.h=function(){Tt.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var _t="closure_listenable_"+(1e6*Math.random()|0),St=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++St,this.ca=this.fa=!1}function Dt(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Nt(t){this.src=t,this.g={},this.h=0}function Ct(t,e){var n,r,i,o=e.type;o in t.g&&(n=t.g[o],(i=0<=(r=H(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Dt(e),0==t.g[o].length&&(delete t.g[o],t.h--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.fa=!1)):((e=new At(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),xt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[_t]?e.O(n,r,M(i)?!!i.capture:!!i,o):Lt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=qt(n),t&&t[_t]?t.N(e,n,M(r)?!!r.capture:!!r,i):Lt(t,e,n,!1,r,i)}function Lt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s,a=M(i)?!!i.capture:!!i,u=Vt(t);if(u||(t[Rt]=u=new Nt(t)),(n=u.add(e,n,r,a,o)).proxy)return n;if(s=Ft,(n.proxy=r=function t(e){return s.call(t.src,t.listener,e)}).src=t,r.listener=n,t.addEventListener)void 0===(i=!bt?a:i)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.ca&&((e=t.src)&&e[_t]?Ct(e.i,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(Ct(n,t),0==n.h&&(n.src=null,e[Rt]=null)):Dt(t)))}function Mt(t){return t in xt?xt[t]:xt[t]="on"+t}function Ft(t,e){var n,r;return t=!!t.ca||(e=new Tt(e,this),n=t.listener,r=t.ia||t.src,t.fa&&Pt(t),n.call(r,e))}function Vt(t){return(t=t[Rt])instanceof Nt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==typeof e?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function Bt(){G.call(this),this.i=new Nt(this),(this.P=this).I=null}function jt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e?e=new Et(e,t):e instanceof Et?e.target=e.target||t:(s=e,ot(e=new Et(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.g=n[i],s=Kt(o,r,!0,e)&&s;if(s=Kt(o=e.g=t,r,!0,e)&&s,s=Kt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Kt(o=e.g=n[i],r,!1,e)&&s}function Kt(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.ca&&u.capture==n&&(s=u.listener,a=u.ia||u.src,u.fa&&Ct(t.i,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}K(Bt,G),Bt.prototype[_t]=!0,Bt.prototype.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=M(i)?!!i.capture:!!i,r=qt(r),e&&e[_t]?(e=e.i,(n=String(n).toString())in e.g&&-1<(r=kt(s=e.g[n],r,i,o))&&(Dt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.g[n],e.h--))):(e=e&&Vt(e))&&(n=e.g[n.toString()],(r=(e=-1)<(e=n?kt(n,r,i,o):e)?n[e]:null)&&Pt(r))}(this,t,e,n,r)},Bt.prototype.M=function(){if(Bt.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Dt(n[r]);delete e.g[t],e.h--}}this.I=null},Bt.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Bt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Gt=O.JSON.stringify;var Qt=(Ht.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},Ht);function Ht(){this.h=this.g=null}var zt=(Wt.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},new Wt(function(){return new Xt},function(t){return t.reset()}));function Wt(t,e){this.i=t,this.j=e,this.h=0,this.g=null}var Yt,Xt=($t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},$t.prototype.reset=function(){this.next=this.g=this.h=null},$t);function $t(){this.next=this.g=this.h=null}function Jt(t,e){var n;Yt||(n=O.Promise.resolve(void 0),Yt=function(){n.then(ee)}),Zt||(Yt(),Zt=!0),te.add(t,e)}var Zt=!1,te=new Qt;function ee(){for(var t;e=t=void 0,e=null,(t=te).g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),t=e;){try{t.h.call(t.g)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var e=zt;e.j(t),e.h<100&&(e.h++,t.next=e.g,e.g=t)}Zt=!1}function ne(t,e){Bt.call(this),this.h=t||1,this.g=e||O,this.j=B(this.kb,this),this.l=Date.now()}function re(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function ie(t,e,n){if("function"==typeof t)n&&(t=B(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=B(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}K(ne,Bt),(k=ne.prototype).da=!1,k.S=null,k.kb=function(){var t;this.da&&(0<(t=Date.now()-this.l)&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),jt(this,"tick"),this.da&&(re(this),this.start())))},k.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},k.M=function(){ne.Z.M.call(this),re(this),delete this.g};var oe,se=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}N(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(ae,oe=G),ae.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:function t(e){e.g=ie(function(){e.g=null,e.i&&(e.i=!1,t(e))},e.j);var n=e.h;e.h=null,e.m.apply(null,n)}(this)},ae.prototype.M=function(){oe.prototype.M.call(this),this.g&&(O.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},ae);function ae(t,e){var n=oe.call(this)||this;return n.m=t,n.j=e,n.h=null,n.i=!1,n.g=null,n}function ue(t){G.call(this),this.h=t,this.g={}}K(ue,G);var ce=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function le(t){nt(t.g,function(t,e){this.g.hasOwnProperty(e)&&Pt(t)},t),t.g={}}function fe(){this.g=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.M=function(){ue.Z.M.call(this),le(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.Aa=function(){this.g=!1},fe.prototype.info=function(){};var pe={},ye=null;function ge(){return ye=ye||new Bt}function me(t){Et.call(this,pe.Ma,t)}function ve(){var t=ge();jt(t,new me(t))}function we(t,e){Et.call(this,pe.STAT_EVENT,t),this.stat=e}function be(t){var e=ge();jt(e,new we(e,t))}function Ee(t,e){Et.call(this,pe.Na,t),this.size=e}function Te(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}pe.Ma="serverreachability",K(me,Et),pe.STAT_EVENT="statevent",K(we,Et),pe.Na="timingevent",K(Ee,Et);var Ie={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},R={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function _e(){}function Se(t){return t.h||(t.h=t.i())}function Ae(){}_e.prototype.h=null;Qt={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function De(){Et.call(this,"d")}function Ne(){Et.call(this,"c")}function Ce(){}function ke(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new ue(this),this.P=Oe,this.W=new ne(t=lt?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}K(De,Et),K(Ne,Et),K(Ce,_e),Ce.prototype.g=function(){return new XMLHttpRequest},Ce.prototype.i=function(){return{}};var xe=new Ce,Oe=45e3,Le={},Pe={};function Me(t,e,n){t.K=1,t.v=on(Je(e)),t.s=n,t.U=!0,Fe(t,null)}function Fe(t,e){t.F=Date.now(),qe(t),t.A=Je(t.v);var s,a,u,c,h,l,n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),vn(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Re,t.g=wr(t.l,n?e:null,!t.s),0<t.O&&(t.L=new se(B(t.Ia,t,t.g),t.O)),he(t.V,t.g,"readystatechange",t.gb),e=t.H?rt(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),ve(),s=t.j,a=t.u,u=t.A,c=t.m,h=t.X,l=t.s,s.info(function(){if(s.g)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+a+"\n"+u+"\n"+t})}function Ve(t){return t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Ue(t,e,n){for(var r,i,o,s,a,u=!0;!t.I&&t.C<n.length;){if(o=n,a=s=void 0,s=(i=t).C,(r=-1==(a=o.indexOf("\n",s))?Pe:(s=Number(o.substring(s,a)),isNaN(s)?Le:(a+=1)+s>o.length?Pe:(o=o.substr(a,s),i.C=a+s,o)))==Pe){4==e&&(t.o=4,be(14),u=!1),de(t.j,t.m,null,"[Incomplete Response]");break}if(r==Le){t.o=4,be(15),de(t.j,t.m,n,"[Invalid Chunk]"),u=!1;break}de(t.j,t.m,r,null),Qe(t,r)}Ve(t)&&r!=Pe&&r!=Le&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,be(16),u=!1),t.i=t.i&&u,u?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),lr(e),e.L=!0,be(11))):(de(t.j,t.m,n,"[Invalid Chunked Response]"),Ge(t),Ke(t))}function qe(t){t.Y=Date.now()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Te(B(t.eb,t),e)}function je(t){t.B&&(O.clearTimeout(t.B),t.B=null)}function Ke(t){0==t.l.G||t.I||pr(t.l,t)}function Ge(t){je(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,re(t.W),le(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Qe(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||An(n.i,t)))if(n.I=t.N,!t.J&&An(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(y){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;dr(n),nr(n)}hr(n),be(18)}}else n.ta=i[1],0<n.ta-n.U&&i[2]<37500&&n.N&&0==n.A&&!n.v&&(n.v=Te(B(n.ab,n),6e3));if(Sn(n.i)<=1&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else gr(n,11)}else if(!t.J&&n.g!=t||dr(n),!X(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o,s,a,u,c,h,l,f,d,p,y=i[e];n.U=y[0],y=y[1],2==n.G?"c"==y[0]?(n.J=y[1],n.la=y[2],null!=(o=y[3])&&(n.ma=o,n.h.info("VER="+n.ma)),null!=(s=y[4])&&(n.za=s,n.h.info("SVER="+n.za)),null!=(a=y[5])&&"number"==typeof a&&0<a&&(r=1.5*a,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n,(u=t.g)&&(!(c=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null)||!(h=r.i).g&&(Z(c,"spdy")||Z(c,"quic")||Z(c,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(Dn(h,h.h),h.h=null)),!r.D||(l=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null)&&(r.sa=l,rn(r.F,r.D,l))),n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),f=t,(r=n).oa=vr(r,r.H?r.la:null,r.W),f.J?(Nn(r.i,f),d=f,(p=r.K)&&d.setTimeout(p),d.B&&(je(d),qe(d)),r.g=f):cr(r),0<n.l.length&&or(n)):"stop"!=y[0]&&"close"!=y[0]||gr(n,7):3==n.G&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?gr(n,7):er(n):"noop"!=y[0]&&n.j&&n.j.wa(y),n.A=0)}ve()}catch(y){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)z(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(P(t)||"string"==typeof t)for(var n=[],r=t.length,i=0;i<r;i++)n.push(i);else for(i in n=[],r=0,t)n[r++]=i;for(var i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Ye(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){for(var i={},n=e=0;e<t.g.length;)Ye(i,r=t.g[e])||(i[t.g[n++]=r]=1),e++;t.g.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(k=ke.prototype).setTimeout=function(t){this.P=t},k.gb=function(t){t=t.target;var e=this.L;e&&3==Xn(t)?e.l():this.Ia(t)},k.Ia=function(t){try{if(t==this.g)t:{var e=Xn(this.g),n=this.g.Da();this.g.ba();if(!(e<3)&&(3!=e||lt||this.g&&(this.h.h||this.g.ga()||$n(this.g)))){this.I||4!=e||7==n||ve(),je(this);var r=this.g.ba();this.N=r;e:if(Ve(this)){var i=$n(this.g);t="";var o=i.length,s=4==Xn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ge(this),Ke(this);var a="";break e}this.h.i=new O.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,t+=this.h.i.decode(i[n],{stream:s&&n==o-1});i.splice(0,o),this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.ga();if(this.i=200==r,l=this.j,f=this.u,d=this.A,p=this.m,y=this.X,g=e,m=r,l.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+y+"]: "+f+"\n"+d+"\n"+g+" "+m}),this.i){if(this.$&&!this.J){e:{if(this.g){var u,c=this.g;if((u=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(u)){var h=u;break e}}h=null}if(!(r=h)){this.i=!1,this.o=3,be(12),Ge(this),Ke(this);break t}de(this.j,this.m,r,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Qe(this,r)}this.U?(Ue(this,e,a),lt&&this.i&&3==e&&(he(this.V,this.W,"tick",this.fb),this.W.start())):(de(this.j,this.m,a,null),Qe(this,a)),4==e&&Ge(this),this.i&&!this.I&&(4==e?pr(this.l,this):(this.i=!1,qe(this)))}else 400==r&&0<a.indexOf("Unknown SID")?(this.o=3,be(12)):(this.o=0,be(13)),Ge(this),Ke(this)}}}catch(e){}var l,f,d,p,y,g,m},k.fb=function(){var t,e;this.g&&(t=Xn(this.g),e=this.g.ga(),this.C<e.length&&(je(this),Ue(this,t,e),this.i&&4!=t&&qe(this)))},k.cancel=function(){this.I=!0,Ge(this)},k.eb=function(){this.B=null;var t,e,n=Date.now();0<=n-this.Y?(t=this.j,e=this.A,t.info(function(){return"TIMEOUT: "+e}),2!=this.K&&(ve(),be(17)),Ge(this),this.o=2,Ke(this)):Be(this,this.Y-n)},(k=ze.prototype).R=function(){We(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},k.T=function(){return We(this),this.g.concat()},k.get=function(t,e){return Ye(this.h,t)?this.h[t]:e},k.set=function(t,e){Ye(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},k.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof $e?(this.g=void 0!==e?e:t.g,Ze(this,t.j),this.s=t.s,tn(this,t.i),en(this,t.m),this.l=t.l,e=t.h,(n=new pn).i=e.i,e.g&&(n.g=new ze(e.g),n.h=e.h),nn(this,n),this.o=t.o):t&&(n=String(t).match(Xe))?(this.g=!!e,Ze(this,n[1]||"",!0),this.s=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.l=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.o=sn(n[7]||"")):(this.g=!!e,this.h=new pn(null,this.g))}function Je(t){return new $e(t)}function Ze(t,e,n){t.j=n?sn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function tn(t,e,n){t.i=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.m=e}else t.m=null}function nn(t,e,n){var r,i;e instanceof pn?(t.h=e,r=t.h,(i=t.g)&&!r.j&&(yn(r),r.i=null,r.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(gn(this,e),vn(this,n,t))},r)),r.j=i):(n||(e=an(e,fn)),t.h=new pn(e,t.g))}function rn(t,e,n){t.h.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function an(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.j;e&&t.push(an(e,cn,!0),":");var n=this.i;return!n&&"file"!=e||(t.push("//"),(e=this.s)&&t.push(an(e,cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(an(n,"/"==n.charAt(0)?ln:hn,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",an(n,dn)),t.join("")};var cn=/[#\/\?@]/g,hn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,dn=/#/g;function pn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function yn(n){n.g||(n.g=new ze,n.h=0,n.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function gn(t,e){yn(t),e=wn(t,e),Ye(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Ye((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&We(t)))}function mn(t,e){return yn(t),e=wn(t,e),Ye(t.g.h,e)}function vn(t,e,n){gn(t,e),0<n.length&&(t.i=null,t.g.set(wn(t,e),Y(n)),t.h+=n.length)}function wn(t,e){return e=String(e),e=t.j?e.toLowerCase():e}(k=pn.prototype).add=function(t,e){yn(this),this.i=null,t=wn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},k.forEach=function(n,r){yn(this),this.g.forEach(function(t,e){z(t,function(t){n.call(r,t,e,this)},this)},this)},k.T=function(){yn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},k.R=function(t){yn(this);var e=[];if("string"==typeof t)mn(this,t)&&(e=W(e,this.g.get(wn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},k.set=function(t,e){return yn(this),this.i=null,mn(this,t=wn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},k.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},k.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.R(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.i=t.join("&")};var bn=function(t,e){this.h=t,this.g=e};function En(t){this.l=t||In,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.g&&O.g.Ea&&O.g.Ea()&&O.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Tn,In=10;function _n(t){return t.h||t.g&&t.g.size>=t.j}function Sn(t){return t.h?1:t.g?t.g.size:0}function An(t,e){return t.h?t.h==e:t.g&&t.g.has(e)}function Dn(t,e){t.g?t.g.add(e):t.h=e}function Nn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Cn(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null==t.g||0===t.g.size)return Y(t.i);var r=t.i;try{for(var i=C(t.g.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.D)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function kn(){}function Rn(){this.g=new kn}function xn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function On(t){this.l=t.$b||null,this.j=t.ib||!1}function Ln(t,e){Bt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Pn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}En.prototype.cancel=function(){var e,t;if(this.i=Cn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=C(this.g.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.g.clear()}},kn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},kn.prototype.parse=function(t){return O.JSON.parse(t,void 0)},K(On,_e),On.prototype.g=function(){return new Ln(this.l,this.j)},On.prototype.i=(Tn={},function(){return Tn}),K(Ln,Bt);var Pn=0;function Mn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Fn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Vn(t)}function Vn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(k=Ln.prototype).open=function(t,e){if(this.readyState!=Pn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Vn(this)},k.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||O).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},k.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Fn(this)),this.readyState=Pn},k.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Vn(this)),this.g&&(this.readyState=3,Vn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==O.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Mn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},k.Sa=function(t){var e;this.g&&(this.u&&t.value?this.response.push(t.value):this.u||(e=t.value||new Uint8Array(0),(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)),(t.done?Fn:Vn)(this),3==this.readyState&&Mn(this))},k.Ua=function(t){this.g&&(this.response=this.responseText=t,Fn(this))},k.Ta=function(t){this.g&&(this.response=t,Fn(this))},k.ha=function(){this.g&&Fn(this)},k.setRequestHeader=function(t,e){this.v.append(t,e)},k.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},k.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Ln.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Un=O.JSON.parse;function qn(t){Bt.call(this),this.headers=new ze,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Bn,this.K=this.L=!1}K(qn,Bt);var Bn="",jn=/^https?$/i,Kn=["POST","PUT"];function Gn(t){return"content-type"==t.toLowerCase()}function Qn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Hn(t),Wn(t)}function Hn(t){t.D||(t.D=!0,jt(t,"complete"),jt(t,"error"))}function zn(t){if(t.h&&void 0!==x&&(!t.C[1]||4!=Xn(t)||2!=t.ba()))if(t.v&&4==Xn(t))ie(t.Fa,0,t);else if(jt(t,"readystatechange"),4==Xn(t)){t.h=!1;try{var e,n,r,i,o=t.ba();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.H).match(Xe)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!jn.test(i?i.toLowerCase():"")),e=n),e)jt(t,"complete"),jt(t,"success");else{t.m=6;try{var a=2<Xn(t)?t.g.statusText:""}catch(t){a=""}t.j=a+" ["+t.ba()+"]",Hn(t)}}finally{Wn(t)}}}function Wn(t,e){if(t.g){Yn(t);var n=t.g,r=t.C[0]?L:null;t.g=null,t.C=null,e||jt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Yn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(O.clearTimeout(t.A),t.A=null)}function Xn(t){return t.g?t.g.readyState:0}function $n(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Bn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",nt(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Zn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function tr(t){this.za=0,this.l=[],this.h=new fe,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Zn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Zn("baseRetryDelayMs",5e3,t),this.$a=Zn("retryDelaySeedMs",1e4,t),this.Ya=Zn("forwardChannelMaxRetries",2,t),this.ra=Zn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new En(t&&t.concurrentRequestLimit),this.Ca=new Rn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function er(t){var e,n;rr(t),3==t.G&&(e=t.V++,rn(n=Je(t.F),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),ar(t,n),(e=new ke(t,t.h,e,void 0)).K=2,e.v=on(Je(n)),n=!1,!(n=O.navigator&&O.navigator.sendBeacon?O.navigator.sendBeacon(e.v.toString(),""):n)&&O.Image&&((new Image).src=e.v,n=!0),n||(e.g=wr(e.l,null),e.g.ea(e.v)),e.F=Date.now(),qe(e)),mr(t)}function nr(t){t.g&&(lr(t),t.g.cancel(),t.g=null)}function rr(t){nr(t),t.u&&(O.clearTimeout(t.u),t.u=null),dr(t),t.i.cancel(),t.m&&("number"==typeof t.m&&O.clearTimeout(t.m),t.m=null)}function ir(t,e){t.l.push(new bn(t.Za++,e)),3==t.G&&or(t)}function or(t){_n(t.i)||t.m||(t.m=!0,Jt(t.Ha,t),t.C=0)}function sr(t,e){var n=e?e.m:t.V++,r=Je(t.F);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.U),ar(t,r),t.o&&t.s&&Jn(r,t.o,t.s),n=new ke(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=ur(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Dn(t.i,n),Me(n,r,e)}function ar(t,n){t.j&&He({},function(t,e){rn(n,e,t)})}function ur(t,e,n){n=Math.min(t.l.length,n);var r=t.j?B(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].h,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].h,h=i[u].g;if((c-=o)<0)o=Math.max(0,i[u].h-100),a=!1;else try{!function(t,r,e){var i=e||"";try{He(t,function(t,e){var n=t;M(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function cr(t){t.g||t.u||(t.Y=1,Jt(t.Ga,t),t.A=0)}function hr(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=Te(B(t.Ga,t),yr(t,t.A)),t.A++,1)}function lr(t){null!=t.B&&(O.clearTimeout(t.B),t.B=null)}function fr(t){t.g=new ke(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Je(t.oa);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.N?"0":"1"),rn(e,"AID",t.U),ar(t,e),rn(e,"TYPE","xmlhttp"),t.o&&t.s&&Jn(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=on(Je(e)),n.s=null,n.U=!0,Fe(n,t)}function dr(t){null!=t.v&&(O.clearTimeout(t.v),t.v=null)}function pr(t,e){var n,r,i,o=null;if(t.g==e){dr(t),lr(t),t.g=null;var s=2}else{if(!An(t.i,e))return;o=e.D,Nn(t.i,e),s=1}if(t.I=e.N,0!=t.G)if(e.i)1==s?(o=e.s?e.s.length:0,e=Date.now()-e.F,n=t.C,jt(s=ge(),new Ee(s,o)),or(t)):cr(t);else if(3==(n=e.o)||0==n&&0<t.I||(1!=s||(i=e,Sn((r=t).i)>=r.i.j-(r.m?1:0)||(r.m?(r.l=i.D.concat(r.l),0):1==r.G||2==r.G||r.C>=(r.Xa?0:r.Ya)||(r.m=Te(B(r.Ha,r,i),yr(r,r.C)),r.C++,0))))&&(2!=s||!hr(t)))switch(o&&0<o.length&&(e=t.i,e.i=e.i.concat(o)),n){case 1:gr(t,5);break;case 4:gr(t,10);break;case 3:gr(t,6);break;default:gr(t,2)}}function yr(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function gr(t,e){var n,r,i,o;t.h.info("Error code "+e),2==e?(r=null,t.j&&(r=null),o=B(t.jb,t),r||(r=new $e("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Ze(r,"https"),on(r)),n=r.toString(),r=o,o=new fe,O.Image?((i=new Image).onload=j(xn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=j(xn,o,i,"TestLoadImage: error",!1,r),i.onabort=j(xn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=j(xn,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):be(2),t.G=0,t.j&&t.j.va(e),mr(t),rr(t)}function mr(t){t.G=0,t.I=-1,t.j&&(0==Cn(t.i).length&&0==t.l.length||(t.i.i.length=0,Y(t.l),t.l.length=0),t.j.ua())}function vr(t,e,n){var r,i,o,s,a,u=(s=n)instanceof $e?Je(s):new $e(s,void 0);return""!=u.i?(e&&tn(u,e+"."+u.i),en(u,u.m)):(a=O.location,r=a.protocol,i=e?e+"."+a.hostname:a.hostname,o=+a.port,s=n,a=new $e(null,void 0),r&&Ze(a,r),i&&tn(a,i),o&&en(a,o),s&&(a.l=s),u=a),t.aa&&nt(t.aa,function(t,e){rn(u,e,t)}),e=t.D,n=t.sa,e&&n&&rn(u,e,n),rn(u,"VER",t.ma),ar(t,u),u}function wr(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new qn(new On({ib:!0})):new qn(t.qa)).L=t.H,e}function br(){}function Er(){if(ct&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function Tr(t,e){Bt.call(this),this.g=new tr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!X(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!X(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new Sr(this)}function Ir(t){De.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function _r(){Ne.call(this),this.status=1}function Sr(t){this.g=t}(k=qn.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=(this.u||xe).g(),this.C=this.u?Se(this.u):Se(xe),this.g.onreadystatechange=B(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Qn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&He(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Gn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.T()),n=O.FormData&&t instanceof O.FormData,0<=H(Kn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.g.setRequestHeader(e,t)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Yn(this),0<this.B&&((this.K=(i=this.g,ct&&vt()&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=B(this.pa,this)):this.A=ie(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Qn(this,t)}},k.pa=function(){void 0!==x&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,jt(this,"timeout"),this.abort(8))},k.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,jt(this,"complete"),jt(this,"abort"),Wn(this))},k.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Wn(this,!0)),qn.Z.M.call(this)},k.Fa=function(){this.s||(this.F||this.v||this.l?zn(this):this.cb())},k.cb=function(){zn(this)},k.ba=function(){try{return 2<Xn(this)?this.g.status:-1}catch(t){return-1}},k.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},k.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Un(e)}},k.Da=function(){return this.m},k.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(k=tr.prototype).ma=8,k.G=1,k.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},k.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new ke(this,this.h,t,void 0),n=this.s;if(this.P&&(n?ot(n=rt(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if("__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=ur(this,e,r),rn(i=Je(this.F),"RID",t),rn(i,"CVER",22),this.D&&rn(i,"X-HTTP-Session-Id",this.D),ar(this,i),this.o&&n&&Jn(i,this.o,n),Dn(this.i,e),this.Ra&&rn(i,"TYPE","init"),this.ja?(rn(i,"$req",r),rn(i,"SID","null"),e.$=!0,Me(e,i,null)):Me(e,i,r),this.G=2}}else 3==this.G&&(t?sr(this,t):0==this.l.length||_n(this.i)||sr(this))},k.Ga=function(){var t;this.u=null,fr(this),this.$&&!(this.L||null==this.g||this.O<=0)&&(t=2*this.O,this.h.info("BP detection timer enabled: "+t),this.B=Te(B(this.bb,this),t))},k.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,be(10),nr(this),fr(this))},k.ab=function(){null!=this.v&&(this.v=null,nr(this),hr(this),be(19))},k.jb=function(t){t?(this.h.info("Successfully pinged google.com"),be(2)):(this.h.info("Failed to ping google.com"),be(1))},(k=br.prototype).xa=function(){},k.wa=function(){},k.va=function(){},k.ua=function(){},k.Oa=function(){},Er.prototype.g=function(t,e){return new Tr(t,e)},K(Tr,Bt),Tr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Jt(B(t.hb,t,e))),be(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=vr(t,null,t.W),or(t)},Tr.prototype.close=function(){er(this.g)},Tr.prototype.u=function(t){var e;"string"==typeof t?((e={}).__data__=t,ir(this.g,e)):this.v?((e={}).__data__=Gt(t),ir(this.g,e)):ir(this.g,t)},Tr.prototype.M=function(){this.g.j=null,delete this.j,er(this.g),delete this.g,Tr.Z.M.call(this)},K(Ir,De),K(_r,Ne),K(Sr,br),Sr.prototype.xa=function(){jt(this.g,"a")},Sr.prototype.wa=function(t){jt(this.g,new Ir(t))},Sr.prototype.va=function(t){jt(this.g,new _r)},Sr.prototype.ua=function(){jt(this.g,"b")},Er.prototype.createWebChannel=Er.prototype.g,Tr.prototype.send=Tr.prototype.u,Tr.prototype.open=Tr.prototype.m,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,R.COMPLETE="complete",(Ae.EventType=Qt).OPEN="a",Qt.CLOSE="b",Qt.ERROR="c",Qt.MESSAGE="d",Bt.prototype.listen=Bt.prototype.N,qn.prototype.listenOnce=qn.prototype.O,qn.prototype.getLastError=qn.prototype.La,qn.prototype.getLastErrorCode=qn.prototype.Da,qn.prototype.getStatus=qn.prototype.ba,qn.prototype.getResponseJson=qn.prototype.Qa,qn.prototype.getResponseText=qn.prototype.ga,qn.prototype.send=qn.prototype.ea;var Ar=ge,Dr=Ie,Nr=R,Cr=pe,kr=10,Rr=11,xr=On,Or=Ae,Lr=qn,Pr=(Mr.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Mr.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},Mr);function Mr(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}Pr.o=-1;var Fr,Vr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ur=(n(Br,Fr=Error),Br),qr=new A("@firebase/firestore");function Br(t,e){var n=this;return(n=Fr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function jr(){return qr.logLevel}function Kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];qr.logLevel<=w.DEBUG&&(e=n.map(Hr),qr.debug.apply(qr,s(["Firestore (8.10.0): "+t],e)))}function Gr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];qr.logLevel<=w.ERROR&&(e=n.map(Hr),qr.error.apply(qr,s(["Firestore (8.10.0): "+t],e)))}function Qr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];qr.logLevel<=w.WARN&&(e=n.map(Hr),qr.warn.apply(qr,s(["Firestore (8.10.0): "+t],e)))}function Hr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function zr(t){t="FIRESTORE (8.10.0) INTERNAL ASSERTION FAILED: "+(t=void 0===t?"Unexpected state":t);throw Gr(t),new Error(t)}function Wr(t){t||zr()}var Yr=(Xr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Xr);function Xr(){}function $r(t,e){return t<e?-1:e<t?1:0}function Jr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Zr(t){return t+"\0"}var ti=(ri.now=function(){return ri.fromMillis(Date.now())},ri.fromDate=function(t){return ri.fromMillis(t.getTime())},ri.fromMillis=function(t){var e=Math.floor(t/1e3);return new ri(e,Math.floor(1e6*(t-1e3*e)))},ri.prototype.toDate=function(){return new Date(this.toMillis())},ri.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ri.prototype._compareTo=function(t){return this.seconds===t.seconds?$r(this.nanoseconds,t.nanoseconds):$r(this.seconds,t.seconds)},ri.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ri.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ri.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ri.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ri),ei=(ni.fromTimestamp=function(t){return new ni(t)},ni.min=function(){return new ni(new ti(0,0))},ni.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},ni.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ni.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ni.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ni.prototype.toTimestamp=function(){return this.timestamp},ni);function ni(t){this.timestamp=t}function ri(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ur(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ur(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ur(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ur(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ii(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function oi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function si(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var ai,ui,R=(Object.defineProperty(vi.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),vi.prototype.isEqual=function(t){return 0===vi.comparator(this,t)},vi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof vi?t.forEach(function(t){e.push(t)}):e.push(t),this.construct(e)},vi.prototype.limit=function(){return this.offset+this.length},vi.prototype.popFirst=function(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},vi.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},vi.prototype.firstSegment=function(){return this.segments[this.offset]},vi.prototype.lastSegment=function(){return this.get(this.length-1)},vi.prototype.get=function(t){return this.segments[this.offset+t]},vi.prototype.isEmpty=function(){return 0===this.length},vi.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},vi.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},vi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},vi.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},vi.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},vi),ci=(n(mi,ui=R),mi.prototype.construct=function(t,e,n){return new mi(t,e,n)},mi.prototype.canonicalString=function(){return this.toArray().join("/")},mi.prototype.toString=function(){return this.canonicalString()},mi.fromString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new mi(n)},mi.emptyPath=function(){return new mi([])},mi),hi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,li=(n(gi,ai=R),gi.prototype.construct=function(t,e,n){return new gi(t,e,n)},gi.isValidIdentifier=function(t){return hi.test(t)},gi.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t=!gi.isValidIdentifier(t)?"`"+t+"`":t}).join(".")},gi.prototype.toString=function(){return this.canonicalString()},gi.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},gi.keyField=function(){return new gi(["__name__"])},gi.fromServerFormat=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ur(Vr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Ur(Vr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ur(Vr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new gi(e)},gi.emptyPath=function(){return new gi([])},gi),fi=(yi.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},yi.prototype.isEqual=function(t){return Jr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},yi),di=(pi.fromBase64String=function(t){return new pi(atob(t))},pi.fromUint8Array=function(t){return new pi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},pi.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},pi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},pi.prototype.approximateByteSize=function(){return 2*this.binaryString.length},pi.prototype.compareTo=function(t){return $r(this.binaryString,t.binaryString)},pi.prototype.isEqual=function(t){return this.binaryString===t.binaryString},pi);function pi(t){this.binaryString=t}function yi(t){(this.fields=t).sort(li.comparator)}function gi(){return null!==ai&&ai.apply(this,arguments)||this}function mi(){return null!==ui&&ui.apply(this,arguments)||this}function vi(t,e,n){void 0===e?e=0:e>t.length&&zr(),void 0===n?n=t.length-e:n>t.length-e&&zr(),this.segments=t,this.offset=e,this.len=n}di.EMPTY_BYTE_STRING=new di("");var wi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bi(t){if(Wr(!!t),"string"!=typeof t)return{seconds:Ei(t.seconds),nanos:Ei(t.nanos)};var e=0,n=wi.exec(t);Wr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ei(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ti(t){return"string"==typeof t?di.fromBase64String(t):di.fromUint8Array(t)}function Ii(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function _i(t){t=bi(t.mapValue.fields.__local_write_time__.timestampValue);return new ti(t.seconds,t.nanos)}function Si(t){return null==t}function Ai(t){return 0===t&&1/t==-1/0}function Di(t){return"number"==typeof t&&Number.isInteger(t)&&!Ai(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ni=(Ci.fromPath=function(t){return new Ci(ci.fromString(t))},Ci.fromName=function(t){return new Ci(ci.fromString(t).popFirst(5))},Ci.prototype.hasCollectionId=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Ci.prototype.isEqual=function(t){return null!==t&&0===ci.comparator(this.path,t.path)},Ci.prototype.toString=function(){return this.path.toString()},Ci.comparator=function(t,e){return ci.comparator(t.path,e.path)},Ci.isDocumentKey=function(t){return t.length%2==0},Ci.fromSegments=function(t){return new Ci(new ci(t.slice()))},Ci);function Ci(t){this.path=t}function ki(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ii(t)?4:10:zr()}function Ri(r,i){var t,e,n=ki(r);if(n!==ki(i))return!1;switch(n){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return _i(r).isEqual(_i(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=bi(r.timestampValue),t=bi(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return e=i,Ti(r.bytesValue).isEqual(Ti(e.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return t=i,Ei((e=r).geoPointValue.latitude)===Ei(t.geoPointValue.latitude)&&Ei(e.geoPointValue.longitude)===Ei(t.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ei(t.integerValue)===Ei(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Ei(t.doubleValue),e=Ei(e.doubleValue);return t===e?Ai(t)===Ai(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Jr(r.arrayValue.values||[],i.arrayValue.values||[],Ri);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(ii(e)!==ii(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Ri(e[t],n[t])))return!1;return!0}();default:return zr()}}function xi(t,e){return void 0!==(t.values||[]).find(function(t){return Ri(t,e)})}function Oi(t,e){var n,r,i,o=ki(t),s=ki(e);if(o!==s)return $r(o,s);switch(o){case 0:return 0;case 1:return $r(t.booleanValue,e.booleanValue);case 2:return r=e,i=Ei(t.integerValue||t.doubleValue),r=Ei(r.integerValue||r.doubleValue),i<r?-1:r<i?1:i===r?0:isNaN(i)?isNaN(r)?0:-1:1;case 3:return Li(t.timestampValue,e.timestampValue);case 4:return Li(_i(t),_i(e));case 5:return $r(t.stringValue,e.stringValue);case 6:return function(t,e){t=Ti(t),e=Ti(e);return t.compareTo(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=$r(n[i],r[i]);if(0!==o)return o}return $r(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=$r(Ei(n.latitude),Ei(i.latitude)))?r:$r(Ei(n.longitude),Ei(i.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Oi(n[i],r[i]);if(o)return o}return $r(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=$r(r[s],o[s]);if(0!==a)return a;a=Oi(n[r[s]],i[o[s]]);if(0!==a)return a}return $r(r.length,o.length)}(t.mapValue,e.mapValue);default:throw zr()}}function Li(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return $r(t,e);var n=bi(t),t=bi(e),e=$r(n.seconds,t.seconds);return 0!==e?e:$r(n.nanos,t.nanos)}function Pi(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){t=bi(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Ti(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Ni.fromName(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):zr();var e}(t)}function Mi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Fi(t){return t&&"integerValue"in t}function Vi(t){return!!t&&"arrayValue"in t}function Ui(t){return t&&"nullValue"in t}function qi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bi(t){return t&&"mapValue"in t}function ji(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var n={mapValue:{fields:{}}};return oi(t.mapValue.fields,function(t,e){return n.mapValue.fields[t]=ji(e)}),n}if(t.arrayValue){for(var e={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=ji(t.arrayValue.values[r]);return e}return Object.assign({},t)}var Ki=(Gi.empty=function(){return new Gi({mapValue:{}})},Gi.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Bi(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},Gi.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ji(e)},Gi.prototype.setAll=function(t){var r=this,i=li.emptyPath(),o={},s=[];t.forEach(function(t,e){var n;i.isImmediateParentOf(e)||(n=r.getFieldsMap(i),r.applyChanges(n,o,s),o={},s=[],i=e.popLast()),t?o[e.lastSegment()]=ji(t):s.push(e.lastSegment())});t=this.getFieldsMap(i);this.applyChanges(t,o,s)},Gi.prototype.delete=function(t){var e=this.field(t.popLast());Bi(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},Gi.prototype.isEqual=function(t){return Ri(this.value,t.value)},Gi.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Bi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},Gi.prototype.applyChanges=function(n,t,e){oi(t,function(t,e){return n[t]=e});for(var r=0,i=e;r<i.length;r++){var o=i[r];delete n[o]}},Gi.prototype.clone=function(){return new Gi(ji(this.value))},Gi);function Gi(t){this.value=t}var Qi=(zi.newInvalidDocument=function(t){return new zi(t,0,ei.min(),Ki.empty(),0)},zi.newFoundDocument=function(t,e,n){return new zi(t,1,e,n,0)},zi.newNoDocument=function(t,e){return new zi(t,2,e,Ki.empty(),0)},zi.newUnknownDocument=function(t,e){return new zi(t,3,e,Ki.empty(),2)},zi.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},zi.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Ki.empty(),this.documentState=0,this},zi.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Ki.empty(),this.documentState=2,this},zi.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},zi.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(zi.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(zi.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(zi.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),zi.prototype.isValidDocument=function(){return 0!==this.documentType},zi.prototype.isFoundDocument=function(){return 1===this.documentType},zi.prototype.isNoDocument=function(){return 2===this.documentType},zi.prototype.isUnknownDocument=function(){return 3===this.documentType},zi.prototype.isEqual=function(t){return t instanceof zi&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},zi.prototype.clone=function(){return new zi(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},zi.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},zi),Hi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.h=null};function zi(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}function Wi(t,e,n,r,i,o,s){return new Hi(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function Yi(t){var e=t;return null===e.h&&(t=e.path.canonicalString(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.canonicalString()+t.op.toString()+Pi(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.canonicalString()+t.dir}).join(","),Si(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=So(e.startAt)),e.endAt&&(t+="|ub:",t+=So(e.endAt)),e.h=t),e.h}function Xi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!Ri(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!No(t.startAt,e.startAt)&&No(t.endAt,e.endAt)}function $i(t){return Ni.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ji,Zi=(n(to,Ji=function(){}),to.create=function(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.l(t,e,n):new io(t,e,n):"array-contains"===e?new go(t,n):"in"===e?new mo(t,n):"not-in"===e?new vo(t,n):"array-contains-any"===e?new wo(t,n):new to(t,e,n)},to.l=function(t,e,n){return new("in"===e?oo:so)(t,n)},to.prototype.matches=function(t){t=t.data.field(this.field);return"!="===this.op?null!==t&&this.m(Oi(t,this.value)):null!==t&&ki(this.value)===ki(t)&&this.m(Oi(t,this.value))},to.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return zr()}},to.prototype.g=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},to);function to(t,e,n){var r=this;return(r=Ji.call(this)||this).field=t,r.op=e,r.value=n,r}var eo,no,ro,io=(n(co,ro=Zi),co.prototype.matches=function(t){t=Ni.comparator(t.key,this.key);return this.m(t)},co),oo=(n(uo,no=Zi),uo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},uo),so=(n(ao,eo=Zi),ao.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ao);function ao(t,e){var n=this;return(n=eo.call(this,t,"not-in",e)||this).keys=ho(0,e),n}function uo(t,e){var n=this;return(n=no.call(this,t,"in",e)||this).keys=ho(0,e),n}function co(t,e,n){var r=this;return(r=ro.call(this,t,e,n)||this).key=Ni.fromName(n.referenceValue),r}function ho(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Ni.fromName(t.referenceValue)})}var lo,fo,po,yo,go=(n(_o,yo=Zi),_o.prototype.matches=function(t){t=t.data.field(this.field);return Vi(t)&&xi(t.arrayValue,this.value)},_o),mo=(n(Io,po=Zi),Io.prototype.matches=function(t){t=t.data.field(this.field);return null!==t&&xi(this.value.arrayValue,t)},Io),vo=(n(To,fo=Zi),To.prototype.matches=function(t){if(xi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.data.field(this.field);return null!==t&&!xi(this.value.arrayValue,t)},To),wo=(n(Eo,lo=Zi),Eo.prototype.matches=function(t){var e=this,t=t.data.field(this.field);return!(!Vi(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return xi(e.value.arrayValue,t)})},Eo),bo=function(t,e){this.position=t,this.before=e};function Eo(t,e){return lo.call(this,t,"array-contains-any",e)||this}function To(t,e){return fo.call(this,t,"not-in",e)||this}function Io(t,e){return po.call(this,t,"in",e)||this}function _o(t,e){return yo.call(this,t,"array-contains",e)||this}function So(t){return(t.before?"b":"a")+":"+t.position.map(Pi).join(",")}var Ao=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Do(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.isKeyField()?Ni.comparator(Ni.fromName(s.referenceValue),n.key):Oi(s,n.data.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function No(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Ri(t.position[n],e.position[n]))return!1;return!0}var Co=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.p=null,this.T=null,this.startAt,this.endAt};function ko(t,e,n,r,i,o,s,a){return new Co(t,e,n,r,i,o,s,a)}function Ro(t){return new Co(t)}function xo(t){return!Si(t.limit)&&"F"===t.limitType}function Oo(t){return!Si(t.limit)&&"L"===t.limitType}function Lo(t){return 0<t.explicitOrderBy.length?t.explicitOrderBy[0].field:null}function Po(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Mo(t){return null!==t.collectionGroup}function Fo(t){var e=t;if(null===e.p){e.p=[];var n=Po(e),t=Lo(e);if(null!==n&&null===t)n.isKeyField()||e.p.push(new Ao(n)),e.p.push(new Ao(li.keyField(),"asc"));else{for(var r=!1,i=0,o=e.explicitOrderBy;i<o.length;i++){var s=o[i];e.p.push(s),s.field.isKeyField()&&(r=!0)}r||(n=0<e.explicitOrderBy.length?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",e.p.push(new Ao(li.keyField(),n)))}}return e.p}function Vo(t){var e=t;if(!e.T)if("F"===e.limitType)e.T=Wi(e.path,e.collectionGroup,Fo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Fo(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ao(o.field,s))}var a=e.endAt?new bo(e.endAt.position,!e.endAt.before):null,t=e.startAt?new bo(e.startAt.position,!e.startAt.before):null;e.T=Wi(e.path,e.collectionGroup,n,e.filters,e.limit,a,t)}return e.T}function Uo(t,e,n){return new Co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qo(t,e){return Xi(Vo(t),Vo(e))&&t.limitType===e.limitType}function Bo(t){return Yi(Vo(t))+"|lt:"+t.limitType}function jo(t){return"Query(target="+(e=Vo(t),n=e.path.canonicalString(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.canonicalString()+" "+t.op+" "+Pi(t.value)}).join(", ")+"]"),Si(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.canonicalString()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+So(e.startAt)),e.endAt&&(n+=", endAt: "+So(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Ko(i,t){return t.isFoundDocument()&&(e=i,n=t.key.path,null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ni.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n))&&function(t){for(var e=0,n=i.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&null===t.data.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Do(t.startAt,Fo(t),n))&&(!t.endAt||!Do(t.endAt,Fo(t),n)));var e,n}function Go(a){return function(t,e){for(var n=!1,r=0,i=Fo(a);r<i.length;r++){var o=i[r],s=function(t,r,e){var n=t.field.isKeyField()?Ni.comparator(r.key,e.key):function(t,e){var n=r.data.field(t),t=e.data.field(t);return null!==n&&null!==t?Oi(n,t):zr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return zr()}}(o,t,e);if(0!==s)return s;n=n||o.field.isKeyField()}return 0}}function Qo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ai(e)?"-0":e}}function Ho(t){return{integerValue:""+t}}function zo(t,e){return Di(e)?Ho(e):Qo(t,e)}A=function(){this._=void 0};function Wo(t,e){return t instanceof as?Fi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Yo,Xo,$o=(n(ts,Xo=A),ts),Jo=(n(Zo,Yo=A),Zo);function Zo(t){var e=this;return(e=Yo.call(this)||this).elements=t,e}function ts(){return null!==Xo&&Xo.apply(this,arguments)||this}function es(t,e){for(var n=hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Ri(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ns,rs=(n(is,ns=A),is);function is(t){var e=this;return(e=ns.call(this)||this).elements=t,e}function os(t,e){for(var n=hs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Ri(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ss,as=(n(us,ss=A),us);function us(t,e){var n=this;return(n=ss.call(this)||this).R=t,n.A=e,n}function cs(t){return Ei(t.integerValue||t.doubleValue)}function hs(t){return Vi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ls(t,e){this.version=t,this.transformResults=e}var fs=function(t,e){this.field=t,this.transform=e},ds=(ps.none=function(){return new ps},ps.exists=function(t){return new ps(void 0,t)},ps.updateTime=function(t){return new ps(t)},Object.defineProperty(ps.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),ps.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ps);function ps(t,e){this.updateTime=t,this.exists=e}function ys(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}R=function(){};function gs(t,e,n){var r,i,o,s;t instanceof Es?(i=e,o=n,ys((r=t).precondition,i)&&(s=r.value.clone(),o=Ds(r.fieldTransforms,o,i),s.setAll(o),i.convertToFoundDocument(vs(i),s).setHasLocalMutations())):t instanceof Ts?(o=e,i=n,ys((s=t).precondition,o)&&(n=Ds(s.fieldTransforms,i,o),(i=o.data).setAll(Ss(s)),i.setAll(n),o.convertToFoundDocument(vs(o),i).setHasLocalMutations())):(e=e,ys(t.precondition,e)&&e.convertToNoDocument(ei.min()))}function ms(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Jr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Jo&&e instanceof Jo||t instanceof rs&&e instanceof rs?Jr(t.elements,e.elements,Ri):t instanceof as&&e instanceof as?Ri(t.A,e.A):t instanceof $o&&e instanceof $o)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask));var n,r}function vs(t){return t.isFoundDocument()?t.version:ei.min()}var ws,bs,Es=(n(_s,bs=R),_s),Ts=(n(Is,ws=R),Is);function Is(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=ws.call(this)||this).key=t,o.data=e,o.fieldMask=n,o.precondition=r,o.fieldTransforms=i,o.type=1,o}function _s(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=bs.call(this)||this).key=t,i.value=e,i.precondition=n,i.fieldTransforms=r,i.type=0,i}function Ss(n){var r=new Map;return n.fieldMask.fields.forEach(function(t){var e;t.isEmpty()||(e=n.data.field(t),r.set(t,e))}),r}function As(t,e,n){var r=new Map;Wr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,(o=s,s=a,a=n[i],o instanceof Jo?es(o,s):o instanceof rs?os(o,s):a))}return r}function Ds(t,e,n){for(var r,i=new Map,o=0,s=t;o<s.length;o++){var a=s[o],u=a.transform,c=n.data.field(a.field);i.set(a.field,(r=c,a=e,c=void 0,(u=u)instanceof $o?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):u instanceof Jo?es(u,r):u instanceof rs?os(u,r):(u=Wo(c=u,r),r=cs(u)+cs(c.A),Fi(u)&&Fi(c.A)?Ho(r):Qo(c.R,r))))}return i}function Ns(t){this.count=t}var Cs,ks,Rs,xs=(n(Ps,Rs=R),Ps),Os=(n(Ls,ks=R),Ls);function Ls(t,e){var n=this;return(n=ks.call(this)||this).key=t,n.precondition=e,n.type=3,n.fieldTransforms=[],n}function Ps(t,e){var n=this;return(n=Rs.call(this)||this).key=t,n.precondition=e,n.type=2,n.fieldTransforms=[],n}function Ms(t){switch(t){case Vr.OK:return zr(),0;case Vr.CANCELLED:case Vr.UNKNOWN:case Vr.DEADLINE_EXCEEDED:case Vr.RESOURCE_EXHAUSTED:case Vr.INTERNAL:case Vr.UNAVAILABLE:case Vr.UNAUTHENTICATED:return;case Vr.INVALID_ARGUMENT:case Vr.NOT_FOUND:case Vr.ALREADY_EXISTS:case Vr.PERMISSION_DENIED:case Vr.FAILED_PRECONDITION:case Vr.ABORTED:case Vr.OUT_OF_RANGE:case Vr.UNIMPLEMENTED:case Vr.DATA_LOSS:return 1;default:return zr(),0}}function Fs(t){if(void 0===t)return Gr("GRPC error has no .code"),Vr.UNKNOWN;switch(t){case Cs.OK:return Vr.OK;case Cs.CANCELLED:return Vr.CANCELLED;case Cs.UNKNOWN:return Vr.UNKNOWN;case Cs.DEADLINE_EXCEEDED:return Vr.DEADLINE_EXCEEDED;case Cs.RESOURCE_EXHAUSTED:return Vr.RESOURCE_EXHAUSTED;case Cs.INTERNAL:return Vr.INTERNAL;case Cs.UNAVAILABLE:return Vr.UNAVAILABLE;case Cs.UNAUTHENTICATED:return Vr.UNAUTHENTICATED;case Cs.INVALID_ARGUMENT:return Vr.INVALID_ARGUMENT;case Cs.NOT_FOUND:return Vr.NOT_FOUND;case Cs.ALREADY_EXISTS:return Vr.ALREADY_EXISTS;case Cs.PERMISSION_DENIED:return Vr.PERMISSION_DENIED;case Cs.FAILED_PRECONDITION:return Vr.FAILED_PRECONDITION;case Cs.ABORTED:return Vr.ABORTED;case Cs.OUT_OF_RANGE:return Vr.OUT_OF_RANGE;case Cs.UNIMPLEMENTED:return Vr.UNIMPLEMENTED;case Cs.DATA_LOSS:return Vr.DATA_LOSS;default:return zr()}}(A=Cs=Cs||{})[A.OK=0]="OK",A[A.CANCELLED=1]="CANCELLED",A[A.UNKNOWN=2]="UNKNOWN",A[A.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",A[A.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",A[A.NOT_FOUND=5]="NOT_FOUND",A[A.ALREADY_EXISTS=6]="ALREADY_EXISTS",A[A.PERMISSION_DENIED=7]="PERMISSION_DENIED",A[A.UNAUTHENTICATED=16]="UNAUTHENTICATED",A[A.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",A[A.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",A[A.ABORTED=10]="ABORTED",A[A.OUT_OF_RANGE=11]="OUT_OF_RANGE",A[A.UNIMPLEMENTED=12]="UNIMPLEMENTED",A[A.INTERNAL=13]="INTERNAL",A[A.UNAVAILABLE=14]="UNAVAILABLE",A[A.DATA_LOSS=15]="DATA_LOSS";var Vs=(Ks.prototype.insert=function(t,e){return new Ks(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,qs.BLACK,null,null))},Ks.prototype.remove=function(t){return new Ks(this.comparator,this.root.remove(t,this.comparator).copy(null,null,qs.BLACK,null,null))},Ks.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ks.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ks.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(Ks.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ks.prototype.minKey=function(){return this.root.minKey()},Ks.prototype.maxKey=function(){return this.root.maxKey()},Ks.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},Ks.prototype.forEach=function(n){this.inorderTraversal(function(t,e){return n(t,e),!1})},Ks.prototype.toString=function(){var n=[];return this.inorderTraversal(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ks.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},Ks.prototype.getIterator=function(){return new Us(this.root,null,this.comparator,!1)},Ks.prototype.getIteratorFrom=function(t){return new Us(this.root,t,this.comparator,!1)},Ks.prototype.getReverseIterator=function(){return new Us(this.root,null,this.comparator,!0)},Ks.prototype.getReverseIteratorFrom=function(t){return new Us(this.root,t,this.comparator,!0)},Ks),Us=(js.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},js.prototype.hasNext=function(){return 0<this.nodeStack.length},js.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},js),qs=(Bs.prototype.copy=function(t,e,n,r,i){return new Bs(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Bs.prototype.isEmpty=function(){return!1},Bs.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},Bs.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},Bs.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},Bs.prototype.minKey=function(){return this.min().key},Bs.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},Bs.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},Bs.prototype.removeMin=function(){if(this.left.isEmpty())return Bs.EMPTY;var t=this;return(t=(t=!t.left.isRed()&&!t.left.left.isRed()?t.moveRedLeft():t).copy(null,null,null,t.left.removeMin(),null)).fixUp()},Bs.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=!(r.left.isEmpty()||r.left.isRed()||r.left.left.isRed())?r.moveRedLeft():r).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=!((r=r.left.isRed()?r.rotateRight():r).right.isEmpty()||r.right.isRed()||r.right.left.isRed())?r.moveRedRight():r).key)){if(r.right.isEmpty())return Bs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()},Bs.prototype.isRed=function(){return this.color},Bs.prototype.fixUp=function(){var t=this;return t=(t=(t=t.right.isRed()&&!t.left.isRed()?t.rotateLeft():t).left.isRed()&&t.left.left.isRed()?t.rotateRight():t).left.isRed()&&t.right.isRed()?t.colorFlip():t},Bs.prototype.moveRedLeft=function(){var t=this.colorFlip();return t=t.right.left.isRed()?(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip():t},Bs.prototype.moveRedRight=function(){var t=this.colorFlip();return t=t.left.left.isRed()?(t=t.rotateRight()).colorFlip():t},Bs.prototype.rotateLeft=function(){var t=this.copy(null,null,Bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Bs.prototype.rotateRight=function(){var t=this.copy(null,null,Bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Bs.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Bs.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},Bs.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw zr();if(this.right.isRed())throw zr();var t=this.left.check();if(t!==this.right.check())throw zr();return t+(this.isRed()?0:1)},Bs);function Bs(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Bs.RED,this.left=null!=r?r:Bs.EMPTY,this.right=null!=i?i:Bs.EMPTY,this.size=this.left.size+1+this.right.size}function js(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}function Ks(t,e){this.comparator=t,this.root=e||qs.EMPTY}function Gs(){this.size=0}qs.EMPTY=null,qs.RED=!0,qs.BLACK=!1,qs.EMPTY=(Object.defineProperty(Gs.prototype,"key",{get:function(){throw zr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gs.prototype,"value",{get:function(){throw zr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gs.prototype,"color",{get:function(){throw zr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gs.prototype,"left",{get:function(){throw zr()},enumerable:!1,configurable:!0}),Object.defineProperty(Gs.prototype,"right",{get:function(){throw zr()},enumerable:!1,configurable:!0}),Gs.prototype.copy=function(t,e,n,r,i){return this},Gs.prototype.insert=function(t,e,n){return new qs(t,e)},Gs.prototype.remove=function(t,e){return this},Gs.prototype.isEmpty=function(){return!0},Gs.prototype.inorderTraversal=function(t){return!1},Gs.prototype.reverseTraversal=function(t){return!1},Gs.prototype.minKey=function(){return null},Gs.prototype.maxKey=function(){return null},Gs.prototype.isRed=function(){return!1},Gs.prototype.checkMaxDepth=function(){return!0},Gs.prototype.check=function(){return 0},new Gs);var Qs=(Ys.prototype.has=function(t){return null!==this.data.get(t)},Ys.prototype.first=function(){return this.data.minKey()},Ys.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(Ys.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),Ys.prototype.indexOf=function(t){return this.data.indexOf(t)},Ys.prototype.forEach=function(n){this.data.inorderTraversal(function(t,e){return n(t),!1})},Ys.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,t[1]))return;e(r.key)}},Ys.prototype.forEachWhile=function(t,e){for(var n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},Ys.prototype.firstAfterOrEqual=function(t){t=this.data.getIteratorFrom(t);return t.hasNext()?t.getNext().key:null},Ys.prototype.getIterator=function(){return new Hs(this.data.getIterator())},Ys.prototype.getIteratorFrom=function(t){return new Hs(this.data.getIteratorFrom(t))},Ys.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},Ys.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Ys.prototype.isEmpty=function(){return this.data.isEmpty()},Ys.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Ys.prototype.isEqual=function(t){if(!(t instanceof Ys))return!1;if(this.size!==t.size)return!1;for(var e=this.data.getIterator(),n=t.data.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},Ys.prototype.toArray=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Ys.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Ys.prototype.copy=function(t){var e=new Ys(this.comparator);return e.data=t,e},Ys),Hs=(Ws.prototype.getNext=function(){return this.iter.getNext().key},Ws.prototype.hasNext=function(){return this.iter.hasNext()},Ws),zs=new Vs(Ni.comparator);function Ws(t){this.iter=t}function Ys(t){this.comparator=t,this.data=new Vs(this.comparator)}var Xs=new Vs(Ni.comparator);var $s=new Vs(Ni.comparator);var Js=new Qs(Ni.comparator);function Zs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Js,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ta=new Qs($r);var ea=(la.createSynthesizedRemoteEventForCurrentChange=function(t,e){var n=new Map;return n.set(t,na.createSynthesizedTargetChangeForCurrentChange(t,e)),new la(ei.min(),n,ta,zs,Zs())},la),na=(ha.createSynthesizedTargetChangeForCurrentChange=function(t,e){return new ha(di.EMPTY_BYTE_STRING,e,Zs(),Zs(),Zs())},ha),ra=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},ia=function(t,e){this.targetId=t,this.V=e},oa=function(t,e,n,r){void 0===n&&(n=di.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},sa=(Object.defineProperty(ca.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),ca.prototype.O=function(t){0<t.approximateByteSize()&&(this.k=!0,this.C=t)},ca.prototype.M=function(){var n=Zs(),r=Zs(),i=Zs();return this.D.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:zr()}}),new na(this.C,this.N,n,r,i)},ca.prototype.L=function(){this.k=!1,this.D=da()},ca.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},ca.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},ca.prototype.U=function(){this.S+=1},ca.prototype.K=function(){--this.S},ca.prototype.j=function(){this.k=!0,this.N=!0},ca),aa=(ua.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},ua.prototype.et=function(n){var r=this;this.forEachTarget(n,function(t){var e=r.nt(t);switch(n.state){case 0:r.st(t)&&e.O(n.resumeToken);break;case 1:e.K(),e.F||e.L(),e.O(n.resumeToken);break;case 2:e.K(),e.F||r.removeTarget(t);break;case 3:r.st(t)&&(e.j(),e.O(n.resumeToken));break;case 4:r.st(t)&&(r.it(t),e.O(n.resumeToken));break;default:zr()}})},ua.prototype.forEachTarget=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.G.forEach(function(t,e){r.st(e)&&n(e)})},ua.prototype.rt=function(t){var e=t.targetId,n=t.V.count,t=this.ot(e);t&&($i(t=t.target)?0===n?(t=new Ni(t.path),this.tt(e,t,Qi.newNoDocument(t,ei.min()))):Wr(1===n):this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e)))},ua.prototype.ut=function(r){var i=this,o=new Map;this.G.forEach(function(t,e){var n=i.ot(e);n&&(t.current&&$i(n.target)&&(n=new Ni(n.target.path),null!==i.H.get(n)||i.at(e,n)||i.tt(e,n,Qi.newNoDocument(n,r))),t.$&&(o.set(e,t.M()),t.L()))});var s=Zs();this.J.forEach(function(t,e){var n=!0;e.forEachWhile(function(t){t=i.ot(t);return!t||2===t.purpose||(n=!1)}),n&&(s=s.add(t))});var t=new ea(r,o,this.Y,this.H,s);return this.H=zs,this.J=fa(),this.Y=new Qs($r),t},ua.prototype.Z=function(t,e){var n;this.st(t)&&(n=this.at(t,e.key)?2:0,this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t)))},ua.prototype.tt=function(t,e,n){var r;this.st(t)&&(r=this.nt(t),this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n)))},ua.prototype.removeTarget=function(t){this.G.delete(t)},ua.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},ua.prototype.U=function(t){this.nt(t).U()},ua.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new sa,this.G.set(t,e)),e},ua.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Qs($r),this.J=this.J.insert(t,e)),e},ua.prototype.st=function(t){var e=null!==this.ot(t);return e||Kr("WatchChangeAggregator","Detected inactive target",t),e},ua.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},ua.prototype.it=function(e){var n=this;this.G.set(e,new sa),this.W.getRemoteKeysForTarget(e).forEach(function(t){n.tt(e,t,null)})},ua.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},ua);function ua(t){this.W=t,this.G=new Map,this.H=zs,this.J=fa(),this.Y=new Qs($r)}function ca(){this.S=0,this.D=da(),this.C=di.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}function ha(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}function la(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}function fa(){return new Vs(Ni.comparator)}function da(){return new Vs(Ni.comparator)}var pa={asc:"ASCENDING",desc:"DESCENDING"},ya={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ga=function(t,e){this.databaseId=t,this.I=e};function ma(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function va(t,e){return t.I?e.toBase64():e.toUint8Array()}function wa(t){return Wr(!!t),ei.fromTimestamp((t=bi(t),new ti(t.seconds,t.nanos)))}function ba(t,e){return new ci(["projects",t.projectId,"databases",t.database]).child("documents").child(e).canonicalString()}function Ea(t){t=ci.fromString(t);return Wr(Ba(t)),t}function Ta(t,e){return ba(t.databaseId,e.path)}function Ia(t,e){e=Ea(e);if(e.get(1)!==t.databaseId.projectId)throw new Ur(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.databaseId.projectId);if(e.get(3)!==t.databaseId.database)throw new Ur(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.databaseId.database);return new Ni(Da(e))}function _a(t,e){return ba(t.databaseId,e)}function Sa(t){t=Ea(t);return 4===t.length?ci.emptyPath():Da(t)}function Aa(t){return new ci(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Da(t){return Wr(4<t.length&&"documents"===t.get(4)),t.popFirst(5)}function Na(t,e,n){return{name:Ta(t,e),fields:n.value.mapValue.fields}}function Ca(t,e,n){var r=Ia(t,e.name),t=wa(e.updateTime),e=new Ki({mapValue:{fields:e.fields}}),e=Qi.newFoundDocument(r,t,e);return n&&e.setHasCommittedMutations(),n?e.setHasCommittedMutations():e}function ka(t,e){var n,r,i;if(e instanceof Es)n={update:Na(t,e.key,e.value)};else if(e instanceof xs)n={delete:Ta(t,e.key)};else if(e instanceof Ts)n={update:Na(t,e.key,e.data),updateMask:(r=e.fieldMask,i=[],r.fields.forEach(function(t){return i.push(t.canonicalString())}),{fieldPaths:i})};else{if(!(e instanceof Os))return zr();n={verify:Ta(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof $o)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(e instanceof Jo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:e.elements}};if(e instanceof rs)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:e.elements}};if(e instanceof as)return{fieldPath:t.field.canonicalString(),increment:e.A};throw zr()})),e.precondition.isNone||(n.currentDocument=void 0!==(e=e.precondition).updateTime?{updateTime:ma(t,e.updateTime.toTimestamp())}:void 0!==e.exists?{exists:e.exists}:zr()),n}function Ra(e,t){var n=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?ds.updateTime(wa(s.updateTime)):void 0!==s.exists?ds.exists(s.exists):ds.none():ds.none(),r=t.updateTransforms?t.updateTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Wr("REQUEST_TIME"===e.setToServerValue),r=new $o):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new Jo(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new rs(n)):"increment"in e?r=new as(t,e.increment):zr();e=li.fromServerFormat(e.fieldPath);return new fs(e,r)}(e,t)}):[];if(t.update){t.update.name;var i=Ia(e,t.update.name),o=new Ki({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new fi(s.map(function(t){return li.fromServerFormat(t)})));return new Ts(i,o,s,n,r)}return new Es(i,o,n,r)}if(t.delete){r=Ia(e,t.delete);return new xs(r,n)}if(t.verify){t=Ia(e,t.verify);return new Os(t,n)}return zr()}function xa(t,e){return{documents:[_a(t,e.path)]}}function Oa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=_a(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=_a(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(qi(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NAN"}};if(Ui(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(qi(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NOT_NAN"}};if(Ui(t.value))return{unaryFilter:{field:Fa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fa(t.field),op:(e=t.op,ya[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Fa((t=t).field),direction:(t=t.dir,pa[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.I||Si(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Pa(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Pa(e.endAt)),n}function La(t){var e=Sa(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Wr(1===r),(a=n.from[0]).allDescendants?i=a.collectionId:e=e.child(a.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[qa(t)]:void 0!==t.fieldFilter?[Ua(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):zr():[]}(n.where));var s=[],t=null,r=null,a=null;return ko(e,i,s=n.orderBy?n.orderBy.map(function(t){return new Ao(Va((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}):s,o,t=n.limit?Si(o="object"==typeof(o=n.limit)?o.value:o)?null:o:t,"F",r=n.startAt?Ma(n.startAt):r,a=n.endAt?Ma(n.endAt):a)}function Pa(t){return{before:t.before,values:t.position}}function Ma(t){var e=!!t.before,t=t.values||[];return new bo(t,e)}function Fa(t){return{fieldPath:t.canonicalString()}}function Va(t){return li.fromServerFormat(t.fieldPath)}function Ua(t){return Zi.create(Va(t.fieldFilter.field),function(){switch(t.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return zr()}}(),t.fieldFilter.value)}function qa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Va(t.unaryFilter.field);return Zi.create(e,"==",{doubleValue:NaN});case"IS_NULL":e=Va(t.unaryFilter.field);return Zi.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=Va(t.unaryFilter.field);return Zi.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":n=Va(t.unaryFilter.field);return Zi.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return zr()}}function Ba(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ja(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Ka(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return Ka(e)}function Ka(t){return t+"\x01\x01"}function Ga(t){var e=t.length;if(Wr(2<=e),2===e)return Wr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ci.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&zr(),t.charAt(s+1)){case"\x01":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:zr()}o=s+2}return new ci(r)}function Qa(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var Ha=function(t,e){this.seconds=t,this.nanoseconds=e};Qa.store="owner",Qa.key="owner";function za(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}za.store="mutationQueues",za.keyPath="userId";function Wa(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}Wa.store="mutations",Wa.keyPath="batchId",Wa.userMutationsIndex="userMutationsIndex",Wa.userMutationsKeyPath=["userId","batchId"];var Ya=(Xa.prefixForUser=function(t){return[t]},Xa.prefixForPath=function(t,e){return[t,ja(e)]},Xa.key=function(t,e,n){return[t,ja(e),n]},Xa);function Xa(){}Ya.store="documentMutations",Ya.PLACEHOLDER=new Ya;function $a(t,e){this.path=t,this.readTime=e}function Ja(t,e){this.path=t,this.version=e}var Za=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Za.store="remoteDocuments",Za.readTimeIndex="readTimeIndex",Za.readTimeIndexPath="readTime",Za.collectionReadTimeIndex="collectionReadTimeIndex",Za.collectionReadTimeIndexPath=["parentPath","readTime"];function tu(t){this.byteSize=t}tu.store="remoteDocumentGlobal",tu.key="remoteDocumentGlobalKey";function eu(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}eu.store="targets",eu.keyPath="targetId",eu.queryTargetsIndexName="queryTargetsIndex",eu.queryTargetsKeyPath=["canonicalId","targetId"];var nu=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};nu.store="targetDocuments",nu.keyPath=["targetId","path"],nu.documentTargetsIndex="documentTargetsIndex",nu.documentTargetsKeyPath=["path","targetId"];function ru(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}ru.key="targetGlobalKey",ru.store="targetGlobal";function iu(t,e){this.collectionId=t,this.parent=e}iu.store="collectionParents",iu.keyPath=["collectionId","parent"];function ou(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}ou.store="clientMetadata",ou.keyPath="clientId";function su(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}su.store="bundles",su.keyPath="bundleId";function au(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}au.store="namedQueries",au.keyPath="name";var uu,cu=s(s([],s(s([],s(s([],s(s([],[za.store,Wa.store,Ya.store,Za.store,eu.store,Qa.store,ru.store,nu.store]),[ou.store])),[tu.store])),[iu.store])),[su.store,au.store]),hu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",R=(Tu.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},Tu.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(t){return t()})},Tu),lu=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},fu=(Eu.prototype.catch=function(t){return this.next(void 0,t)},Eu.prototype.next=function(r,i){var o=this;return this.callbackAttached&&zr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(r,this.result):new Eu(function(e,n){o.nextCallback=function(t){o.wrapSuccess(r,t).next(e,n)},o.catchCallback=function(t){o.wrapFailure(i,t).next(e,n)}})},Eu.prototype.toPromise=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Eu.prototype.wrapUserFunction=function(t){try{var e=t();return e instanceof Eu?e:Eu.resolve(e)}catch(t){return Eu.reject(t)}},Eu.prototype.wrapSuccess=function(t,e){return t?this.wrapUserFunction(function(){return t(e)}):Eu.resolve(e)},Eu.prototype.wrapFailure=function(t,e){return t?this.wrapUserFunction(function(){return t(e)}):Eu.reject(e)},Eu.resolve=function(n){return new Eu(function(t,e){t(n)})},Eu.reject=function(n){return new Eu(function(t,e){e(n)})},Eu.waitFor=function(t){return new Eu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Eu.or=function(t){for(var n=Eu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Eu.resolve(t):e()})}(r[e]);return n},Eu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.waitFor(i)},Eu),du=(bu.open=function(t,e,n,r){try{return new bu(e,t.transaction(r,n))}catch(t){throw new gu(e,t)}},Object.defineProperty(bu.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),bu.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Kr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},bu.prototype.store=function(t){t=this.transaction.objectStore(t);return new _u(t)},bu),pu=(wu.delete=function(t){return Kr("SimpleDb","Removing database:",t),Au(window.indexedDB.deleteDatabase(t)).toPromise()},wu.yt=function(){if("undefined"==typeof indexedDB)return!1;if(wu.gt())return!0;var t=h(),e=wu._t(t),n=0<e&&e<10,e=wu.Et(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},wu.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},wu.It=function(t,e){return t.store(e)},wu._t=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},wu.Et=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},wu.prototype.At=function(o){return y(this,void 0,void 0,function(){var e,i=this;return g(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Kr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new gu(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new Ur(Vr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new gu(o,t))},r.onupgradeneeded=function(t){Kr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.wt.Rt(e,r.transaction,t.oldVersion,i.version).next(function(){Kr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return i.bt(t)}),this.db)]}})})},wu.prototype.vt=function(e){this.bt=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},wu.prototype.runTransaction=function(a,n,u,c){return y(this,void 0,void 0,function(){var i,o,s,e;return g(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.At(a)];case 2:return s.db=t.sent(),e=du.open(s.db,a,i?"readonly":"readwrite",u),n=c(e).catch(function(t){return e.abort(t),fu.reject(t)}).toPromise(),r={},n.catch(function(){}),[4,e.dt];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Kr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},wu.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},wu),yu=(Object.defineProperty(vu.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(vu.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(vu.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),vu.prototype.done=function(){this.Vt=!0},vu.prototype.Ct=function(t){this.St=t},vu.prototype.delete=function(){return Au(this.Pt.delete())},vu),gu=(n(mu,uu=Ur),mu);function mu(t,e){var n=this;return(n=uu.call(this,Vr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function vu(t){this.Pt=t,this.Vt=!1,this.St=null}function wu(t,e,n){this.name=t,this.version=e,this.wt=n,12.2===wu._t(h())&&Gr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function bu(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ft=new lu,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){t.error?n.ft.reject(new gu(e,t.error)):n.ft.resolve()},this.transaction.onerror=function(t){t=Nu(t.target.error);n.ft.reject(new gu(e,t))}}function Eu(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}function Tu(){this.onCommittedListeners=[]}function Iu(t){return"IndexedDbTransactionError"===t.name}var _u=(Su.prototype.put=function(t,e){t=void 0!==e?(Kr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Kr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return Au(t)},Su.prototype.add=function(t){return Kr("SimpleDb","ADD",this.store.name,t,t),Au(this.store.add(t))},Su.prototype.get=function(e){var n=this;return Au(this.store.get(e)).next(function(t){return Kr("SimpleDb","GET",n.store.name,e,t=void 0===t?null:t),t})},Su.prototype.delete=function(t){return Kr("SimpleDb","DELETE",this.store.name,t),Au(this.store.delete(t))},Su.prototype.count=function(){return Kr("SimpleDb","COUNT",this.store.name),Au(this.store.count())},Su.prototype.Nt=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.xt(e,function(t,e){n.push(e)}).next(function(){return n})},Su.prototype.kt=function(t,e){Kr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.Ft=!1;e=this.cursor(e);return this.xt(e,function(t,e,n){return n.delete()})},Su.prototype.$t=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.xt(n,e)},Su.prototype.Ot=function(r){var t=this.cursor({});return new fu(function(n,e){t.onerror=function(t){t=Nu(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Su.prototype.xt=function(t,i){var o=[];return new fu(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new yu(n),(t=i(n.primaryKey,n.value,e))instanceof fu&&(t=t.catch(function(t){return e.done(),fu.reject(t)}),o.push(t)),e.isDone?r():null===e.Dt?n.continue():n.continue(e.Dt)):r()}}).next(function(){return fu.waitFor(o)})},Su.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Su.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Su);function Su(t){this.store=t}function Au(t){return new fu(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Nu(t.target.error);n(t)}})}var Du=!1;function Nu(t){var e=pu._t(h());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new Ur("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Du||(Du=!0,setTimeout(function(){throw n},0)),n}}return t}var Cu,ku=(n(Ru,Cu=R),Ru);function Ru(t,e){var n=this;return(n=Cu.call(this)||this).Mt=t,n.currentSequenceNumber=e,n}function xu(t,e){return pu.It(t.Mt,e)}var Ou=(Uu.prototype.applyToRemoteDocument=function(t,e){for(var n,r,i,o,s,a,u=e.mutationResults,c=0;c<this.mutations.length;c++){var h=this.mutations[c];h.key.isEqual(t.key)&&(n=h,r=t,i=u[c],h=a=s=o=void 0,n instanceof Es?(s=r,a=i,h=(o=n).value.clone(),o=As(o.fieldTransforms,s,a.transformResults),h.setAll(o),s.convertToFoundDocument(a.version,h).setHasCommittedMutations()):n instanceof Ts?(o=r,s=i,ys((a=n).precondition,o)?(h=As(a.fieldTransforms,o,s.transformResults),(n=o.data).setAll(Ss(a)),n.setAll(h),o.convertToFoundDocument(s.version,n).setHasCommittedMutations()):o.convertToUnknownDocument(s.version)):r.convertToNoDocument(i.version).setHasCommittedMutations())}},Uu.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(r=n[e]).key.isEqual(t.key)&&gs(r,t,this.localWriteTime);for(var r,i=0,o=this.mutations;i<o.length;i++)(r=o[i]).key.isEqual(t.key)&&gs(r,t,this.localWriteTime)},Uu.prototype.applyToLocalDocumentSet=function(n){var r=this;this.mutations.forEach(function(t){var e=n.get(t.key),t=e;r.applyToLocalView(t),e.isValidDocument()||t.convertToNoDocument(ei.min())})},Uu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Zs())},Uu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Jr(this.mutations,t.mutations,ms)&&Jr(this.baseMutations,t.baseMutations,ms)},Uu),Lu=(Vu.from=function(t,e,n){Wr(t.mutations.length===n.length);for(var r=$s,i=t.mutations,o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new Vu(t,e,n,r)},Vu),Pu=(Fu.prototype.withSequenceNumber=function(t){return new Fu(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Fu.prototype.withResumeToken=function(t,e){return new Fu(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Fu.prototype.withLastLimboFreeSnapshotVersion=function(t){return new Fu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},Fu),Mu=function(t){this.Lt=t};function Fu(t,e,n,r,i,o,s){void 0===i&&(i=ei.min()),void 0===o&&(o=ei.min()),void 0===s&&(s=di.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vu(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}function Uu(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}function qu(t,e){if(e.document)return Ca(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Ni.fromSegments(e.noDocument.path),r=Qu(e.noDocument.readTime),n=Qi.newNoDocument(n,r);return e.hasCommittedMutations?n.setHasCommittedMutations():n}if(e.unknownDocument){n=Ni.fromSegments(e.unknownDocument.path),r=Qu(e.unknownDocument.version);return Qi.newUnknownDocument(n,r)}return zr()}function Bu(t,e,n){var r=ju(n),n=e.key.path.popLast().toArray();if(e.isFoundDocument()){var i={name:Ta(o=t.Lt,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:ma(o,s.version.toTimestamp())},o=e.hasCommittedMutations;return new Za(null,null,i,o,r,n)}if(e.isNoDocument()){var s=e.key.path.toArray(),i=Gu(e.version),o=e.hasCommittedMutations;return new Za(null,new $a(s,i),null,o,r,n)}if(e.isUnknownDocument()){o=e.key.path.toArray(),e=Gu(e.version);return new Za(new Ja(o,e),null,null,!0,r,n)}return zr()}function ju(t){t=t.toTimestamp();return[t.seconds,t.nanoseconds]}function Ku(t){t=new ti(t[0],t[1]);return ei.fromTimestamp(t)}function Gu(t){t=t.toTimestamp();return new Ha(t.seconds,t.nanoseconds)}function Qu(t){t=new ti(t.seconds,t.nanoseconds);return ei.fromTimestamp(t)}function Hu(e,t){for(var n=(t.baseMutations||[]).map(function(t){return Ra(e.Lt,t)}),r=0;r<t.mutations.length-1;++r){var i,o=t.mutations[r];r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform&&(i=t.mutations[r+1],o.updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r+1,1),++r)}var s=t.mutations.map(function(t){return Ra(e.Lt,t)}),a=ti.fromMillis(t.localWriteTimeMs);return new Ou(t.batchId,a,n,s)}function zu(t){var e=Qu(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Qu(t.lastLimboFreeSnapshotVersion):ei.min(),r=void 0!==t.query.documents?(Wr(1===(r=t.query).documents.length),Vo(Ro(Sa(r.documents[0])))):Vo(La(t.query));return new Pu(r,t.targetId,0,t.lastListenSequenceNumber,e,n,di.fromBase64String(t.resumeToken))}function Wu(t,e){var n=Gu(e.snapshotVersion),r=Gu(e.lastLimboFreeSnapshotVersion),i=($i(e.target)?xa:Oa)(t.Lt,e.target),t=e.resumeToken.toBase64();return new eu(e.targetId,Yi(e.target),n,t,e.sequenceNumber,r,i)}function Yu(t){var e=La({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Uo(e,e.limit,"L"):e}var Xu=($u.prototype.getBundleMetadata=function(t,e){return Ju(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:Qu(t.createTime),version:t.version}})},$u.prototype.saveBundleMetadata=function(t,e){return Ju(t).put({bundleId:(e=e).id,createTime:Gu(wa(e.createTime)),version:e.version})},$u.prototype.getNamedQuery=function(t,e){return Zu(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:Yu(t.bundledQuery),readTime:Qu(t.readTime)}})},$u.prototype.saveNamedQuery=function(t,e){return Zu(t).put({name:(e=e).name,readTime:Gu(wa(e.readTime)),bundledQuery:e.bundledQuery})},$u);function $u(){}function Ju(t){return xu(t,su.store)}function Zu(t){return xu(t,au.store)}var tc=(oc.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),fu.resolve()},oc.prototype.getCollectionParents=function(t,e){return fu.resolve(this.Bt.getEntries(e))},oc),ec=(ic.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Qs(ci.comparator),t=!r.has(n);return this.index[e]=r.add(n),t},ic.prototype.has=function(t){var e=t.lastSegment(),t=t.popLast(),e=this.index[e];return e&&e.has(t)},ic.prototype.getEntries=function(t){return(this.index[t]||new Qs(ci.comparator)).toArray()},ic),nc=(rc.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(this.qt.has(e))return fu.resolve();var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener(function(){n.qt.add(e)});i={collectionId:r,parent:ja(i)};return sc(t).put(i)},rc.prototype.getCollectionParents=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Zr(i),""],!1,!0);return sc(t).Nt(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Ga(r.parent))}return o})},rc);function rc(){this.qt=new ec}function ic(){this.index={}}function oc(){this.Bt=new ec}function sc(t){return xu(t,iu.store)}var ac={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uc=(cc.withCacheSize=function(t){return new cc(t,cc.DEFAULT_COLLECTION_PERCENTILE,cc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},cc);function cc(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}function hc(t,e,n){var r=t.store(Wa.store),i=t.store(Ya.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.$t({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Wr(1===s)}));for(var a=[],u=0,c=n.mutations;u<c.length;u++){var h=c[u],l=Ya.key(e,h.key.path,n.batchId);o.push(i.delete(l)),a.push(h.key)}return fu.waitFor(o).next(function(){return a})}function lc(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw zr();e=t.noDocument}return JSON.stringify(e).length}uc.DEFAULT_COLLECTION_PERCENTILE=10,uc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,uc.DEFAULT=new uc(41943040,uc.DEFAULT_COLLECTION_PERCENTILE,uc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),uc.DISABLED=new uc(-1,0,0);var fc=(dc.Qt=function(t,e,n,r){return Wr(""!==t.uid),new dc(t.isAuthenticated()?t.uid:"",e,n,r)},dc.prototype.checkEmpty=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return yc(t).$t({index:Wa.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},dc.prototype.addMutationBatch=function(p,y,g,m){var v=this,w=gc(p),b=yc(p);return b.add({}).next(function(t){Wr("number"==typeof t);for(var e,n,r,i,o,s=new Ou(t,y,g,m),a=(e=v.R,n=v.userId,i=(r=s).baseMutations.map(function(t){return ka(e.Lt,t)}),o=r.mutations.map(function(t){return ka(e.Lt,t)}),new Wa(n,r.batchId,r.localWriteTime.toMillis(),i,o)),u=[],c=new Qs(function(t,e){return $r(t.canonicalString(),e.canonicalString())}),h=0,l=m;h<l.length;h++){var f=l[h],d=Ya.key(v.userId,f.key.path,t),c=c.add(f.key.path.popLast());u.push(b.put(a)),u.push(w.put(d,Ya.PLACEHOLDER))}return c.forEach(function(t){u.push(v.Ut.addToCollectionParentIndex(p,t))}),p.addOnCommittedListener(function(){v.Kt[t]=s.keys()}),fu.waitFor(u).next(function(){return s})})},dc.prototype.lookupMutationBatch=function(t,e){var n=this;return yc(t).get(e).next(function(t){return t?(Wr(t.userId===n.userId),Hu(n.R,t)):null})},dc.prototype.jt=function(t,e){var n=this;return this.Kt[e]?fu.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next(function(t){if(t){t=t.keys();return n.Kt[e]=t}return null})},dc.prototype.getNextMutationBatchAfterBatchId=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return yc(t).$t({index:Wa.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Wr(e.batchId>=i),o=Hu(r.R,e)),n.done()}).next(function(){return o})},dc.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return yc(t).$t({index:Wa.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},dc.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return yc(t).Nt(Wa.userMutationsIndex,n).next(function(t){return t.map(function(t){return Hu(e.R,t)})})},dc.prototype.getAllMutationBatchesAffectingDocumentKey=function(o,s){var a=this,t=Ya.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),u=[];return gc(o).$t({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ga(i);if(r===a.userId&&s.path.isEqual(i))return yc(o).get(t).next(function(t){if(!t)throw zr();Wr(t.userId===a.userId),u.push(Hu(a.R,t))});n.done()}).next(function(){return u})},dc.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var s=this,a=new Qs($r),n=[];return t.forEach(function(o){var t=Ya.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=gc(e).$t({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ga(i);r===s.userId&&o.path.isEqual(i)?a=a.add(t):n.done()});n.push(t)}),fu.waitFor(n).next(function(){return s.Wt(e,a)})},dc.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var o=this,s=e.path,a=s.length+1,e=Ya.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),u=new Qs($r);return gc(t).$t({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Ga(i);r===o.userId&&s.isPrefixOf(i)?i.length===a&&(u=u.add(t)):n.done()}).next(function(){return o.Wt(t,u)})},dc.prototype.Wt=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(yc(e).get(t).next(function(t){if(null===t)throw zr();Wr(t.userId===n.userId),r.push(Hu(n.R,t))}))}),fu.waitFor(i).next(function(){return r})},dc.prototype.removeMutationBatch=function(e,n){var r=this;return hc(e.Mt,this.userId,n).next(function(t){return e.addOnCommittedListener(function(){r.Gt(n.batchId)}),fu.forEach(t,function(t){return r.referenceDelegate.markPotentiallyOrphaned(e,t)})})},dc.prototype.Gt=function(t){delete this.Kt[t]},dc.prototype.performConsistencyCheck=function(e){var i=this;return this.checkEmpty(e).next(function(t){if(!t)return fu.resolve();var t=IDBKeyRange.lowerBound(Ya.prefixForUser(i.userId)),r=[];return gc(e).$t({range:t},function(t,e,n){t[0]===i.userId?(t=Ga(t[1]),r.push(t)):n.done()}).next(function(){Wr(0===r.length)})})},dc.prototype.containsKey=function(t,e){return pc(t,this.userId,e)},dc.prototype.zt=function(t){var e=this;return mc(t).get(this.userId).next(function(t){return t||new za(e.userId,-1,"")})},dc);function dc(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}function pc(t,o,e){var e=Ya.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),a=!1;return gc(t).$t({range:e,Ft:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(a=!0),n.done()}).next(function(){return a})}function yc(t){return xu(t,Wa.store)}function gc(t){return xu(t,Ya.store)}function mc(t){return xu(t,za.store)}var vc=(Ec.prototype.next=function(){return this.Ht+=2,this.Ht},Ec.Jt=function(){return new Ec(0)},Ec.Yt=function(){return new Ec(-1)},Ec),wc=(bc.prototype.allocateTargetId=function(n){var r=this;return this.Xt(n).next(function(t){var e=new vc(t.highestTargetId);return t.highestTargetId=e.next(),r.Zt(n,t).next(function(){return t.highestTargetId})})},bc.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next(function(t){return ei.fromTimestamp(new ti(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},bc.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next(function(t){return t.highestListenSequenceNumber})},bc.prototype.setTargetsMetadata=function(e,n,r){var i=this;return this.Xt(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.toTimestamp()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Zt(e,t)})},bc.prototype.addTargetData=function(e,n){var r=this;return this.te(e,n).next(function(){return r.Xt(e).next(function(t){return t.targetCount+=1,r.ee(n,t),r.Zt(e,t)})})},bc.prototype.updateTargetData=function(t,e){return this.te(t,e)},bc.prototype.removeTargetData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return Tc(e).delete(t.targetId)}).next(function(){return n.Xt(e)}).next(function(t){return Wr(0<t.targetCount),--t.targetCount,n.Zt(e,t)})},bc.prototype.removeTargets=function(n,r,i){var o=this,s=0,a=[];return Tc(n).$t(function(t,e){e=zu(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,a.push(o.removeTargetData(n,e)))}).next(function(){return fu.waitFor(a)}).next(function(){return s})},bc.prototype.forEachTarget=function(t,n){return Tc(t).$t(function(t,e){e=zu(e);n(e)})},bc.prototype.Xt=function(t){return Ic(t).get(ru.key).next(function(t){return Wr(null!==t),t})},bc.prototype.Zt=function(t,e){return Ic(t).put(ru.key,e)},bc.prototype.te=function(t,e){return Tc(t).put(Wu(this.R,e))},bc.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},bc.prototype.getTargetCount=function(t){return this.Xt(t).next(function(t){return t.targetCount})},bc.prototype.getTargetData=function(t,r){var e=Yi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Tc(t).$t({range:e,index:eu.queryTargetsIndexName},function(t,e,n){e=zu(e);Xi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},bc.prototype.addMatchingKeys=function(n,t,r){var i=this,o=[],s=_c(n);return t.forEach(function(t){var e=ja(t.path);o.push(s.put(new nu(r,e))),o.push(i.referenceDelegate.addReference(n,r,t))}),fu.waitFor(o)},bc.prototype.removeMatchingKeys=function(n,t,r){var i=this,o=_c(n);return fu.forEach(t,function(t){var e=ja(t.path);return fu.waitFor([o.delete([r,e]),i.referenceDelegate.removeReference(n,r,t)])})},bc.prototype.removeMatchingKeysForTargetId=function(t,e){t=_c(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},bc.prototype.getMatchingKeysForTargetId=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=_c(t),r=Zs();return t.$t({range:e,Ft:!0},function(t,e,n){t=Ga(t[1]),t=new Ni(t);r=r.add(t)}).next(function(){return r})},bc.prototype.containsKey=function(t,e){var e=ja(e.path),e=IDBKeyRange.bound([e],[Zr(e)],!1,!0),i=0;return _c(t).$t({index:nu.documentTargetsIndex,Ft:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},bc.prototype.lt=function(t,e){return Tc(t).get(e).next(function(t){return t?zu(t):null})},bc);function bc(t,e){this.referenceDelegate=t,this.R=e}function Ec(t){this.Ht=t}function Tc(t){return xu(t,eu.store)}function Ic(t){return xu(t,ru.store)}function _c(t){return xu(t,nu.store)}function Sc(e){return y(this,void 0,void 0,function(){return g(this,function(t){if(e.code!==Vr.FAILED_PRECONDITION||e.message!==hu)throw e;return Kr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Ac(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=$r(n,t);return 0===t?$r(r,e):t}var Dc=(Lc.prototype.ie=function(){return++this.se},Lc.prototype.re=function(t){var e=[t,this.ie()];this.buffer.size<this.ne?this.buffer=this.buffer.add(e):Ac(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Lc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Lc),Nc=(Oc.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},Oc.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(Oc.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),Oc.prototype.ue=function(n){var t=this,e=this.oe?3e5:6e4;Kr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:this.ce=null,this.oe=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.collectGarbage(this.garbageCollector)];case 2:return t.sent(),[3,7];case 3:return Iu(e=t.sent())?(Kr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Sc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.ue(n)];case 8:return t.sent(),[2]}})})})},Oc),Cc=(xc.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next(function(t){return Math.floor(e/100*t)})},xc.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return fu.resolve(Pr.o);var r=new Dc(e);return this.ae.forEachTarget(t,function(t){return r.re(t.sequenceNumber)}).next(function(){return n.ae.le(t,function(t){return r.re(t)})}).next(function(){return r.maxValue})},xc.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},xc.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},xc.prototype.collect=function(e,n){var r=this;return-1===this.params.cacheSizeCollectionThreshold?(Kr("LruGarbageCollector","Garbage collection skipped; disabled"),fu.resolve(ac)):this.getCacheSize(e).next(function(t){return t<r.params.cacheSizeCollectionThreshold?(Kr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.cacheSizeCollectionThreshold),ac):r.fe(e,n)})},xc.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},xc.prototype.fe=function(e,n){var r,i,o,s,a,u,c,h=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(t){return i=t>h.params.maximumSequenceNumbersToCollect?(Kr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+t),h.params.maximumSequenceNumbersToCollect):t,s=Date.now(),h.nthSequenceNumber(e,i)}).next(function(t){return r=t,a=Date.now(),h.removeTargets(e,r,n)}).next(function(t){return o=t,u=Date.now(),h.removeOrphanedDocuments(e,r)}).next(function(t){return c=Date.now(),jr()<=w.DEBUG&&Kr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(a-s)+"ms\n\tRemoved "+o+" targets in "+(u-a)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-l)+"ms"),fu.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:t})})},xc),kc=(Rc.prototype.he=function(t){var n=this.de(t);return this.db.getTargetCache().getTargetCount(t).next(function(e){return n.next(function(t){return e+t})})},Rc.prototype.de=function(t){var e=0;return this.le(t,function(t){e++}).next(function(){return e})},Rc.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},Rc.prototype.le=function(t,n){return this.we(t,function(t,e){return n(e)})},Rc.prototype.addReference=function(t,e,n){return Pc(t,n)},Rc.prototype.removeReference=function(t,e,n){return Pc(t,n)},Rc.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},Rc.prototype.markPotentiallyOrphaned=Pc,Rc.prototype._e=function(t,e){return r=e,i=!1,mc(n=t).Ot(function(t){return pc(n,t,r).next(function(t){return t&&(i=!0),fu.resolve(!t)})}).next(function(){return i});var n,r,i},Rc.prototype.removeOrphanedDocuments=function(n,r){var i=this,o=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],a=0;return this.we(n,function(e,t){t<=r&&(t=i._e(n,e).next(function(t){if(!t)return a++,o.getEntry(n,e).next(function(){return o.removeEntry(e),_c(n).delete([0,ja(e.path)])})}),s.push(t))}).next(function(){return fu.waitFor(s)}).next(function(){return o.apply(n)}).next(function(){return a})},Rc.prototype.removeTarget=function(t,e){e=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,e)},Rc.prototype.updateLimboDocument=Pc,Rc.prototype.we=function(t,r){var i,t=_c(t),o=Pr.o;return t.$t({index:nu.documentTargetsIndex},function(t,e){var n=t[0];t[1];t=e.path,e=e.sequenceNumber;0===n?(o!==Pr.o&&r(new Ni(Ga(i)),o),o=e,i=t):o=Pr.o}).next(function(){o!==Pr.o&&r(new Ni(Ga(i)),o)})},Rc.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},Rc);function Rc(t,e){this.db=t,this.garbageCollector=new Cc(this,e)}function xc(t,e){this.ae=t,this.params=e}function Oc(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}function Lc(t){this.ne=t,this.buffer=new Qs(Ac),this.se=0}function Pc(t,e){return _c(t).put((t=t.currentSequenceNumber,new nu(0,ja(e.path),t)))}var Mc,Fc=(Kc.prototype.get=function(t){var e=this.mapKeyFn(t),e=this.inner[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.equalsFn(o,t))return i}},Kc.prototype.has=function(t){return void 0!==this.get(t)},Kc.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},Kc.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},Kc.prototype.forEach=function(s){oi(this.inner,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Kc.prototype.isEmpty=function(){return si(this.inner)},Kc),A=(jc.prototype.getReadTime=function(t){t=this.changes.get(t);return t?t.readTime:ei.min()},jc.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},jc.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Qi.newInvalidDocument(t),readTime:e})},jc.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?fu.resolve(n.document):this.getFromCache(t,e)},jc.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},jc.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},jc.prototype.assertNotApplied=function(){},jc),Vc=(Bc.prototype.addEntry=function(t,e,n){return Qc(t).put(Hc(e),n)},Bc.prototype.removeEntry=function(t,e){t=Qc(t),e=Hc(e);return t.delete(e)},Bc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.me(e,t)})},Bc.prototype.getEntry=function(t,e){var n=this;return Qc(t).get(Hc(e)).next(function(t){return n.ye(e,t)})},Bc.prototype.ge=function(t,e){var n=this;return Qc(t).get(Hc(e)).next(function(t){return{document:n.ye(e,t),size:lc(t)}})},Bc.prototype.getEntries=function(t,e){var n=this,r=zs;return this.pe(t,e,function(t,e){e=n.ye(t,e);r=r.insert(t,e)}).next(function(){return r})},Bc.prototype.Ee=function(t,e){var r=this,i=zs,o=new Vs(Ni.comparator);return this.pe(t,e,function(t,e){var n=r.ye(t,e);i=i.insert(t,n),o=o.insert(t,lc(e))}).next(function(){return{documents:i,Te:o}})},Bc.prototype.pe=function(t,e,i){if(e.isEmpty())return fu.resolve();var n=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),o=e.getIterator(),s=o.getNext();return Qc(t).$t({range:n},function(t,e,n){for(var r=Ni.fromSegments(t);s&&Ni.comparator(s,r)<0;)i(s,null),s=o.getNext();s&&s.isEqual(r)&&(i(s,e),s=o.hasNext()?o.getNext():null),s?n.Ct(s.path.toArray()):n.done()}).next(function(){for(;s;)i(s,null),s=o.hasNext()?o.getNext():null})},Bc.prototype.getDocumentsMatchingQuery=function(t,r,e){var n,i=this,o=zs,s=r.path.length+1,a={};return e.isEqual(ei.min())?(n=r.path.toArray(),a.range=IDBKeyRange.lowerBound(n)):(n=r.path.toArray(),e=ju(e),a.range=IDBKeyRange.lowerBound([n,e],!0),a.index=Za.collectionReadTimeIndex),Qc(t).$t(a,function(t,e,n){t.length===s&&(e=qu(i.R,e),r.path.isPrefixOf(e.key.path)?Ko(r,e)&&(o=o.insert(e.key,e)):n.done())}).next(function(){return o})},Bc.prototype.newChangeBuffer=function(t){return new Uc(this,!!t&&t.trackRemovals)},Bc.prototype.getSize=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Bc.prototype.getMetadata=function(t){return Gc(t).get(tu.key).next(function(t){return Wr(!!t),t})},Bc.prototype.me=function(t,e){return Gc(t).put(tu.key,e)},Bc.prototype.ye=function(t,e){if(e){e=qu(this.R,e);if(!e.isNoDocument()||!e.version.isEqual(ei.min()))return e}return Qi.newInvalidDocument(t)},Bc),Uc=(n(qc,Mc=A),qc.prototype.applyChanges=function(i){var o=this,s=[],a=0,u=new Qs(function(t,e){return $r(t.canonicalString(),e.canonicalString())});return this.changes.forEach(function(t,e){var n,r=o.Ae.get(t);e.document.isValidDocument()?(n=Bu(o.Ie.R,e.document,o.getReadTime(t)),u=u.add(t.path.popLast()),e=lc(n),a+=e-r,s.push(o.Ie.addEntry(i,t,n))):(a-=r,o.trackRemovals?(r=Bu(o.Ie.R,Qi.newNoDocument(t,ei.min()),o.getReadTime(t)),s.push(o.Ie.addEntry(i,t,r))):s.push(o.Ie.removeEntry(i,t)))}),u.forEach(function(t){s.push(o.Ie.Ut.addToCollectionParentIndex(i,t))}),s.push(this.Ie.updateMetadata(i,a)),fu.waitFor(s)},qc.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next(function(t){return n.Ae.set(e,t.size),t.document})},qc.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next(function(t){var e=t.documents;return t.Te.forEach(function(t,e){n.Ae.set(t,e)}),e})},qc);function qc(t,e){var n=this;return(n=Mc.call(this)||this).Ie=t,n.trackRemovals=e,n.Ae=new Fc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Bc(t,e){this.R=t,this.Ut=e}function jc(){this.changes=new Fc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.changesApplied=!1}function Kc(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}function Gc(t){return xu(t,tu.store)}function Qc(t){return xu(t,Za.store)}function Hc(t){return t.path.toArray()}var zc=(Wc.prototype.Rt=function(e,n,t,r){var i=this;Wr(t<r&&0<=t&&r<=11);var o=new du("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Qa.store),(s=e).createObjectStore(za.store,{keyPath:za.keyPath}),s.createObjectStore(Wa.store,{keyPath:Wa.keyPath,autoIncrement:!0}).createIndex(Wa.userMutationsIndex,Wa.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Ya.store),Yc(e),e.createObjectStore(Za.store));var s,a=fu.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(nu.store),s.deleteObjectStore(eu.store),s.deleteObjectStore(ru.store),Yc(e)),a=a.next(function(){return t=o.store(ru.store),e=new ru(0,0,ei.min().toTimestamp(),0),t.put(ru.key,e);var t,e})),t<4&&4<=r&&(a=(a=0!==t?a.next(function(){return n=e,(r=o).store(Wa.store).Nt().next(function(t){n.deleteObjectStore(Wa.store),n.createObjectStore(Wa.store,{keyPath:Wa.keyPath,autoIncrement:!0}).createIndex(Wa.userMutationsIndex,Wa.userMutationsKeyPath,{unique:!0});var e=r.store(Wa.store),t=t.map(function(t){return e.put(t)});return fu.waitFor(t)});var n,r}):a).next(function(){e.createObjectStore(ou.store,{keyPath:ou.keyPath})})),t<5&&5<=r&&(a=a.next(function(){return i.Re(o)})),t<6&&6<=r&&(a=a.next(function(){return e.createObjectStore(tu.store),i.be(o)})),t<7&&7<=r&&(a=a.next(function(){return i.ve(o)})),t<8&&8<=r&&(a=a.next(function(){return i.Pe(e,o)})),t<9&&9<=r&&(a=a.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Za.store)).createIndex(Za.readTimeIndex,Za.readTimeIndexPath,{unique:!1}),t.createIndex(Za.collectionReadTimeIndex,Za.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(a=a.next(function(){return i.Ve(o)})),a=t<11&&11<=r?a.next(function(){e.createObjectStore(su.store,{keyPath:su.keyPath}),e.createObjectStore(au.store,{keyPath:au.keyPath})}):a},Wc.prototype.be=function(e){var n=0;return e.store(Za.store).$t(function(t,e){n+=lc(e)}).next(function(){var t=new tu(n);return e.store(tu.store).put(tu.key,t)})},Wc.prototype.Re=function(n){var r=this,t=n.store(za.store),i=n.store(Wa.store);return t.Nt().next(function(t){return fu.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Nt(Wa.userMutationsIndex,t).next(function(t){return fu.forEach(t,function(t){Wr(t.userId===e.userId);t=Hu(r.R,t);return hc(n,e.userId,t).next(function(){})})})})})},Wc.prototype.ve=function(t){var o=t.store(nu.store),e=t.store(Za.store);return t.store(ru.store).get(ru.key).next(function(r){var i=[];return e.$t(function(t,e){var n=new ci(t),t=[0,ja(n)];i.push(o.get(t).next(function(t){return t?fu.resolve():o.put(new nu(0,ja(n),r.highestListenSequenceNumber))}))}).next(function(){return fu.waitFor(i)})})},Wc.prototype.Pe=function(t,e){t.createObjectStore(iu.store,{keyPath:iu.keyPath});function r(t){if(i.add(t)){var e=t.lastSegment(),t=t.popLast();return n.put({collectionId:e,parent:ja(t)})}}var n=e.store(iu.store),i=new ec;return e.store(Za.store).$t({Ft:!0},function(t,e){t=new ci(t);return r(t.popLast())}).next(function(){return e.store(Ya.store).$t({Ft:!0},function(t,e){t[0];var n=t[1];t[2];n=Ga(n);return r(n.popLast())})})},Wc.prototype.Ve=function(t){var n=this,r=t.store(eu.store);return r.$t(function(t,e){e=zu(e),e=Wu(n.R,e);return r.put(e)})},Wc);function Wc(t){this.R=t}function Yc(t){t.createObjectStore(nu.store,{keyPath:nu.keyPath}).createIndex(nu.documentTargetsIndex,nu.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(eu.store,{keyPath:eu.keyPath}).createIndex(eu.queryTargetsIndexName,eu.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ru.store)}var Xc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",$c=(Jc.prototype.start=function(){var e=this;return this.je().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Ur(Vr.FAILED_PRECONDITION,Xc);return e.We(),e.Ge(),e.ze(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.qe.getHighestSequenceNumber(t)})}).then(function(t){e.Ne=new Pr(t,e.De)}).then(function(){e.xe=!0}).catch(function(t){return e.Be&&e.Be.close(),Promise.reject(t)})},Jc.prototype.He=function(n){var t=this;return this.Me=function(e){return y(t,void 0,void 0,function(){return g(this,function(t){return this.started?[2,n(e)]:[2]})})},n(this.isPrimary)},Jc.prototype.setDatabaseDeletedListener=function(n){var t=this;this.Be.vt(function(e){return y(t,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Jc.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget(function(){return y(e,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Jc.prototype.je=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return th(e).put(new ou(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Je(e).next(function(t){t||(n.isPrimary=!1,n.Se.enqueueRetryable(function(){return n.Me(!1)}))})}).next(function(){return n.Ye(e)}).next(function(t){return n.isPrimary&&!t?n.Xe(e).next(function(){return!1}):!!t&&n.Ze(e).next(function(){return!0})})}).catch(function(t){if(Iu(t))return Kr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Kr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Se.enqueueRetryable(function(){return n.Me(t)}),n.isPrimary=t})},Jc.prototype.Je=function(t){var e=this;return Zc(t).get(Qa.key).next(function(t){return fu.resolve(e.tn(t))})},Jc.prototype.en=function(t){return th(t).delete(this.clientId)},Jc.prototype.nn=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return g(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=xu(t,ou.store);return r.Nt().next(function(t){var e=o.rn(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return fu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Qe)for(n=0,r=e;n<r.length;n++)i=r[n],this.Qe.removeItem(this.on(i.clientId));t.label=2;case 2:return[2]}})})},Jc.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return t.je().then(function(){return t.nn()}).then(function(){return t.ze()})})},Jc.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},Jc.prototype.Ye=function(e){var r=this;return this.Ce?fu.resolve(!0):Zc(e).get(Qa.key).next(function(t){if(null!==t&&r.sn(t.leaseTimestampMs,5e3)&&!r.cn(t.ownerId)){if(r.tn(t)&&r.networkEnabled)return!0;if(!r.tn(t)){if(!t.allowTabSynchronization)throw new Ur(Vr.FAILED_PRECONDITION,Xc);return!1}}return!(!r.networkEnabled||!r.inForeground)||th(e).Nt().next(function(t){return void 0===r.rn(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Kr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Jc.prototype.shutdown=function(){return y(this,void 0,void 0,function(){var n=this;return g(this,function(t){switch(t.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Qa.store,ou.store],function(t){var e=new ku(t,Pr.o);return n.Xe(e).next(function(){return n.en(e)})})];case 1:return t.sent(),this.Be.close(),this.ln(),[2]}})})},Jc.prototype.rn=function(t,e){var n=this;return t.filter(function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)})},Jc.prototype.fn=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return th(t).Nt().next(function(t){return e.rn(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Jc.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),Jc.prototype.getMutationQueue=function(t){return fc.Qt(t,this.R,this.Ut,this.referenceDelegate)},Jc.prototype.getTargetCache=function(){return this.qe},Jc.prototype.getRemoteDocumentCache=function(){return this.Ue},Jc.prototype.getIndexManager=function(){return this.Ut},Jc.prototype.getBundleCache=function(){return this.Ke},Jc.prototype.runTransaction=function(e,n,r){var i,o=this;return Kr("IndexedDbPersistence","Starting transaction:",e),this.Be.runTransaction(e,"readonly"===n?"readonly":"readwrite",cu,function(t){return i=new ku(t,o.Ne?o.Ne.next():Pr.o),"readwrite-primary"===n?o.Je(i).next(function(t){return!!t||o.Ye(i)}).next(function(t){if(!t)throw Gr("Failed to obtain primary lease for action '"+e+"'."),o.isPrimary=!1,o.Se.enqueueRetryable(function(){return o.Me(!1)}),new Ur(Vr.FAILED_PRECONDITION,hu);return r(i)}).next(function(t){return o.Ze(i).next(function(){return t})}):o.dn(i).next(function(){return r(i)})}).then(function(t){return i.raiseOnCommittedEvent(),t})},Jc.prototype.dn=function(t){var e=this;return Zc(t).get(Qa.key).next(function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ur(Vr.FAILED_PRECONDITION,Xc)})},Jc.prototype.Ze=function(t){var e=new Qa(this.clientId,this.allowTabSynchronization,Date.now());return Zc(t).put(Qa.key,e)},Jc.yt=function(){return pu.yt()},Jc.prototype.Xe=function(t){var e=this,n=Zc(t);return n.get(Qa.key).next(function(t){return e.tn(t)?(Kr("IndexedDbPersistence","Releasing primary lease."),n.delete(Qa.key)):fu.resolve()})},Jc.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Gr("Detected an update time that is in the future: "+t+" > "+n),1))},Jc.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget(function(){return t.inForeground="visible"===t.document.visibilityState,t.je()})},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},Jc.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},Jc.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),c()&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget(function(){return e.shutdown()})},this.window.addEventListener("pagehide",this.ke))},Jc.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},Jc.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Kr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Gr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Jc.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Gr("Failed to set zombie client id.",t)}},Jc.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},Jc.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Jc);function Jc(t,e,n,r,i,o,s,a,u,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Se=i,this.window=o,this.document=s,this.De=u,this.Ce=c,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!Jc.yt())throw new Ur(Vr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kc(this,r),this.Le=e+"main",this.R=new Mu(a),this.Be=new pu(this.Le,11,new zc(this.R)),this.qe=new wc(this.referenceDelegate,this.R),this.Ut=new nc,this.Ue=(e=this.R,a=this.Ut,new Vc(e,a)),this.Ke=new Xu,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===c&&Gr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Zc(t){return xu(t,Qa.store)}function th(t){return xu(t,ou.store)}function eh(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function nh(t,e){this.progress=t,this.wn=e}var rh=(hh.prototype.mn=function(e,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,n).next(function(t){return r.yn(e,n,t)})},hh.prototype.yn=function(t,e,r){return this.Ue.getEntry(t,e).next(function(t){for(var e=0,n=r;e<n.length;e++)n[e].applyToLocalView(t);return t})},hh.prototype.gn=function(t,i){t.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)r[n].applyToLocalView(e)})},hh.prototype.pn=function(e,t){var n=this;return this.Ue.getEntries(e,t).next(function(t){return n.En(e,t).next(function(){return t})})},hh.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next(function(t){return n.gn(e,t)})},hh.prototype.getDocumentsMatchingQuery=function(t,e,n){return r=e,Ni.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Tn(t,e.path):Mo(e)?this.In(t,e,n):this.An(t,e,n);var r},hh.prototype.Tn=function(t,e){return this.mn(t,new Ni(e)).next(function(t){var e=Xs;return e=t.isFoundDocument()?e.insert(t.key,t):e})},hh.prototype.In=function(n,r,i){var o=this,s=r.collectionGroup,a=Xs;return this.Ut.getCollectionParents(n,s).next(function(t){return fu.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Co(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.An(n,e,i).next(function(t){t.forEach(function(t,e){a=a.insert(t,e)})})}).next(function(){return a})})},hh.prototype.An=function(e,n,t){var c,h,r=this;return this.Ue.getDocumentsMatchingQuery(e,n,t).next(function(t){return c=t,r._n.getAllMutationBatchesAffectingQuery(e,n)}).next(function(t){return h=t,r.Rn(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a);null==u&&(u=Qi.newInvalidDocument(a),c=c.insert(a,u)),gs(s,u,r.localWriteTime),u.isFoundDocument()||(c=c.remove(a))}})}).next(function(){return c.forEach(function(t,e){Ko(n,e)||(c=c.remove(t))}),c})},hh.prototype.Rn=function(t,e,n){for(var r=Zs(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof Ts&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next(function(t){return t.forEach(function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))}),c})},hh),ih=(ch.Pn=function(t,e){for(var n=Zs(),r=Zs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ch(t,e.fromCache,n,r)},ch),oh=(uh.prototype.Vn=function(t){this.Sn=t},uh.prototype.getDocumentsMatchingQuery=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())||i.isEqual(ei.min())?this.Dn(e,r):this.Sn.pn(e,o).next(function(t){var n=s.Cn(r,t);return(xo(r)||Oo(r))&&s.Nn(r.limitType,n,o,i)?s.Dn(e,r):(jr()<=w.DEBUG&&Kr("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),jo(r)),s.Sn.getDocumentsMatchingQuery(e,r,i).next(function(e){return n.forEach(function(t){e=e.insert(t.key,t)}),e}))})},uh.prototype.Cn=function(n,t){var r=new Qs(Go(n));return t.forEach(function(t,e){Ko(n,e)&&(r=r.add(e))}),r},uh.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.compareTo(r))},uh.prototype.Dn=function(t,e){return jr()<=w.DEBUG&&Kr("QueryEngine","Using full collection scan to execute query:",jo(e)),this.Sn.getDocumentsMatchingQuery(t,e,ei.min())},uh),sh=(ah.prototype.collectGarbage=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.collect(t,n.kn)})},ah);function ah(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new Vs($r),this.Fn=new Fc(Yi,Xi),this.$n=ei.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new rh(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}function uh(){}function ch(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}function hh(t,e,n){this.Ue=t,this._n=e,this.Ut=n}function lh(t,e,n,r){return new sh(t,e,n,r)}function fh(i,o){return y(this,void 0,void 0,function(){var e,n,v,r;return g(this,function(t){switch(t.label){case 0:return n=(e=i)._n,v=e.Mn,[4,e.persistence.runTransaction("Handle user change","readonly",function(g){var m;return e._n.getAllMutationBatches(g).next(function(t){return m=t,n=e.persistence.getMutationQueue(o),v=new rh(e.On,n,e.persistence.getIndexManager()),n.getAllMutationBatches(g)}).next(function(t){for(var e=[],n=[],r=Zs(),i=0,o=m;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var c=u[a],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var d=0,p=f.mutations;d<p.length;d++){var y=p[d];r=r.add(y.key)}}return v.pn(g,r).next(function(t){return{Ln:t,removedBatchIds:e,addedBatchIds:n}})})})];case 1:return r=t.sent(),[2,(e._n=n,e.Mn=v,e.xn.Vn(e.Mn),r)]}})})}function dh(t,h){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,a,u=h.batch.keys(),c=l.On.newChangeBuffer({trackRemovals:!0});return e=l,r=t,o=c,s=(i=h).batch,n=s.keys(),a=fu.resolve(),n.forEach(function(n){a=a.next(function(){return o.getEntry(r,n)}).next(function(t){var e=i.docVersions.get(n);Wr(null!==e),t.version.compareTo(e)<0&&(s.applyToRemoteDocument(t,i),t.isValidDocument()&&o.addEntry(t,i.commitVersion))})}),a.next(function(){return e._n.removeMutationBatch(r,s)}).next(function(){return c.apply(t)}).next(function(){return l._n.performConsistencyCheck(t)}).next(function(){return l.Mn.pn(t,u)})})}function ph(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.qe.getLastRemoteSnapshotVersion(t)})}function yh(t,r){var u=t,c=r.snapshotVersion,h=u.kn;return u.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=u.On.newChangeBuffer({trackRemovals:!0});h=u.kn;var a=[];r.targetChanges.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(a.push(u.qe.removeMatchingKeys(s,t.removedDocuments,e).next(function(){return u.qe.addMatchingKeys(s,t.addedDocuments,e)})),0<(i=t.resumeToken).approximateByteSize()&&(n=o.withResumeToken(i,c).withSequenceNumber(s.currentSequenceNumber),h=h.insert(e,n),r=o,i=t,Wr(0<(o=n).resumeToken.approximateByteSize()),(0===r.resumeToken.approximateByteSize()||3e8<=o.snapshotVersion.toMicroseconds()-r.snapshotVersion.toMicroseconds()||0<i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size)&&a.push(u.qe.updateTargetData(s,n))))});var e,n=zs;return r.documentUpdates.forEach(function(t,e){r.resolvedLimboDocuments.has(t)&&a.push(u.persistence.referenceDelegate.updateLimboDocument(s,t))}),a.push(gh(s,t,r.documentUpdates,c,void 0).next(function(t){n=t})),c.isEqual(ei.min())||(e=u.qe.getLastRemoteSnapshotVersion(s).next(function(t){return u.qe.setTargetsMetadata(s,s.currentSequenceNumber,c)}),a.push(e)),fu.waitFor(a).next(function(){return t.apply(s)}).next(function(){return u.Mn.En(s,n)}).next(function(){return n})}).then(function(t){return u.kn=h,t})}function gh(t,s,e,a,u){var n=Zs();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=zs;return e.forEach(function(t,e){var n=i.get(t),r=(null==u?void 0:u.get(t))||a;e.isNoDocument()&&e.version.isEqual(ei.min())?(s.removeEntry(t,r),o=o.insert(t,e)):!n.isValidDocument()||0<e.version.compareTo(n.version)||0===e.version.compareTo(n.version)&&n.hasPendingWrites?(s.addEntry(e,r),o=o.insert(t,e)):Kr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function mh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.qe.getTargetData(e,r).next(function(t){return t?(n=t,fu.resolve(n)):i.qe.allocateTargetId(e).next(function(t){return n=new Pu(r,t,0,e.currentSequenceNumber),i.qe.addTargetData(e,n).next(function(){return n})})})}).then(function(t){var e=i.kn.get(t.targetId);return(null===e||0<t.snapshotVersion.compareTo(e.snapshotVersion))&&(i.kn=i.kn.insert(t.targetId,t),i.Fn.set(r,t.targetId)),t})}function vh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:n=(e=i).kn.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.referenceDelegate.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Iu(r=t.sent()))throw r;return Kr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.kn=e.kn.remove(o),e.Fn.delete(n.target),[2]}})})}function wh(t,o,s){var a=t,u=ei.min(),c=Zs();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=Vo(o),(void 0!==(t=(i=t).Fn.get(r))?fu.resolve(i.kn.get(t)):i.qe.getTargetData(n,r)).next(function(t){if(t)return u=t.lastLimboFreeSnapshotVersion,a.qe.getMatchingKeysForTargetId(e,t.targetId).next(function(t){c=t})}).next(function(){return a.xn.getDocumentsMatchingQuery(e,o,s?u:ei.min(),s?c:Zs())}).next(function(t){return{documents:t,Bn:c}});var t,n,r,i})}function bh(t,e){var n=t,r=n.qe,t=n.kn.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.lt(t,e).next(function(t){return t?t.target:null})})}function Eh(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.On,n=t,t=s.$n,r=e,i=zs,o=ju(t),t=Qc(n),n=IDBKeyRange.lowerBound(o,!0),t.$t({index:Za.readTimeIndex,range:n},function(t,e){var n=qu(r.R,e);i=i.insert(n.key,n),o=e.readTime}).next(function(){return{wn:i,readTime:Ku(o)}});var e,n,r,i,o}).then(function(t){var e=t.wn,t=t.readTime;return s.$n=t,e})}function Th(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Qc(t),r=ei.min(),t.$t({index:Za.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Ku(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.$n=t})]})})}var Ih,_h,Sh=(Hh.prototype.getBundleMetadata=function(t,e){return fu.resolve(this.Qn.get(e))},Hh.prototype.saveBundleMetadata=function(t,e){return this.Qn.set(e.id,{id:e.id,version:e.version,createTime:wa(e.createTime)}),fu.resolve()},Hh.prototype.getNamedQuery=function(t,e){return fu.resolve(this.jn.get(e))},Hh.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,{name:(e=e).name,query:Yu(e.bundledQuery),readTime:wa(e.readTime)}),fu.resolve()},Hh),Ah=(Qh.prototype.isEmpty=function(){return this.Wn.isEmpty()},Qh.prototype.addReference=function(t,e){e=new Dh(t,e);this.Wn=this.Wn.add(e),this.zn=this.zn.add(e)},Qh.prototype.Jn=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},Qh.prototype.removeReference=function(t,e){this.Yn(new Dh(t,e))},Qh.prototype.Xn=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},Qh.prototype.Zn=function(t){var e=this,n=new Ni(new ci([])),r=new Dh(n,t),t=new Dh(n,t+1),i=[];return this.zn.forEachInRange([r,t],function(t){e.Yn(t),i.push(t.key)}),i},Qh.prototype.ts=function(){var e=this;this.Wn.forEach(function(t){return e.Yn(t)})},Qh.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},Qh.prototype.es=function(t){var e=new Ni(new ci([])),n=new Dh(e,t),t=new Dh(e,t+1),r=Zs();return this.zn.forEachInRange([n,t],function(t){r=r.add(t.key)}),r},Qh.prototype.containsKey=function(t){var e=new Dh(t,0),e=this.Wn.firstAfterOrEqual(e);return null!==e&&t.isEqual(e.key)},Qh),Dh=(Gh.Gn=function(t,e){return Ni.comparator(t.key,e.key)||$r(t.ns,e.ns)},Gh.Hn=function(t,e){return $r(t.ns,e.ns)||Ni.comparator(t.key,e.key)},Gh),Nh=(Kh.prototype.checkEmpty=function(t){return fu.resolve(0===this._n.length)},Kh.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,0<this._n.length&&this._n[this._n.length-1];n=new Ou(i,e,n,r);this._n.push(n);for(var o=0,s=r;o<s.length;o++){var a=s[o];this.rs=this.rs.add(new Dh(a.key,i)),this.Ut.addToCollectionParentIndex(t,a.key.path.popLast())}return fu.resolve(n)},Kh.prototype.lookupMutationBatch=function(t,e){return fu.resolve(this.os(e))},Kh.prototype.getNextMutationBatchAfterBatchId=function(t,e){e=this.cs(e+1),e=e<0?0:e;return fu.resolve(this._n.length>e?this._n[e]:null)},Kh.prototype.getHighestUnacknowledgedBatchId=function(){return fu.resolve(0===this._n.length?-1:this.ss-1)},Kh.prototype.getAllMutationBatches=function(t){return fu.resolve(this._n.slice())},Kh.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Dh(e,0),e=new Dh(e,Number.POSITIVE_INFINITY),i=[];return this.rs.forEachInRange([r,e],function(t){t=n.os(t.ns);i.push(t)}),fu.resolve(i)},Kh.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Qs($r);return e.forEach(function(t){var e=new Dh(t,0),t=new Dh(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,t],function(t){r=r.add(t.ns)})}),fu.resolve(this.us(r))},Kh.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,e=n;Ni.isDocumentKey(e)||(e=e.child(""));var e=new Dh(new Ni(e),0),i=new Qs($r);return this.rs.forEachWhile(function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(i=i.add(t.ns)),!0)},e),fu.resolve(this.us(i))},Kh.prototype.us=function(t){var e=this,n=[];return t.forEach(function(t){t=e.os(t);null!==t&&n.push(t)}),n},Kh.prototype.removeMutationBatch=function(n,r){var i=this;Wr(0===this.hs(r.batchId,"removed")),this._n.shift();var o=this.rs;return fu.forEach(r.mutations,function(t){var e=new Dh(t.key,r.batchId);return o=o.delete(e),i.referenceDelegate.markPotentiallyOrphaned(n,t.key)}).next(function(){i.rs=o})},Kh.prototype.Gt=function(t){},Kh.prototype.containsKey=function(t,e){var n=new Dh(e,0),n=this.rs.firstAfterOrEqual(n);return fu.resolve(e.isEqual(n&&n.key))},Kh.prototype.performConsistencyCheck=function(t){return this._n.length,fu.resolve()},Kh.prototype.hs=function(t,e){return this.cs(t)},Kh.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},Kh.prototype.os=function(t){t=this.cs(t);return t<0||t>=this._n.length?null:this._n[t]},Kh),Ch=(jh.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:i,readTime:n}),this.size+=i-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},jh.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},jh.prototype.getEntry=function(t,e){var n=this.docs.get(e);return fu.resolve(n?n.document.clone():Qi.newInvalidDocument(e))},jh.prototype.getEntries=function(t,e){var n=this,r=zs;return e.forEach(function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Qi.newInvalidDocument(t))}),fu.resolve(r)},jh.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=zs,i=new Ni(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var s=o.getNext(),a=s.key,u=s.value,s=u.document,u=u.readTime;if(!e.path.isPrefixOf(a.path))break;u.compareTo(n)<=0||Ko(e,s)&&(r=r.insert(s.key,s.clone()))}return fu.resolve(r)},jh.prototype.fs=function(t,e){return fu.forEach(this.docs,function(t){return e(t)})},jh.prototype.newChangeBuffer=function(t){return new kh(this)},jh.prototype.getSize=function(t){return fu.resolve(this.size)},jh),kh=(n(Bh,_h=A),Bh.prototype.applyChanges=function(n){var r=this,i=[];return this.changes.forEach(function(t,e){e.document.isValidDocument()?i.push(r.Ie.addEntry(n,e.document,r.getReadTime(t))):r.Ie.removeEntry(t)}),fu.waitFor(i)},Bh.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},Bh.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},Bh),Rh=(qh.prototype.forEachTarget=function(t,n){return this.ds.forEach(function(t,e){return n(e)}),fu.resolve()},qh.prototype.getLastRemoteSnapshotVersion=function(t){return fu.resolve(this.lastRemoteSnapshotVersion)},qh.prototype.getHighestSequenceNumber=function(t){return fu.resolve(this.ws)},qh.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),fu.resolve(this.highestTargetId)},qh.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),fu.resolve()},qh.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new vc(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},qh.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,fu.resolve()},qh.prototype.updateTargetData=function(t,e){return this.te(e),fu.resolve()},qh.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),--this.targetCount,fu.resolve()},qh.prototype.removeTargets=function(n,r,i){var o=this,s=0,a=[];return this.ds.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.ds.delete(t),a.push(o.removeMatchingKeysForTargetId(n,e.targetId)),s++)}),fu.waitFor(a).next(function(){return s})},qh.prototype.getTargetCount=function(t){return fu.resolve(this.targetCount)},qh.prototype.getTargetData=function(t,e){e=this.ds.get(e)||null;return fu.resolve(e)},qh.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),fu.resolve()},qh.prototype.removeMatchingKeys=function(e,t,n){this._s.Xn(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),fu.waitFor(i)},qh.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),fu.resolve()},qh.prototype.getMatchingKeysForTargetId=function(t,e){e=this._s.es(e);return fu.resolve(e)},qh.prototype.containsKey=function(t,e){return fu.resolve(this._s.containsKey(e))},qh),xh=(Uh.prototype.start=function(){return Promise.resolve()},Uh.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(Uh.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),Uh.prototype.setDatabaseDeletedListener=function(){},Uh.prototype.setNetworkEnabled=function(){},Uh.prototype.getIndexManager=function(){return this.Ut},Uh.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Nh(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},Uh.prototype.getTargetCache=function(){return this.qe},Uh.prototype.getRemoteDocumentCache=function(){return this.Ue},Uh.prototype.getBundleCache=function(){return this.Ke},Uh.prototype.runTransaction=function(t,e,n){var r=this;Kr("MemoryPersistence","Starting transaction:",t);var i=new Oh(this.Ne.next());return this.referenceDelegate.Es(),n(i).next(function(t){return r.referenceDelegate.Ts(i).next(function(){return t})}).toPromise().then(function(t){return i.raiseOnCommittedEvent(),t})},Uh.prototype.Is=function(e,n){return fu.or(Object.values(this.gs).map(function(t){return function(){return t.containsKey(e,n)}}))},Uh),Oh=(n(Vh,Ih=R),Vh),Lh=(Fh.bs=function(t){return new Fh(t)},Object.defineProperty(Fh.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw zr()},enumerable:!1,configurable:!0}),Fh.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),fu.resolve()},Fh.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),fu.resolve()},Fh.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),fu.resolve()},Fh.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach(function(t){return n.vs.add(t.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(function(t){t.forEach(function(t){return n.vs.add(t.toString())})}).next(function(){return r.removeTargetData(t,e)})},Fh.prototype.Es=function(){this.Rs=new Set},Fh.prototype.Ts=function(n){var r=this,i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fu.forEach(this.vs,function(t){var e=Ni.fromPath(t);return r.Ps(n,e).next(function(t){t||i.removeEntry(e)})}).next(function(){return r.Rs=null,i.apply(n)})},Fh.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next(function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())})},Fh.prototype.ps=function(t){return 0},Fh.prototype.Ps=function(t,e){var n=this;return fu.or([function(){return fu.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},Fh),Ph=(Mh.prototype.isAuthenticated=function(){return null!=this.uid},Mh.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},Mh.prototype.isEqual=function(t){return t.uid===this.uid},Mh);function Mh(t){this.uid=t}function Fh(t){this.persistence=t,this.As=new Ah,this.Rs=null}function Vh(t){var e=this;return(e=Ih.call(this)||this).currentSequenceNumber=t,e}function Uh(t,e){var n=this;this.gs={},this.Ne=new Pr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Rh(this),this.Ut=new tc,this.Ue=(t=this.Ut,new Ch(t,function(t){return n.referenceDelegate.ps(t)})),this.R=new Mu(e),this.Ke=new Sh(this.R)}function qh(t){this.persistence=t,this.ds=new Fc(Yi,Xi),this.lastRemoteSnapshotVersion=ei.min(),this.highestTargetId=0,this.ws=0,this._s=new Ah,this.targetCount=0,this.ys=vc.Jt()}function Bh(t){var e=this;return(e=_h.call(this)||this).Ie=t,e}function jh(t,e){this.Ut=t,this.ls=e,this.docs=new Vs(Ni.comparator),this.size=0}function Kh(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Qs(Dh.Gn)}function Gh(t,e){this.key=t,this.ns=e}function Qh(){this.Wn=new Qs(Dh.Gn),this.zn=new Qs(Dh.Hn)}function Hh(t){this.R=t,this.Qn=new Map,this.jn=new Map}function zh(t,e){return"firestore_clients_"+t+"_"+e}function Wh(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(n+="_"+e.uid),n}function Yh(t,e){return"firestore_targets_"+t+"_"+e}Ph.UNAUTHENTICATED=new Ph(null),Ph.GOOGLE_CREDENTIALS=new Ph("google-credentials-uid"),Ph.FIRST_PARTY=new Ph("first-party-uid"),Ph.MOCK_USER=new Ph("mock-user");var Xh,$h=(bl.Vs=function(t,e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Ur(i.error.code,i.error.message)),o?new bl(t,e,i.state,r):(Gr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},bl.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},bl),Jh=(wl.Vs=function(t,e){var n,r=JSON.parse(e),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new Ur(r.error.code,r.error.message)),i?new wl(t,r.state,n):(Gr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},wl.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},wl),Zh=(vl.Vs=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ta,o=0;r&&o<n.activeTargetIds.length;++o)r=Di(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new vl(t,i):(Gr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},vl),tl=(ml.Vs=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new ml(e.clientId,e.onlineState):(Gr("SharedClientState","Failed to parse online state: "+t),null)},ml),el=(gl.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},gl.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},gl.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},gl),nl=(yl.yt=function(t){return!(!t||!t.localStorage)},yl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h,l=this;return g(this,function(t){switch(t.label){case 0:return[4,this.syncEngine.fn()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(zh(this.persistenceKey,r)))&&(o=Zh.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(s=this.storage.getItem(this.Us))&&(a=this.js(s))&&this.Ws(a),u=0,c=this.$s;u<c.length;u++)h=c[u],this.ks(h);return this.$s=[],this.window.addEventListener("pagehide",function(){return l.shutdown()}),this.started=!0,[2]}})})},yl.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},yl.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},yl.prototype.isActiveQueryTarget=function(n){var r=!1;return this.Fs.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},yl.prototype.addPendingMutation=function(t){this.zs(t,"pending")},yl.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},yl.prototype.addLocalQueryTarget=function(t){var e,n="not-current";return this.isActiveQueryTarget(t)&&(!(e=this.storage.getItem(Yh(this.persistenceKey,t)))||(e=Jh.Vs(t,e))&&(n=e.state)),this.Js.Ds(t),this.Qs(),n},yl.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},yl.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},yl.prototype.clearQueryState=function(t){this.removeItem(Yh(this.persistenceKey,t))},yl.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},yl.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach(function(t){r.Hs(t)}),this.currentUser=t,n.forEach(function(t){r.addPendingMutation(t)})},yl.prototype.setOnlineState=function(t){this.Xs(t)},yl.prototype.notifyBundleLoaded=function(){this.Zs()},yl.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},yl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Kr("SharedClientState","READ",t,e),e},yl.prototype.setItem=function(t,e){Kr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},yl.prototype.removeItem=function(t){Kr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},yl.prototype.ks=function(t){var e=this,o=t;o.storageArea===this.storage&&(Kr("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.Os?this.Se.enqueueRetryable(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){if(this.started){if(null!==o.key)if(this.Ls.test(o.key)){if(null==o.newValue)return e=this.ti(o.key),[2,this.ei(e,null)];if(e=this.ni(o.key,o.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(o.key)){if(null!==o.newValue&&(n=this.si(o.key,o.newValue)))return[2,this.ii(n)]}else if(this.qs.test(o.key)){if(null!==o.newValue&&(r=this.ri(o.key,o.newValue)))return[2,this.oi(r)]}else if(o.key===this.Us){if(null!==o.newValue&&(i=this.js(o.newValue)))return[2,this.Ws(i)]}else if(o.key===this.Ms)(i=function(t){var e=Pr.o;if(null!=t)try{var n=JSON.parse(t);Wr("number"==typeof n),e=n}catch(t){Gr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Pr.o&&this.sequenceNumberHandler(i);else if(o.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(o);return[2]})})}):Gr("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(yl.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),yl.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},yl.prototype.zs=function(t,e,n){n=new $h(this.currentUser,t,e,n),t=Wh(this.persistenceKey,this.currentUser,t);this.setItem(t,n.Ss())},yl.prototype.Hs=function(t){t=Wh(this.persistenceKey,this.currentUser,t);this.removeItem(t)},yl.prototype.Xs=function(t){t={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(t))},yl.prototype.Ys=function(t,e,n){var r=Yh(this.persistenceKey,t),n=new Jh(t,e,n);this.setItem(r,n.Ss())},yl.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},yl.prototype.ti=function(t){t=this.Ls.exec(t);return t?t[1]:null},yl.prototype.ni=function(t,e){t=this.ti(t);return Zh.Vs(t,e)},yl.prototype.si=function(t,e){var n=this.Bs.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return $h.Vs(new Ph(n),t,e)},yl.prototype.ri=function(t,e){t=this.qs.exec(t),t=Number(t[1]);return Jh.Vs(t,e)},yl.prototype.js=function(t){return tl.Vs(t)},yl.prototype.ii=function(e){return y(this,void 0,void 0,function(){return g(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(e.batchId,e.state,e.error)]:(Kr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},yl.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},yl.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),s=[],a=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||a.push(t)}),this.syncEngine.hi(s,a).then(function(){n.Fs=r})},yl.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},yl.prototype.Gs=function(t){var n=ta;return t.forEach(function(t,e){n=n.unionWith(e.activeTargetIds)}),n},yl),rl=(pl.prototype.addPendingMutation=function(t){},pl.prototype.updateMutationState=function(t,e,n){},pl.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},pl.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},pl.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},pl.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},pl.prototype.clearQueryState=function(t){delete this.fi[t]},pl.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},pl.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},pl.prototype.start=function(){return this.li=new el,Promise.resolve()},pl.prototype.handleUserChange=function(t,e,n){},pl.prototype.setOnlineState=function(t){},pl.prototype.shutdown=function(){},pl.prototype.writeSequenceNumber=function(t){},pl.prototype.notifyBundleLoaded=function(){},pl),il=(dl.prototype.di=function(t){},dl.prototype.shutdown=function(){},dl),ol=(fl.prototype.di=function(t){this.gi.push(t)},fl.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},fl.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},fl.prototype._i=function(){Kr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},fl.prototype.yi=function(){Kr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},fl.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},fl),sl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},al=(ll.prototype.Ii=function(t){this.Ai=t},ll.prototype.Ri=function(t){this.bi=t},ll.prototype.onMessage=function(t){this.vi=t},ll.prototype.close=function(){this.Ti()},ll.prototype.send=function(t){this.Ei(t)},ll.prototype.Pi=function(){this.Ai()},ll.prototype.Vi=function(t){this.bi(t)},ll.prototype.Si=function(t){this.vi(t)},ll),ul=(hl.prototype.Ni=function(e,t,n,r){var i=this.xi(e,t);Kr("RestConnection","Sending: ",i,n);t={};return this.ki(t,r),this.Fi(e,i,t,n).then(function(t){return Kr("RestConnection","Received: ",t),t},function(t){throw Qr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},hl.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},hl.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.0",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},hl.prototype.xi=function(t,e){return this.Di+"/v1/"+e+":"+sl[t]},n(cl,Xh=hl),cl.prototype.Fi=function(u,e,n,r){return new Promise(function(o,s){var a=new Lr;a.listenOnce(Nr.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Dr.NO_ERROR:var t=a.getResponseJson();Kr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Dr.TIMEOUT:Kr("Connection",'RPC "'+u+'" timed out'),s(new Ur(Vr.DEADLINE_EXCEEDED,"Request time out"));break;case Dr.HTTP_ERROR:var e,n,r=a.getStatus();Kr("Connection",'RPC "'+u+'" failed with status:',r,"response text:",a.getResponseText()),0<r?(e=a.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace(/_/g,"-"),n=0<=Object.values(Vr).indexOf(i)?i:Vr.UNKNOWN,s(new Ur(n,e.message))):s(new Ur(Vr.UNKNOWN,"Server responded with status "+a.getStatus())):s(new Ur(Vr.UNAVAILABLE,"Connection failed."));break;default:zr()}}finally{Kr("Connection",'RPC "'+u+'" completed.')}var i});var t=JSON.stringify(r);a.send(e,"POST",t,n,15)})},cl.prototype.Oi=function(t,e){var n,r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Er,o=Ar(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(t.xmlHttpFactory=new xr({})),this.ki(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=h().indexOf("Electron/")||(0<=(n=h()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=h().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Kr("Connection","Creating WebChannel: "+r,t);var s=i.createWebChannel(r,t),a=!1,u=!1,c=new al({Ei:function(t){u?Kr("Connection","Not sending because WebChannel is closed:",t):(a||(Kr("Connection","Opening WebChannel transport."),s.open(),a=!0),Kr("Connection","WebChannel sending:",t),s.send(t))},Ti:function(){return s.close()}}),t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(s,Or.EventType.OPEN,function(){u||Kr("Connection","WebChannel transport opened.")}),t(s,Or.EventType.CLOSE,function(){u||(u=!0,Kr("Connection","WebChannel transport closed"),c.Vi())}),t(s,Or.EventType.ERROR,function(t){u||(u=!0,Qr("Connection","WebChannel transport errored:",t),c.Vi(new Ur(Vr.UNAVAILABLE,"The operation could not be completed")))}),t(s,Or.EventType.MESSAGE,function(t){var e,n,r,i;u||(Wr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Kr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Cs[r];if(void 0!==t)return Fs(t)}(),i=n.message,void 0===t&&(t=Vr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,c.Vi(new Ur(t,i)),s.close()):(Kr("Connection","WebChannel received:",e),c.Si(e)))}),t(o,Cr.STAT_EVENT,function(t){t.stat===kr?Kr("Connection","Detected buffering proxy"):t.stat===Rr&&Kr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Pi()},0),c},cl);function cl(t){var e=this;return(e=Xh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.autoDetectLongPolling=t.autoDetectLongPolling,e.useFetchStreams=t.useFetchStreams,e}function hl(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}function ll(t){this.Ei=t.Ei,this.Ti=t.Ti}function fl(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}function dl(){}function pl(){this.li=new el,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}function yl(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new Vs($r),this.started=!1,this.$s=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=zh(this.persistenceKey,this.Ns),this.Ms="firestore_sequence_number_"+this.persistenceKey,this.Fs=this.Fs.insert(this.Ns,new el),this.Ls=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Us="firestore_online_state_"+this.persistenceKey,this.Ks="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.xs)}function gl(){this.activeTargetIds=ta}function ml(t,e){this.clientId=t,this.onlineState=e}function vl(t,e){this.clientId=t,this.activeTargetIds=e}function wl(t,e,n){this.targetId=t,this.state=e,this.error=n}function bl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function El(){return"undefined"!=typeof window?window:null}function Tl(){return"undefined"!=typeof document?document:null}function Il(t){return new ga(t,!0)}function _l(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di(function(t){n.enqueueAndForget(function(){return y(o,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return zl(this)?(Kr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return(e=n).Or.add(4),[4,ql(e)];case 1:return t.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,Ul(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Br=new xl(n,r)}var Sl,Al,Dl,Nl=(Vl.prototype.reset=function(){this.qi=0},Vl.prototype.Qi=function(){this.qi=this.Bi},Vl.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);0<i&&Kr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,function(){return e.Ki=Date.now(),t()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},Vl.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},Vl.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},Vl.prototype.Wi=function(){return(Math.random()-.5)*this.qi},Vl),A=(Fl.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},Fl.prototype.er=function(){return 2===this.state},Fl.prototype.start=function(){3!==this.state?this.auth():this.nr()},Fl.prototype.stop=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Fl.prototype.sr=function(){this.state=0,this.Zi.reset()},Fl.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return t.rr()}))},Fl.prototype.cr=function(t){this.ur(),this.stream.send(t)},Fl.prototype.rr=function(){return y(this,void 0,void 0,function(){return g(this,function(t){return this.er()?[2,this.close(0)]:[2]})})},Fl.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Fl.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():n&&n.code===Vr.RESOURCE_EXHAUSTED?(Gr(n.toString()),Gr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):n&&n.code===Vr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(n)];case 1:return t.sent(),[2]}})})},Fl.prototype.ar=function(){},Fl.prototype.auth=function(){var n=this;this.state=1;var t=this.hr(this.Yi),e=this.Yi;this.Ji.getToken().then(function(t){n.Yi===e&&n.lr(t)},function(e){t(function(){var t=new Ur(Vr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.dr(t)})})},Fl.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii(function(){n(function(){return e.state=2,e.listener.Ii()})}),this.stream.Ri(function(t){n(function(){return e.dr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Fl.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji(function(){return y(t,void 0,void 0,function(){return g(this,function(t){return this.state=0,this.start(),[2]})})})},Fl.prototype.dr=function(t){return Kr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Fl.prototype.hr=function(e){var n=this;return function(t){n.Se.enqueueAndForget(function(){return n.Yi===e?t():(Kr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Fl),Cl=(n(Ml,Dl=A),Ml.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},Ml.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:zr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.I?(Wr(void 0===s||"string"==typeof s),di.fromBase64String(s||"")):(Wr(void 0===s||s instanceof Uint8Array),di.fromUint8Array(s||new Uint8Array))),o=(a=e.targetChange.cause)&&(u=void 0===(c=a).code?Vr.UNKNOWN:Fs(c.code),new Ur(u,c.message||"")),s=new oa(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime;var r=Ia(t,n.document.name),i=wa(n.document.updateTime),a=new Ki({mapValue:{fields:n.document.fields}}),u=(o=Qi.newFoundDocument(r,i,a),n.targetIds||[]),c=n.removedTargetIds||[];s=new ra(u,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Ia(t,n.document),i=n.readTime?wa(n.readTime):ei.min(),a=Qi.newNoDocument(r,i),o=n.removedTargetIds||[],s=new ra([],o,a.key,a);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Ia(t,n.document),i=n.removedTargetIds||[],s=new ra([],i,r,null);else{if(!("filter"in e))return zr();e.filter;e=e.filter;e.targetId,n=e.count||0,r=new Ns(n),i=e.targetId,s=new ia(i,r)}return s}(this.R,t),t=function(t){if(!("targetChange"in t))return ei.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?wa(t.readTime):ei.min()}(t);return this.listener._r(e,t)},Ml.prototype.mr=function(t){var e,n,r,i={};i.database=Aa(this.R),i.addTarget=(e=this.R,(r=$i(r=(n=t).target)?{documents:xa(e,r)}:{query:Oa(e,r)}).targetId=n.targetId,0<n.resumeToken.approximateByteSize()?r.resumeToken=va(e,n.resumeToken):0<n.snapshotVersion.compareTo(ei.min())&&(r.readTime=ma(e,n.snapshotVersion.toTimestamp())),r);var o,t=(this.R,o=t,null==(t=function(){switch(o.purpose){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return zr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.cr(i)},Ml.prototype.yr=function(t){var e={};e.database=Aa(this.R),e.removeTarget=t,this.cr(e)},Ml),kl=(n(Pl,Al=A),Object.defineProperty(Pl.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),Pl.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,Al.prototype.start.call(this)},Pl.prototype.ar=function(){this.gr&&this.Er([])},Pl.prototype.wr=function(t){return this.Hi.Oi("Write",t)},Pl.prototype.onMessage=function(t){if(Wr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Wr(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?wa(e.updateTime):wa(n)).isEqual(ei.min())&&(t=wa(n)),new ls(t,e.transformResults||[]);var e,n})):[]),n=wa(t.commitTime);return this.listener.Tr(n,e)}var n,r;return Wr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},Pl.prototype.Ar=function(){var t={};t.database=Aa(this.R),this.cr(t)},Pl.prototype.Er=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ka(e.R,t)})};this.cr(t)},Pl),Rl=(n(Ll,Sl=function(){}),Ll.prototype.br=function(){if(this.Rr)throw new Ur(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},Ll.prototype.Ni=function(e,n,r){var i=this;return this.br(),this.credentials.getToken().then(function(t){return i.Hi.Ni(e,n,r,t)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Vr.UNAUTHENTICATED&&i.credentials.invalidateToken(),t):new Ur(Vr.UNKNOWN,t.toString())})},Ll.prototype.$i=function(e,n,r){var i=this;return this.br(),this.credentials.getToken().then(function(t){return i.Hi.$i(e,n,r,t)}).catch(function(t){throw"FirebaseError"===t.name?(t.code===Vr.UNAUTHENTICATED&&i.credentials.invalidateToken(),t):new Ur(Vr.UNKNOWN,t.toString())})},Ll.prototype.terminate=function(){this.Rr=!0},Ll),xl=(Ol.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()}))},Ol.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,1<=this.vr&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},Ol.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},Ol.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},Ol.prototype.Cr=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Gr(t),this.Vr=!1):Kr("OnlineStateTracker",t)},Ol.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},Ol);function Ol(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}function Ll(t,e,n){var r=this;return(r=Sl.call(this)||this).credentials=t,r.Hi=e,r.R=n,r.Rr=!1,r}function Pl(t,e,n,r,i){var o=this;return(o=Al.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).R=r,o.gr=!1,o}function Ml(t,e,n,r,i){var o=this;return(o=Dl.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).R=r,o}function Fl(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Nl(t,e)}function Vl(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}function Ul(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:if(!zl(r))return[3,4];e=0,n=r.Mr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ql(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:e=0,n=r.Mr,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Bl(t,e){t.$r.has(e.targetId)||(t.$r.set(e.targetId,e),Hl(t)?Ql(t):nf(t).er()&&Kl(t,e))}function jl(t,e){var n=t,t=nf(n);n.$r.delete(e),t.er()&&Gl(n,e),0===n.$r.size&&(t.er()?t.ir():zl(n)&&n.Br.set("Unknown"))}function Kl(t,e){t.qr.U(e.targetId),nf(t).mr(e)}function Gl(t,e){t.qr.U(e),nf(t).yr(e)}function Ql(e){e.qr=new aa({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.$r.get(t)||null}}),nf(e).start(),e.Br.Sr()}function Hl(t){return zl(t)&&!nf(t).tr()&&0<t.$r.size}function zl(t){return 0===t.Or.size}function Wl(t){t.qr=void 0}function Yl(s,a,u){return y(this,void 0,void 0,function(){var n,o;return g(this,function(t){switch(t.label){case 0:if(s.Br.set("Online"),!(a instanceof oa&&2===a.state&&a.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.$r.has(i)?[4,o.remoteSyncer.rejectListen(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.$r.delete(i),o.qr.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,a)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Kr("RemoteStore","Failed to remove targets %s: %s ",a.targetIds.join(","),n),[4,Xl(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(a instanceof ra?s.qr.X(a):a instanceof ia?s.qr.rt(a):s.qr.et(a),u.isEqual(ei.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ph(s.localStore)];case 8:return o=t.sent(),0<=u.compareTo(o)?[4,(i=u,(e=(r=s).qr.ut(i)).targetChanges.forEach(function(t,e){var n;0<t.resumeToken.approximateByteSize()&&((n=r.$r.get(e))&&r.$r.set(e,n.withResumeToken(t.resumeToken,i)))}),e.targetMismatches.forEach(function(t){var e=r.$r.get(t);e&&(r.$r.set(t,e.withResumeToken(di.EMPTY_BYTE_STRING,e.snapshotVersion)),Gl(r,t),e=new Pu(e.target,t,1,e.sequenceNumber),Kl(r,e))}),r.remoteSyncer.applyRemoteEvent(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Kr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Xl(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Xl(n,r,i){return y(this,void 0,void 0,function(){var e=this;return g(this,function(t){switch(t.label){case 0:if(!Iu(r))throw r;return n.Or.add(1),[4,ql(n)];case 1:return t.sent(),n.Br.set("Offline"),i=i||function(){return ph(n.localStore)},n.asyncQueue.enqueueRetryable(function(){return y(e,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return Kr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Or.delete(1),[4,Ul(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function $l(e,n){return n().catch(function(t){return Xl(e,t,n)})}function Jl(u){return y(this,void 0,void 0,function(){var i,o,s,a;return g(this,function(t){switch(t.label){case 0:o=rf(i=u),s=0<i.Fr.length?i.Fr[i.Fr.length-1].batchId:-1,t.label=1;case 1:if(!(zl(i)&&i.Fr.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.localStore,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r._n.getNextMutationBatchAfterBatchId(t,n)}))];case 3:return null===(a=t.sent())?(0===i.Fr.length&&o.ir(),[3,7]):(s=a.batchId,function(t,e){t.Fr.push(e);t=rf(t);t.er()&&t.pr&&t.Er(e.mutations)}(i,a),[3,6]);case 4:return a=t.sent(),[4,Xl(i,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Zl(i)&&tf(i),[2]}var e,n,r})})}function Zl(t){return zl(t)&&!rf(t).tr()&&0<t.Fr.length}function tf(t){rf(t).start()}function ef(n,r){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=n,r?(e.Or.delete(2),[4,Ul(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Or.add(2),[4,ql(e)]);case 3:t.sent(),e.Br.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function nf(n){var t,e,r,i=this;return n.Ur||(n.Ur=(t=n.datastore,e=n.asyncQueue,r={Ii:function(n){return y(this,void 0,void 0,function(){return g(this,function(t){return n.$r.forEach(function(t,e){Kl(n,t)}),[2]})})}.bind(null,n),Ri:function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){return Wl(e),Hl(e)?(e.Br.Nr(n),Ql(e)):e.Br.set("Unknown"),[2]})})}.bind(null,n),_r:Yl.bind(null,n)},t.br(),new Cl(e,t.Hi,t.credentials,t.R,r)),n.Mr.push(function(e){return y(i,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e?(n.Ur.sr(),Hl(n)?Ql(n):n.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Ur.stop()];case 2:t.sent(),Wl(n),t.label=3;case 3:return[2]}})})})),n.Ur}function rf(n){var t,e,r,i=this;return n.Kr||(n.Kr=(t=n.datastore,e=n.asyncQueue,r={Ii:function(e){return y(this,void 0,void 0,function(){return g(this,function(t){return rf(e).Ar(),[2]})})}.bind(null,n),Ri:function(e,n){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return n&&rf(e).pr?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return Ms(n=i.code)&&n!==Vr.ABORTED?(e=r.Fr.shift(),rf(r).sr(),[4,$l(r,function(){return r.remoteSyncer.rejectFailedWrite(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Jl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Zl(e)&&tf(e),[2]}})})}.bind(null,n),Ir:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){for(e=rf(o),n=0,r=o.Fr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]})})}.bind(null,n),Tr:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return e=r.Fr.shift(),n=Lu.from(e,i,o),[4,$l(r,function(){return r.remoteSyncer.applySuccessfulWrite(n)})];case 1:return t.sent(),[4,Jl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.br(),new kl(e,t.Hi,t.credentials,t.R,r)),n.Mr.push(function(e){return y(i,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e?(n.Kr.sr(),[4,Jl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Kr.stop()];case 3:t.sent(),0<n.Fr.length&&(Kr("RemoteStore","Stopping write stream with "+n.Fr.length+" pending writes"),n.Fr=[]),t.label=4;case 4:return[2]}})})})),n.Kr}var of=(sf.createAndSchedule=function(t,e,n,r,i){i=new sf(t,e,Date.now()+n,r,i);return i.start(n),i},sf.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},sf.prototype.skipDelay=function(){return this.handleDelayElapsed()},sf.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ur(Vr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},sf.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})},sf.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},sf);function sf(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new lu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}function af(t,e){if(Gr("AsyncQueue",e+": "+t),Iu(t))return new Ur(Vr.UNAVAILABLE,e+": "+t);throw t}function uf(){this.queries=new Fc(Bo,qo),this.onlineState="Unknown",this.Gr=new Set}var cf=(yf.emptySet=function(t){return new yf(t.comparator)},yf.prototype.has=function(t){return null!=this.keyedMap.get(t)},yf.prototype.get=function(t){return this.keyedMap.get(t)},yf.prototype.first=function(){return this.sortedSet.minKey()},yf.prototype.last=function(){return this.sortedSet.maxKey()},yf.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},yf.prototype.indexOf=function(t){t=this.keyedMap.get(t);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(yf.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),yf.prototype.forEach=function(n){this.sortedSet.inorderTraversal(function(t,e){return n(t),!1})},yf.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},yf.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},yf.prototype.isEqual=function(t){if(!(t instanceof yf))return!1;if(this.size!==t.size)return!1;for(var e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();e.hasNext();){var r=e.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},yf.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},yf.prototype.copy=function(t,e){var n=new yf;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n},yf),hf=(pf.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);!n||0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):zr()},pf.prototype.jr=function(){var n=[];return this.Qr.inorderTraversal(function(t,e){n.push(e)}),n},pf),lf=(df.fromInitialDocuments=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new df(t,e,cf.emptySet(e),i,n,r,!0,!1)},Object.defineProperty(df.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),df.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&qo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},df),ff=function(){this.Wr=void 0,this.listeners=[]};function df(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a}function pf(){this.Qr=new Vs(Ni.comparator)}function yf(n){this.comparator=n?function(t,e){return n(t,e)||Ni.comparator(t.key,e.key)}:function(t,e){return Ni.comparator(t.key,e.key)},this.keyedMap=Xs,this.sortedSet=new Vs(this.comparator)}function gf(s,a){return y(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(t){switch(t.label){case 0:if(e=s,n=a.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new ff),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.onListen(n)];case 2:return o.Wr=t.sent(),[3,4];case 3:return o=t.sent(),o=af(o,"Initialization of query '"+jo(a.query)+"' failed"),[2,void a.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(a),a.zr(e.onlineState),i.Wr&&a.Hr(i.Wr)&&vf(e),[2]}})})}function mf(s,a){return y(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(t){return e=s,n=a.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(a))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.onUnlisten(n))]:[2]})})}function vf(t){t.Gr.forEach(function(t){t.next()})}var wf=(Af.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lf(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},Af.prototype.onError=function(t){this.Jr.error(t)},Af.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},Af.prototype.eo=function(t,e){return!t.fromCache||!(this.options.so&&"Offline"!==e||t.docs.isEmpty()&&"Offline"!==e)},Af.prototype.Zr=function(t){if(0<t.docChanges.length)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},Af.prototype.no=function(t){t=lf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},Af),bf=(Sf.prototype.io=function(){return"metadata"in this.payload},Sf),Ef=(_f.prototype.qn=function(t){return Ia(this.R,t)},_f.prototype.Un=function(t){return t.metadata.exists?Ca(this.R,t.document,!1):Qi.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},_f.prototype.Kn=wa,_f),Tf=(If.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},If.prototype.co=function(t){for(var e=new Map,n=new Ef(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.qn(o.metadata.name),a=0,u=o.metadata.queries;a<u.length;a++){var c=u[a],h=(e.get(c)||Zs()).add(s);e.set(c,h)}}return e},If.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:return[4,function(l,f,d,p){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,a,u,c,h;return g(this,function(t){switch(t.label){case 0:for(n=l,r=Zs(),i=zs,o=$s,e=0,s=d;e<s.length;e++)a=s[e],u=f.qn(a.metadata.name),a.document&&(r=r.add(u)),i=i.insert(u,f.Un(a)),o=o.insert(u,f.Kn(a.metadata.readTime));return c=n.On.newChangeBuffer({trackRemovals:!0}),[4,mh(n,Vo(Ro(ci.fromString("__bundle__/docs/"+p))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return gh(e,c,i,ei.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.qe.removeMatchingKeysForTargetId(e,h.targetId).next(function(){return n.qe.addMatchingKeys(e,r,h.targetId)}).next(function(){return n.Mn.En(e,t)}).next(function(){return t})})})]}})})}(this.localStore,new Ef(this.R),this.documents,this.ro.id)];case 1:e=t.sent(),n=this.co(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=Zs()),y(this,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return[4,mh(e,Vo(Yu(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=wa(i.readTime);if(0<=n.snapshotVersion.compareTo(e))return r.Ke.saveNamedQuery(t,i);e=n.withResumeToken(di.EMPTY_BYTE_STRING,e);return r.kn=r.kn.insert(e.targetId,e),r.qe.updateTargetData(t,e).next(function(){return r.qe.removeMatchingKeysForTargetId(t,n.targetId)}).next(function(){return r.qe.addMatchingKeys(t,o,n.targetId)}).next(function(){return r.Ke.saveNamedQuery(t,i)})})]}})})}(this.localStore,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new nh(Object.assign({},this.progress),e))]}})})},If);function If(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=Df(t)}function _f(t){this.R=t}function Sf(t,e){this.payload=t,this.byteLength=e}function Af(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}function Df(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Nf=function(t){this.key=t},Cf=function(t){this.key=t},kf=(Object.defineProperty(Pf.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),Pf.prototype._o=function(t,e){var s=this,a=e?e.mo:new hf,u=(e||this).fo,c=(e||this).mutatedKeys,h=u,l=!1,f=xo(this.query)&&u.size===this.query.limit?u.last():null,d=Oo(this.query)&&u.size===this.query.limit?u.first():null;if(t.inorderTraversal(function(t,e){var n=u.get(t),r=Ko(s.query,e)?e:null,i=!!n&&s.mutatedKeys.has(n.key),o=!!r&&(r.hasLocalMutations||s.mutatedKeys.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data.isEqual(r.data)?i!==o&&(a.track({type:3,doc:r}),e=!0):s.yo(n,r)||(a.track({type:2,doc:r}),e=!0,(f&&0<s.lo(r,f)||d&&s.lo(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),e=!0):n&&!r&&(a.track({type:1,doc:n}),e=!0,(f||d)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),xo(this.query)||Oo(this.query))for(;h.size>this.query.limit;){var n=xo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{fo:h,mo:a,Nn:l,mutatedKeys:c}},Pf.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},Pf.prototype.applyChanges=function(t,e,n){var o=this,r=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var i=t.mo.jr();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.lo(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return zr()}}var r,i}),this.po(n);var s=e?this.Eo():[],n=0===this.ho.size&&this.current?1:0,e=n!==this.ao;return this.ao=n,0!==i.length||e?{snapshot:new lf(this.query,t.fo,r,i,t.mutatedKeys,0==n,e,!1),To:s}:{To:s}},Pf.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new hf,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},Pf.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},Pf.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach(function(t){return e.uo=e.uo.add(t)}),t.modifiedDocuments.forEach(function(t){}),t.removedDocuments.forEach(function(t){return e.uo=e.uo.delete(t)}),this.current=t.current)},Pf.prototype.Eo=function(){var e=this;if(!this.current)return[];var n=this.ho;this.ho=Zs(),this.fo.forEach(function(t){e.Io(t.key)&&(e.ho=e.ho.add(t.key))});var r=[];return n.forEach(function(t){e.ho.has(t)||r.push(new Cf(t))}),this.ho.forEach(function(t){n.has(t)||r.push(new Nf(t))}),r},Pf.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Zs();t=this._o(t.documents);return this.applyChanges(t,!0)},Pf.prototype.Ro=function(){return lf.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},Pf),Rf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},xf=function(t){this.key=t,this.bo=!1},Of=(Object.defineProperty(Lf.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),Lf);function Lf(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Fc(Bo,qo),this.Vo=new Map,this.So=new Set,this.Do=new Vs(Ni.comparator),this.Co=new Map,this.No=new Ah,this.xo={},this.ko=new Map,this.Fo=vc.Yt(),this.onlineState="Unknown",this.$o=void 0}function Pf(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Zs(),this.mutatedKeys=Zs(),this.lo=Go(t),this.fo=new cf(this.lo)}function Mf(i,o,s,a){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return i.Oo=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return(e=i.view._o(o)).Nn?[4,wh(r.localStore,i.query,!1).then(function(t){t=t.documents;return i.view._o(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.targetChanges.get(i.targetId),n=i.view.applyChanges(e,r.isPrimaryClient,n),[2,(Hf(r,i.targetId,n.To),n.snapshot)]}})})}(i,t,e,n)},[4,wh(i.localStore,o,!0)];case 1:return n=t.sent(),r=new kf(o,n.Bn),e=r._o(n.documents),n=na.createSynthesizedTargetChangeForCurrentChange(s,a&&"Offline"!==i.onlineState),n=r.applyChanges(e,i.isPrimaryClient,n),Hf(i,s,n.To),r=new Rf(o,s,r),[2,(i.Po.set(o,r),i.Vo.has(s)?i.Vo.get(s).push(o):i.Vo.set(s,[o]),n.snapshot)]}})})}function Ff(f,d,p){return y(this,void 0,void 0,function(){var s,l;return g(this,function(t){switch(t.label){case 0:l=ed(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=l.localStore,a=d,c=i,h=ti.now(),o=a.reduce(function(t,e){return t.add(e.key)},Zs()),c.persistence.runTransaction("Locally write mutations","readwrite",function(s){return c.Mn.pn(s,o).next(function(t){u=t;for(var e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e.data.field(o.field),s=Wo(o.transform,s||null);null!=s&&(n=null==n?Ki.empty():n).set(o.field,s)}return n||null}(i,u.get(i.key));null!=o&&e.push(new Ts(i.key,o,function s(t){var a=[];return oi(t.fields,function(t,e){var n=new li([t]);if(Bi(e))if(0===(e=s(e.mapValue).fields).length)a.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];a.push(n.child(o))}else a.push(n)}),new fi(a)}(o.value.mapValue),ds.exists(!0)))}return c._n.addMutationBatch(s,h,e,a)})}).then(function(t){return t.applyToLocalDocumentSet(u),{batchId:t.batchId,changes:u}}))];case 2:return s=t.sent(),l.sharedClientState.addPendingMutation(s.batchId),e=l,n=s.batchId,r=p,i=(i=(i=e.xo[e.currentUser.toKey()])||new Vs($r)).insert(n,r),e.xo[e.currentUser.toKey()]=i,[4,Wf(l,s.changes)];case 3:return t.sent(),[4,Jl(l.remoteStore)];case 4:return t.sent(),[3,6];case 5:return l=t.sent(),l=af(l,"Failed to persist write"),p.reject(l),[3,6];case 6:return[2]}var e,n,r,i,a,u,c,h,o})})}function Vf(r,i){return y(this,void 0,void 0,function(){var n,e;return g(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,yh(n.localStore,i)];case 2:return e=t.sent(),i.targetChanges.forEach(function(t,e){e=n.Co.get(e);e&&(Wr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),0<t.addedDocuments.size?e.bo=!0:0<t.modifiedDocuments.size?Wr(e.bo):0<t.removedDocuments.size&&(Wr(e.bo),e.bo=!1))}),[4,Wf(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Sc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Uf(t,n,e){var r,t=t;(t.isPrimaryClient&&0===e||!t.isPrimaryClient&&1===e)&&(r=[],t.Po.forEach(function(t,e){e=e.view.zr(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].zr(i)&&(o=!0)}),o&&vf(t)}(t.eventManager,n),r.length&&t.vo._r(r),t.onlineState=n,t.isPrimaryClient&&t.sharedClientState.setOnlineState(n))}function qf(s,a,u){return y(this,void 0,void 0,function(){var n,o;return g(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.localStore,r=a,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i._n.lookupMutationBatch(e,r).next(function(t){return Wr(null!==t),n=t.keys(),i._n.removeMutationBatch(e,t)}).next(function(){return i._n.performConsistencyCheck(e)}).next(function(){return i.Mn.pn(e,n)})}))];case 2:return o=t.sent(),Kf(n,a,u),jf(n,a),n.sharedClientState.updateMutationState(a,"rejected",u),[4,Wf(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Sc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function Bf(o,s){return y(this,void 0,void 0,function(){var n,r,i;return g(this,function(t){switch(t.label){case 0:zl((n=o).remoteStore)||Kr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e._n.getHighestUnacknowledgedBatchId(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ko.get(r)||[]).push(s),n.ko.set(r,i),[3,4]);case 3:return i=t.sent(),i=af(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function jf(t,e){(t.ko.get(e)||[]).forEach(function(t){t.resolve()}),t.ko.delete(e)}function Kf(t,e,n){var r=t,i=r.xo[r.currentUser.toKey()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i)}function Gf(e,t,n){void 0===n&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach(function(t){e.No.containsKey(t)||Qf(e,t)})}function Qf(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(jl(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),zf(t))}function Hf(t,e,n){for(var r,i,o,s=0,a=n;s<a.length;s++){var u=a[s];u instanceof Nf?(t.No.addReference(u.key,e),r=t,o=void 0,i=(o=(i=u).key).path.canonicalString(),r.Do.get(o)||r.So.has(i)||(Kr("SyncEngine","New document in limbo: "+o),r.So.add(i),zf(r))):u instanceof Cf?(Kr("SyncEngine","Document no longer in limbo: "+u.key),t.No.removeReference(u.key,e),t.No.containsKey(u.key)||Qf(t,u.key)):zr()}}function zf(t){for(;0<t.So.size&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Ni(ci.fromString(e)),e=t.Fo.next();t.Co.set(e,new xf(n)),t.Do=t.Do.insert(n,e),Bl(t.remoteStore,new Pu(Vo(Ro(n.path)),e,2,Pr.o))}}function Wf(e,s,a){return y(this,void 0,void 0,function(){var n,r,i,o;return g(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Po.isEmpty()?[3,3]:(n.Po.forEach(function(t,e){o.push(n.Oo(e,s,a).then(function(t){t&&(n.isPrimaryClient&&n.sharedClientState.updateQueryState(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ih.Pn(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vo._r(r),[4,function(u,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,a;return g(this,function(t){switch(t.label){case 0:r=u,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return fu.forEach(c,function(e){return fu.forEach(e.bn,function(t){return r.persistence.referenceDelegate.addReference(n,e.targetId,t)}).next(function(){return fu.forEach(e.vn,function(t){return r.persistence.referenceDelegate.removeReference(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Iu(e=t.sent()))throw e;return Kr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)a=i[n],o=a.targetId,a.fromCache||(s=r.kn.get(o),a=s.snapshotVersion,a=s.withLastLimboFreeSnapshotVersion(a),r.kn=r.kn.insert(o,a));return[2]}})})}(n.localStore,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Yf(i,o){return y(this,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Kr("SyncEngine","User change. New user:",o.toKey()),[4,fh(n.localStore,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ko.forEach(function(t){t.forEach(function(t){t.reject(new Ur(Vr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ko.clear(),n.sharedClientState.handleUserChange(o,r.removedBatchIds,r.addedBatchIds),[4,Wf(n,r.Ln)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Xf(a,u,c,h){return y(this,void 0,void 0,function(){var o,s;return g(this,function(t){switch(t.label){case 0:return[4,(e=(o=a).localStore,n=u,i=(r=e)._n,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.jt(e,n).next(function(t){return t?r.Mn.pn(e,t):fu.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Jl(o.remoteStore)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Kf(o,u,h||null),jf(o,u),o.localStore._n.Gt(u)):zr(),t.label=4;case 4:return[4,Wf(o,s)];case 5:return t.sent(),[3,7];case 6:Kr("SyncEngine","Cannot apply mutation batch with id: "+u),t.label=7;case 7:return[2]}var e,n,r,i})})}function $f(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,a,u,c;return g(this,function(t){switch(t.label){case 0:return td(r=h),ed(r),!0!==l||!0===r.$o?[3,3]:(e=r.sharedClientState.getAllActiveQueryTargets(),[4,Jf(r,e.toArray())]);case 1:return i=t.sent(),r.$o=!0,[4,ef(r.remoteStore,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)a=s[o],Bl(r.remoteStore,a);return[3,7];case 3:return!1!==l||!1===r.$o?[3,7]:(u=[],c=Promise.resolve(),r.Vo.forEach(function(t,e){r.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then(function(){return Gf(r,e),vh(r.localStore,e,!0)}),jl(r.remoteStore,e)}),[4,c]);case 4:return t.sent(),[4,Jf(r,u)];case 5:return t.sent(),(n=r).Co.forEach(function(t,e){jl(n.remoteStore,e)}),n.No.ts(),n.Co=new Map,n.Do=new Vs(Ni.comparator),r.$o=!1,[4,ef(r.remoteStore,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function Jf(d,p){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h,l,f;return g(this,function(t){switch(t.label){case 0:e=d,n=[],r=[],i=0,o=p,t.label=1;case 1:return i<o.length?(s=o[i],a=void 0,(u=e.Vo.get(s))&&0!==u.length?[4,mh(e.localStore,Vo(u[0]))]:[3,7]):[3,13];case 2:a=t.sent(),c=0,h=u,t.label=3;case 3:return c<h.length?(l=h[c],l=e.Po.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,wh((e=r).localStore,i.query,!0)];case 1:return n=t.sent(),n=i.view.Ao(n),[2,(e.isPrimaryClient&&Hf(e,i.targetId,n.To),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,bh(e.localStore,s)];case 8:return f=t.sent(),[4,mh(e.localStore,f)];case 9:return a=t.sent(),[4,Mf(e,Zf(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(a),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.vo._r(r),n)]}})})}function Zf(t){return ko(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function td(t){return t.remoteStore.remoteSyncer.applyRemoteEvent=Vf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=function(t,e){var n=t;if((t=n.Co.get(e))&&t.bo)return Zs().add(t.key);var r=Zs();if(!(e=n.Vo.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Po.get(s),r=r.unionWith(s.view.wo);return r}.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=function(o,s,a){return y(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(t){switch(t.label){case 0:return(e=o).sharedClientState.updateQueryState(s,"rejected",a),i=e.Co.get(s),(n=i&&i.key)?(r=(r=new Vs(Ni.comparator)).insert(n,Qi.newNoDocument(n,ei.min())),i=Zs().add(n),i=new ea(ei.min(),new Map,new Qs($r),r,i),[4,Vf(e,i)]):[3,2];case 1:return t.sent(),e.Do=e.Do.remove(n),e.Co.delete(s),zf(e),[3,4];case 2:return[4,vh(e.localStore,s,!1).then(function(){return Gf(e,s,a)}).catch(Sc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.vo._r=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,a=n.queries.get(a);if(a){for(var u=0,c=a.listeners;u<c.length;u++)c[u].Hr(s)&&(r=!0);a.Wr=s}}r&&vf(n)}.bind(null,t.eventManager),t.vo.Mo=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.eventManager),t}function ed(t){return t.remoteStore.remoteSyncer.applySuccessfulWrite=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,dh(e.localStore,o)];case 2:return r=t.sent(),Kf(e,n,null),jf(e,n),e.sharedClientState.updateMutationState(n,"acknowledged"),[4,Wf(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Sc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=qf.bind(null,t),t}function nd(t,e,n){var r=t;!function(f,d,p){return y(this,void 0,void 0,function(){var a,u,c,h,l;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,d.getMetadata()];case 1:return a=t.sent(),[4,(r=f.localStore,o=r,s=wa((i=a).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Ke.getBundleMetadata(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.compareTo(s)}))];case 2:return t.sent()?[4,d.close()]:[3,4];case 3:return[2,(t.sent(),void p._completeWith({taskState:"Success",documentsLoaded:a.totalDocuments,bytesLoaded:a.totalBytes,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}))];case 4:return p._updateProgress(Df(a)),u=new Tf(a,f.localStore,d.R),[4,d.Lo()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,u.oo(c)]:[3,10];case 7:return(h=t.sent())&&p._updateProgress(h),[4,d.Lo()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,u.complete()];case 11:return l=t.sent(),[4,Wf(f,l.wn,void 0)];case 12:return t.sent(),[4,(r=f.localStore,e=a,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Ke.saveBundleMetadata(t,e)}))];case 13:return t.sent(),p._completeWith(l.progress),[3,15];case 14:return Qr("SyncEngine","Loading bundle failed with "+(l=t.sent())),p._failWith(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(r,e,n).then(function(){r.sharedClientState.notifyBundleLoaded()})}var rd,id,od=(fd.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.R=Il(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return t.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Ko(e),[2]}})})},fd.prototype.Uo=function(t){return null},fd.prototype.Ko=function(t){return lh(this.persistence,new oh,t.initialUser,this.R)},fd.prototype.qo=function(t){return new xh(Lh.bs,this.R)},fd.prototype.Bo=function(t){return new rl},fd.prototype.terminate=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}})})},fd),sd=(n(ld,id=od),ld.prototype.initialize=function(n){return y(this,void 0,void 0,function(){var e=this;return g(this,function(t){switch(t.label){case 0:return[4,id.prototype.initialize.call(this,n)];case 1:return t.sent(),[4,Th(this.localStore)];case 2:return t.sent(),[4,this.Qo.initialize(this,n)];case 3:return t.sent(),[4,ed(this.Qo.syncEngine)];case 4:return t.sent(),[4,Jl(this.Qo.remoteStore)];case 5:return t.sent(),[4,this.persistence.He(function(){return e.gcScheduler&&!e.gcScheduler.started&&e.gcScheduler.start(e.localStore),Promise.resolve()})];case 6:return t.sent(),[2]}})})},ld.prototype.Ko=function(t){return lh(this.persistence,new oh,t.initialUser,this.R)},ld.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new Nc(e,t.asyncQueue)},ld.prototype.qo=function(t){var e=eh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?uc.withCacheSize(this.cacheSizeBytes):uc.DEFAULT;return new $c(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,El(),Tl(),this.R,this.sharedClientState,!!this.forceOwnership)},ld.prototype.Bo=function(t){return new rl},ld),ad=(n(hd,rd=sd),hd.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:return[4,rd.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Qo.syncEngine,this.sharedClientState instanceof nl?(this.sharedClientState.syncEngine={ui:Xf.bind(null,e),ai:function(i,o,s,a){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return(e=i).$o?(Kr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Vo.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Eh(e.localStore)];case 3:return n=t.sent(),r=ea.createSynthesizedRemoteEventForCurrentChange(o,"current"===s),[4,Wf(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,vh(e.localStore,o,!0)];case 6:return t.sent(),Gf(e,o,a),[3,8];case 7:zr(),t.label=8;case 8:return[2]}})})}.bind(null,e),hi:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,a,u;return g(this,function(t){switch(t.label){case 0:if(!(n=td(c)).$o)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Vo.has(r)?(Kr("SyncEngine","Adding an already active target "+r),[3,5]):[4,bh(n.localStore,r)]):[3,6];case 2:return i=t.sent(),[4,mh(n.localStore,i)];case 3:return o=t.sent(),[4,Mf(n,Zf(i),o.targetId,!1)];case 4:t.sent(),Bl(n.remoteStore,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return g(this,function(t){switch(t.label){case 0:return n.Vo.has(e)?[4,vh(n.localStore,e,!1).then(function(){jl(n.remoteStore,e),Gf(n,e)}).catch(Sc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,u=l,t.label=7;case 7:return a<u.length?(u=u[a],[5,s(u)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),fn:function(t){return t.localStore.persistence.fn()}.bind(null,e),ci:function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){return[2,Eh((e=n).localStore).then(function(t){return Wf(e,t)})]})})}.bind(null,e)},[4,this.sharedClientState.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.He(function(e){return y(n,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,$f(this.Qo.syncEngine,e)];case 1:return t.sent(),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},hd.prototype.Bo=function(t){var e=El();if(!nl.yt(e))throw new Ur(Vr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=eh(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new nl(e,t.asyncQueue,n,t.clientId,t.initialUser)},hd),ud=(cd.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return g(this,function(t){switch(t.label){case 0:return this.localStore?[3,2]:(this.localStore=n.localStore,this.sharedClientState=n.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!n.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Uf(e.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Yf.bind(null,this.syncEngine),[4,ef(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},cd.prototype.createEventManager=function(t){return new uf},cd.prototype.createDatastore=function(t){var e=Il(t.databaseInfo.databaseId),n=(n=t.databaseInfo,new ul(n));return t=t.credentials,new Rl(t,n,e)},cd.prototype.createRemoteStore=function(t){var e=this,n=this.localStore,r=this.datastore,i=t.asyncQueue,o=function(t){return Uf(e.syncEngine,t,0)},t=new(ol.yt()?ol:il);return new _l(n,r,i,o,t)},cd.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,s){o=new Of(t,e,n,r,i,o);return s&&(o.$o=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},cd.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=n,Kr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,ql(e)];case 1:return t.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}})})}(this.remoteStore)},cd);function cd(){}function hd(t,e){var n=this;return(n=rd.call(this,t,e,!1)||this).Qo=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function ld(t,e,n){var r=this;return(r=id.call(this)||this).Qo=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function fd(){this.synchronizeTabs=!1}function dd(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return g(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return g(this,function(t){return[2]})})},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var pd=(Id.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},Id.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Id.prototype.Wo=function(){this.muted=!0},Id.prototype.jo=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Id),yd=(Td.prototype.close=function(){return this.Go.cancel()},Td.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return g(this,function(t){return[2,this.metadata.promise]})})},Td.prototype.Lo=function(){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}})})},Td.prototype.Ho=function(){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return[4,this.Jo()];case 1:return null===(e=t.sent())?[2,null]:(r=this.zo.decode(e),n=Number(r),isNaN(n)&&this.Yo("length string ("+r+") is not valid number"),[4,this.Xo(n)]);case 2:return r=t.sent(),[2,new bf(JSON.parse(r),e.length+n)]}})})},Td.prototype.Zo=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Td.prototype.Jo=function(){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Td.prototype.Xo=function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.tc()]:[3,3];case 1:t.sent()&&this.Yo("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Td.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},Td.prototype.tc=function(){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,this.Go.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Td),gd=(Ed.prototype.lookup=function(r){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),0<this.mutations.length)throw new Ur(Vr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,a){return y(this,void 0,void 0,function(){var n,e,r,i,o;return g(this,function(t){switch(t.label){case 0:return e=Aa((n=s).R)+"/documents",r={documents:a.map(function(t){return Ta(n.R,t)})},[4,n.$i("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.R,"found"in(t=t)?function(t,e){Wr(!!e.found),e.found.name,e.found.updateTime;var n=Ia(t,e.found.name),t=wa(e.found.updateTime),e=new Ki({mapValue:{fields:e.found.fields}});return Qi.newFoundDocument(n,t,e)}(e,t):"missing"in t?function(t,e){Wr(!!e.missing),Wr(!!e.readTime);t=Ia(t,e.missing),e=wa(e.readTime);return Qi.newNoDocument(t,e)}(e,t):zr());i.set(t.key.toString(),t)}),o=[],[2,(a.forEach(function(t){t=i.get(t.toString());Wr(!!t),o.push(t)}),o)]}})})}(this.datastore,r)];case 1:return[2,((e=t.sent()).forEach(function(t){return n.recordVersion(t)}),e)]}})})},Ed.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Ed.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},Ed.prototype.delete=function(t){this.write(new xs(t,this.precondition(t))),this.writtenDocs.add(t.toString())},Ed.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Ni.fromPath(e);n.mutations.push(new Os(e,n.precondition(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return n=Aa((e=i).R)+"/documents",r={writes:o.map(function(t){return ka(e.R,t)})},[4,e.Ni("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return t.sent(),this.committed=!0,[2]}})})},Ed.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw zr();e=ei.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ur(Vr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},Ed.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?ds.updateTime(e):ds.none()},Ed.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(this.writtenDocs.has(t.toString())||!e)return ds.exists(!0);if(e.isEqual(ei.min()))throw new Ur(Vr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ds.updateTime(e)},Ed.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},Ed.prototype.ensureCommitNotCalled=function(){},Ed),md=(bd.prototype.run=function(){--this.ec,this.nc()},bd.prototype.nc=function(){var t=this;this.Zi.ji(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return g(this,function(t){return e=new gd(this.datastore),(n=this.sc(e))&&n.then(function(t){r.asyncQueue.enqueueAndForget(function(){return e.commit().then(function(){r.deferred.resolve(t)}).catch(function(t){r.ic(t)})})}).catch(function(t){r.ic(t)}),[2]})})})},bd.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Si(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},bd.prototype.ic=function(t){var e=this;0<this.ec&&this.rc(t)?(--this.ec,this.asyncQueue.enqueueAndForget(function(){return e.nc(),Promise.resolve()})):this.deferred.reject(t)},bd.prototype.rc=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Ms(t)},bd),vd=(wd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return g(this,function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},wd.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},wd.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Ur(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},wd.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var n=new lu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return e=t.sent(),e=af(e,"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},wd);function wd(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Ph.UNAUTHENTICATED,this.clientId=Yr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,function(e){return y(r,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return Kr("FirestoreClient","Received user=",e.uid),[4,this.credentialListener(e)];case 1:return t.sent(),this.user=e,[2]}})})})}function bd(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Nl(this.asyncQueue,"transaction_retry")}function Ed(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}function Td(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new lu,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then(function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Id(t){this.observer=t,this.muted=!1}function _d(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return g(this,function(t){switch(t.label){case 0:return i.asyncQueue.verifyOperationInProgress(),Kr("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.initialUser,i.setCredentialChangeListener(function(e){return y(r,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return n.isEqual(e)?[3,2]:[4,fh(o.localStore,e)];case 1:t.sent(),n=e,t.label=2;case 2:return[2]}})})}),o.persistence.setDatabaseDeletedListener(function(){return i.terminate()}),i.offlineComponents=o,[2]}})})}function Sd(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return r.asyncQueue.verifyOperationInProgress(),[4,Ad(r)];case 1:return e=t.sent(),Kr("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.setCredentialChangeListener(function(t){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return(e=r).asyncQueue.verifyOperationInProgress(),Kr("RemoteStore","RemoteStore received new credentials"),n=zl(e),e.Or.add(3),[4,ql(e)];case 1:return t.sent(),n&&e.Br.set("Unknown"),[4,e.remoteSyncer.handleCredentialChange(i)];case 2:return t.sent(),e.Or.delete(3),[4,Ul(e)];case 3:return t.sent(),[2]}})})}(i.remoteStore,t)}),r.onlineComponents=i,[2]}})})}function Ad(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(Kr("FirestoreClient","Using default OfflineComponentProvider"),[4,_d(e,new od)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}})})}function Dd(e){return y(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(Kr("FirestoreClient","Using default OnlineComponentProvider"),[4,Sd(e,new ud)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}})})}function Nd(t){return Ad(t).then(function(t){return t.persistence})}function Cd(t){return Ad(t).then(function(t){return t.localStore})}function kd(t){return Dd(t).then(function(t){return t.remoteStore})}function Rd(t){return Dd(t).then(function(t){return t.syncEngine})}function xd(r){return y(this,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,Dd(r)];case 1:return e=t.sent(),[2,((n=e.eventManager).onListen=function(s,a){return y(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(t){switch(t.label){case 0:return e=td(s),(o=e.Po.get(a))?(n=o.targetId,e.sharedClientState.addLocalQueryTarget(n),r=o.view.Ro(),[3,4]):[3,1];case 1:return[4,mh(e.localStore,Vo(a))];case 2:return i=t.sent(),o=e.sharedClientState.addLocalQueryTarget(i.targetId),n=i.targetId,[4,Mf(e,a,n,"current"===o)];case 3:r=t.sent(),e.isPrimaryClient&&Bl(e.remoteStore,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e.syncEngine),n.onUnlisten=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return n=(e=i).Po.get(o),1<(r=e.Vo.get(n.targetId)).length?[2,(e.Vo.set(n.targetId,r.filter(function(t){return!qo(t,o)})),void e.Po.delete(o))]:e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)?[3,2]:[4,vh(e.localStore,n.targetId,!1).then(function(){e.sharedClientState.clearQueryState(n.targetId),jl(e.remoteStore,n.targetId),Gf(e,n.targetId)}).catch(Sc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Gf(e,n.targetId),[4,vh(e.localStore,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e.syncEngine),n)]}})})}function Od(n,r,i){var t=this;void 0===i&&(i={});var o=new lu;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new pd({next:function(t){r.enqueueAndForget(function(){return mf(n,a)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ur(Vr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ur(Vr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),a=new wf(Ro(i.path),t,{includeMetadataChanges:!0,so:!0});return gf(n,a)},[4,xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.asyncQueue,r,i,o])]}})})}),o.promise}function Ld(n,r,i){var t=this;void 0===i&&(i={});var o=new lu;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new pd({next:function(t){n.enqueueAndForget(function(){return mf(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ur(Vr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new wf(t,o,{includeMetadataChanges:!0,so:!0});return gf(e,s)},[4,xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n.asyncQueue,r,i,o])]}})})}),o.promise}function Pd(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t}var Md=function(t,e,n,r,i,o,s,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=a},Fd=(Object.defineProperty(Yd.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Yd.prototype.isEqual=function(t){return t instanceof Yd&&t.projectId===this.projectId&&t.database===this.database},Yd),Vd=new Map,Ud=(Wd.prototype.getToken=function(){return Promise.resolve(null)},Wd.prototype.invalidateToken=function(){},Wd.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable(function(){return e(Ph.UNAUTHENTICATED)})},Wd.prototype.removeChangeListener=function(){this.changeListener=null},Wd),qd=(zd.prototype.getToken=function(){return Promise.resolve(this.token)},zd.prototype.invalidateToken=function(){},zd.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable(function(){return e(n.token.user)})},zd.prototype.removeChangeListener=function(){this.changeListener=null},zd),Bd=(Hd.prototype.getToken=function(){var e=this,n=this.cc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.cc!==n?(Kr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Wr("string"==typeof t.accessToken),new Pd(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Hd.prototype.invalidateToken=function(){this.forceRefresh=!0},Hd.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable(function(){return y(n,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}})})})},Hd.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},Hd.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Wr(null===t||"string"==typeof t),new Ph(t)},Hd),jd=(Object.defineProperty(Qd.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),Qd),Kd=(Gd.prototype.getToken=function(){return Promise.resolve(new jd(this.hc,this.lc,this.fc))},Gd.prototype.setChangeListener=function(t,e){t.enqueueRetryable(function(){return e(Ph.FIRST_PARTY)})},Gd.prototype.removeChangeListener=function(){},Gd.prototype.invalidateToken=function(){},Gd);function Gd(t,e,n){this.hc=t,this.lc=e,this.fc=n}function Qd(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=Ph.FIRST_PARTY}function Hd(e){var n=this;this.currentUser=Ph.UNAUTHENTICATED,this.oc=new lu,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){n.cc++,n.currentUser=n.ac(),n.oc.resolve(),n.changeListener&&n.asyncQueue.enqueueRetryable(function(){return n.changeListener(n.currentUser)})};function r(t){Kr("FirebaseCredentialsProvider","Auth detected"),n.auth=t,n.auth.addAuthTokenListener(n.uc)}e.onInit(r),setTimeout(function(){var t;n.auth||((t=e.getImmediate({optional:!0}))?r(t):(Kr("FirebaseCredentialsProvider","Auth not yet detected"),n.oc.resolve()))},0)}function zd(t){this.token=t,this.changeListener=null}function Wd(){this.changeListener=null}function Yd(t,e){this.projectId=t,this.database=e||"(default)"}function Xd(t,e,n){if(!n)throw new Ur(Vr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function $d(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Jd(t,e,n,r){if(!0===e&&!0===r)throw new Ur(Vr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Zd(t){if(!Ni.isDocumentKey(t))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function tp(t){if(Ni.isDocumentKey(t))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function ep(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":zr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function np(t,e){if((t="_delegate"in t?t._delegate:t)instanceof e)return t;if(e.name===t.constructor.name)throw new Ur(Vr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=ep(t);throw new Ur(Vr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function rp(t,e){if(e<=0)throw new Ur(Vr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var ip,op=(pp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},pp),sp=(Object.defineProperty(dp.prototype,"app",{get:function(){if(!this._app)throw new Ur(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(dp.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),dp.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Ur(Vr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new op(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Ud;switch(t.type){case"gapi":var e=t.client;return Wr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Kd(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Ur(Vr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},dp.prototype._getSettings=function(){return this._settings},dp.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},dp.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},dp.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},dp.prototype._terminate=function(){return(t=Vd.get(this))&&(Kr("ComponentProvider","Removing Datastore"),Vd.delete(this),t.terminate()),Promise.resolve();var t},dp),ap=(Object.defineProperty(fp.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(fp.prototype,"parent",{get:function(){return new cp(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),fp.prototype.withConverter=function(t){return new fp(this.firestore,t,this._key)},fp),up=(lp.prototype.withConverter=function(t){return new lp(this.firestore,t,this._query)},lp),cp=(n(hp,ip=up),Object.defineProperty(hp.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(hp.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(hp.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new ap(this.firestore,null,new Ni(t))},enumerable:!1,configurable:!0}),hp.prototype.withConverter=function(t){return new hp(this.firestore,t,this._path)},hp);function hp(t,e,n){var r=this;return(r=ip.call(this,t,e,Ro(n))||this)._path=n,r.type="collection",r}function lp(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}function fp(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}function dp(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new op({}),this._settingsFrozen=!1,t instanceof Fd?(this._databaseId=t,this._credentials=new Ud):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Ur(Vr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fd(t.options.projectId)}(t),this._credentials=new Bd(e))}function pp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ur(Vr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Ur(Vr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Jd("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function yp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=E(t),Xd("collection","path",e),t instanceof sp)return tp(n=ci.fromString.apply(ci,s([e],r))),new cp(t,null,n);if(!(t instanceof ap||t instanceof cp))throw new Ur(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return tp(n=ci.fromString.apply(ci,s([t.path],r)).child(ci.fromString(e))),new cp(t.firestore,null,n)}function gp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=E(t),Xd("doc","path",e=1===arguments.length?Yr.u():e),t instanceof sp)return Zd(n=ci.fromString.apply(ci,s([e],r))),new ap(t,null,new Ni(n));if(!(t instanceof ap||t instanceof cp))throw new Ur(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Zd(n=t._path.child(ci.fromString.apply(ci,s([e],r)))),new ap(t.firestore,t instanceof cp?t.converter:null,new Ni(n))}function mp(t,e){return t=E(t),e=E(e),(t instanceof ap||t instanceof cp)&&(e instanceof ap||e instanceof cp)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function vp(t,e){return t=E(t),e=E(e),t instanceof up&&e instanceof up&&t.firestore===e.firestore&&qo(t._query,e._query)&&t.converter===e.converter}var wp=(Object.defineProperty(bp.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),bp.prototype.enqueueAndForget=function(t){this.enqueue(t)},bp.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},bp.prototype.enterRestrictedMode=function(t){this._c||(this._c=!0,this.Ec=t||!1,(t=Tl())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ic))},bp.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise(function(){});var n=new lu;return this.Rc(function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})},bp.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget(function(){return e.wc.push(t),e.bc()})},bp.prototype.bc=function(){return y(this,void 0,void 0,function(){var e,n=this;return g(this,function(t){switch(t.label){case 0:if(0===this.wc.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return t.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Iu(e=t.sent()))throw e;return Kr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.wc.length&&this.Zi.ji(function(){return n.bc()}),t.label=5;case 5:return[2]}})})},bp.prototype.Rc=function(t){var r=this,e=this.dc.then(function(){return r.gc=!0,t().catch(function(t){throw r.yc=t,r.gc=!1,Gr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",n=e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:n)),t;var e,n}).then(function(t){return r.gc=!1,t})});return this.dc=e},bp.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),-1<this.Tc.indexOf(t)&&(e=0);n=of.createAndSchedule(this,t,e,n,function(t){return r.vc(t)});return this.mc.push(n),n},bp.prototype.Ac=function(){this.yc&&zr()},bp.prototype.verifyOperationInProgress=function(){},bp.prototype.Pc=function(){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return[4,e=this.dc];case 1:t.sent(),t.label=2;case 2:if(e!==this.dc)return[3,0];t.label=3;case 3:return[2]}})})},bp.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},bp.prototype.Sc=function(r){var i=this;return this.Pc().then(function(){i.mc.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var t=0,e=i.mc;t<e.length;t++){var n=e[t];if(n.skipDelay(),"all"!==r&&n.timerId===r)break}return i.Pc()})},bp.prototype.Dc=function(t){this.Tc.push(t)},bp.prototype.vc=function(t){t=this.mc.indexOf(t);this.mc.splice(t,1)},bp);function bp(){var e=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Nl(this,"async_queue_retry"),this.Ic=function(){var t=Tl();t&&Kr("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Zi.Gi()};var t=Tl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ic)}function Ep(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Tp,Ip=(Ap.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},Ap.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},Ap.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},Ap.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},Ap.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},Ap.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},Ap),_p=(n(Sp,Tp=sp),Sp.prototype._terminate=function(){return this._firestoreClient||Np(this),this._firestoreClient.terminate()},Sp);function Sp(t,e){var n=this;return(n=Tp.call(this,t,e)||this).type="firestore",n._queue=new wp,n._persistenceKey="name"in t?t.name:"[DEFAULT]",n}function Ap(){this._progressObserver={},this._taskCompletionResolver=new lu,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Dp(t){return t._firestoreClient||Np(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Np(t){var e,n,r,i=t._freezeSettings(),i=(e=t._databaseId,n=(null===(r=t._app)||void 0===r?void 0:r.options.appId)||"",r=t._persistenceKey,new Md(e,n,r,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams));t._firestoreClient=new vd(t._credentials,t._queue,i)}function Cp(n,r,i){var t=this,o=new lu;return n.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,_d(n,i)];case 1:return t.sent(),[4,Sd(n,r)];case 2:return t.sent(),o.resolve(),[3,4];case 3:if(!("FirebaseError"===(e=t.sent()).name?e.code===Vr.FAILED_PRECONDITION||e.code===Vr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw e;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),o.reject(e),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function kp(t){if(t._initialized||t._terminated)throw new Ur(Vr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Rp=(jp.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},jp),xp=(Bp.fromBase64String=function(t){try{return new Bp(di.fromBase64String(t))}catch(t){throw new Ur(Vr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},Bp.fromUint8Array=function(t){return new Bp(di.fromUint8Array(t))},Bp.prototype.toBase64=function(){return this._byteString.toBase64()},Bp.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},Bp.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Bp.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},Bp),Op=function(t){this._methodName=t},Lp=(Object.defineProperty(qp.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(qp.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),qp.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},qp.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},qp.prototype._compareTo=function(t){return $r(this._lat,t._lat)||$r(this._long,t._long)},qp),Pp=/^__.*__$/,Mp=(Up.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Ts(t,this.data,this.fieldMask,e,this.fieldTransforms):new Es(t,this.data,e,this.fieldTransforms)},Up),Fp=(Vp.prototype.toMutation=function(t,e){return new Ts(t,this.data,this.fieldMask,e,this.fieldTransforms)},Vp);function Vp(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function Up(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}function qp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Ur(Vr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ur(Vr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}function Bp(t){this._byteString=t}function jp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new li(t)}function Kp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw zr()}}var Gp=(Object.defineProperty(zp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(zp.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),zp.prototype.xc=function(t){return new zp(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},zp.prototype.kc=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.xc({path:e,Fc:!1});return e.$c(t),e},zp.prototype.Oc=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.xc({path:t,Fc:!1});return t.Cc(),t},zp.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},zp.prototype.Lc=function(t){return Ty(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},zp.prototype.contains=function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})},zp.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},zp.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(Kp(this.Nc)&&Pp.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},zp),Qp=(Hp.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new Gp({Nc:t,methodName:e,qc:n,path:li.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},Hp);function Hp(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||Il(t)}function zp(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}function Wp(t){var e=t._freezeSettings(),n=Il(t._databaseId);return new Qp(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Yp(t,e,n,r,i,o){var s=t.Uc((o=void 0===o?{}:o).merge||o.mergeFields?2:0,e,n,i);vy("Data must be an object, but it was:",s,r);var a,u,r=gy(r,s);if(o.merge)a=new fi(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=wy(e,l[h],n);if(!s.contains(f))throw new Ur(Vr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Iy(c,f)||c.push(f)}a=new fi(c),u=s.fieldTransforms.filter(function(t){return a.covers(t.field)})}else a=null,u=s.fieldTransforms;return new Mp(new Ki(r),a,u)}var Xp,$p=(n(Jp,Xp=Op),Jp.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},Jp.prototype.isEqual=function(t){return t instanceof Jp},Jp);function Jp(){return null!==Xp&&Xp.apply(this,arguments)||this}function Zp(t,e,n){return new Gp({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var ty,ey,ny,ry,iy=(n(ly,ry=Op),ly.prototype._toFieldTransform=function(t){return new fs(t.path,new $o)},ly.prototype.isEqual=function(t){return t instanceof ly},ly),oy=(n(hy,ny=Op),hy.prototype._toFieldTransform=function(t){var e=Zp(this,t,!0),n=this.Kc.map(function(t){return yy(t,e)}),n=new Jo(n);return new fs(t.path,n)},hy.prototype.isEqual=function(t){return this===t},hy),sy=(n(cy,ey=Op),cy.prototype._toFieldTransform=function(t){var e=Zp(this,t,!0),n=this.Kc.map(function(t){return yy(t,e)}),n=new rs(n);return new fs(t.path,n)},cy.prototype.isEqual=function(t){return this===t},cy),ay=(n(uy,ty=Op),uy.prototype._toFieldTransform=function(t){var e=new as(t.R,zo(t.R,this.Qc));return new fs(t.path,e)},uy.prototype.isEqual=function(t){return this===t},uy);function uy(t,e){var n=this;return(n=ty.call(this,t)||this).Qc=e,n}function cy(t,e){var n=this;return(n=ey.call(this,t)||this).Kc=e,n}function hy(t,e){var n=this;return(n=ny.call(this,t)||this).Kc=e,n}function ly(){return null!==ry&&ry.apply(this,arguments)||this}function fy(t,r,i,e){var o=t.Uc(1,r,i);vy("Data must be an object, but it was:",o,e);var s=[],a=Ki.empty();oi(e,function(t,e){var n=Ey(r,t,i);e=E(e);t=o.Oc(n);e instanceof $p?s.push(n):null!=(t=yy(e,t))&&(s.push(n),a.set(n,t))});e=new fi(s);return new Fp(a,e,o.fieldTransforms)}function dy(t,e,n,r,i,o){var s=t.Uc(1,e,n),a=[wy(e,r,n)],u=[i];if(o.length%2!=0)throw new Ur(Vr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)a.push(wy(e,o[c])),u.push(o[c+1]);for(var h,l,f,d=[],p=Ki.empty(),y=a.length-1;0<=y;--y)Iy(d,a[y])||(h=a[y],l=E(l=u[y]),f=s.Oc(h),l instanceof $p?d.push(h):null!=(f=yy(l,f))&&(d.push(h),p.set(h,f)));i=new fi(d);return new Fp(p,i,s.fieldTransforms)}function py(t,e,n,r){return yy(n,t.Uc((r=void 0===r?!1:r)?4:3,e))}function yy(s,t){if(my(s=E(s)))return vy("Unsupported field value:",t,s),gy(s,t);if(s instanceof Op)return function(t,e){if(!Kp(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");t=t._toFieldTransform(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(void 0===s&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),s instanceof Array){if(t.settings.Fc&&4!==t.Nc)throw t.Lc("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=yy(i[r],t.Mc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===(t=E(s)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return zo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ti.fromDate(t);return{timestampValue:ma(e.R,n)}}if(t instanceof ti)return n=new ti(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:ma(e.R,n)};if(t instanceof Lp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof xp)return{bytesValue:va(e.R,t._byteString)};if(t instanceof ap){var n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ba(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+ep(t))}(0,t)}function gy(t,n){var r={};return si(t)?n.path&&0<n.path.length&&n.fieldMask.push(n.path):oi(t,function(t,e){e=yy(e,n.kc(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function my(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ti||t instanceof Lp||t instanceof xp||t instanceof ap||t instanceof Op)}function vy(t,e,n){if(!my(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=ep(n);throw"an object"===n?e.Lc(t+" a custom object"):e.Lc(t+" "+n)}var r}function wy(t,e,n){if((e=E(e))instanceof Rp)return e._internalPath;if("string"==typeof e)return Ey(t,e);throw Ty("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var by=new RegExp("[~\\*/\\[\\]]");function Ey(e,n,r){if(0<=n.search(by))throw Ty("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(Rp.bind.apply(Rp,s([void 0],n.split(".")))))._internalPath}catch(t){throw Ty("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Ty(t,e,n,r,i){var o=r&&!r.isEmpty(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ur(Vr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Iy(t,e){return t.some(function(t){return t.isEqual(e)})}var _y,Sy=(Object.defineProperty(Ny.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(Ny.prototype,"ref",{get:function(){return new ap(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),Ny.prototype.exists=function(){return null!==this._document},Ny.prototype.data=function(){if(this._document){if(this._converter){var t=new Ay(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},Ny.prototype.get=function(t){if(this._document){t=this._document.data.field(Cy("DocumentSnapshot.get",t));if(null!==t)return this._userDataWriter.convertValue(t)}},Ny),Ay=(n(Dy,_y=Sy),Dy.prototype.data=function(){return _y.prototype.data.call(this)},Dy);function Dy(){return null!==_y&&_y.apply(this,arguments)||this}function Ny(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}function Cy(t,e){return"string"==typeof e?Ey(t,e):(e instanceof Rp?e:e._delegate)._internalPath}var ky,Ry,xy=(Uy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Uy),Oy=(n(Vy,Ry=Sy),Vy.prototype.exists=function(){return Ry.prototype.exists.call(this)},Vy.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Ly(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},Vy.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){t=this._document.data.field(Cy("DocumentSnapshot.get",t));if(null!==t)return this._userDataWriter.convertValue(t,e.serverTimestamps)}},Vy),Ly=(n(Fy,ky=Oy),Fy.prototype.data=function(t){return ky.prototype.data.call(this,t=void 0===t?{}:t)},Fy),Py=(Object.defineProperty(My.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(My.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(My.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),My.prototype.forEach=function(e,n){var r=this;this._snapshot.docs.forEach(function(t){e.call(n,new Ly(r._firestore,r._userDataWriter,t.key,t,new xy(r._snapshot.mutatedKeys.has(t.key),r._snapshot.fromCache),r.query.converter))})},My.prototype.docChanges=function(t){t=!!(t=void 0===t?{}:t).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ur(Vr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,e){if(i._snapshot.oldDocs.isEmpty()){var n=0;return i._snapshot.docChanges.map(function(t){return{type:"added",doc:new Ly(i._firestore,i._userDataWriter,t.doc.key,t.doc,new xy(i._snapshot.mutatedKeys.has(t.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:n++}})}var o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Ly(i._firestore,i._userDataWriter,t.doc.key,t.doc,new xy(i._snapshot.mutatedKeys.has(t.doc.key),i._snapshot.fromCache),i.query.converter),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return zr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},My);function My(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new xy(r.hasPendingWrites,r.fromCache),this.query=n}function Fy(){return null!==ky&&ky.apply(this,arguments)||this}function Vy(t,e,n,r,i,o){var s=this;return(s=Ry.call(this,t,e,n,r,o)||this)._firestore=t,s._firestoreImpl=t,s.metadata=i,s}function Uy(t,e){this.hasPendingWrites=t,this.fromCache=e}function qy(t,e){return t instanceof Oy&&e instanceof Oy?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Py&&e instanceof Py&&t._firestore===e._firestore&&vp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function By(t){if(Oo(t)&&0===t.explicitOrderBy.length)throw new Ur(Vr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}R=function(){};function jy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r]._apply(t);return t}var Ky,Gy,Qy,Hy,zy,Wy=(n(rg,zy=R),rg.prototype._apply=function(t){var e=Wp(t.firestore),e=function(t,e,n,r,i,o){if(r.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){sg(o,i);for(var s=[],a=0,u=o;a<u.length;a++){var c=u[a];s.push(og(n,t,c))}h={arrayValue:{values:s}}}else h=og(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||sg(o,i),h=py(e,"where",o,"in"===i||"not-in"===i);var h=Zi.create(r,i,h);return function(t,e){if(e.g()){var n=Po(t);if(null!==n&&!n.isEqual(e.field))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Lo(t);null!==n&&ag(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Ur(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ur(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t._query,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new up(t.firestore,t.converter,(t=t._query,e=t.filters.concat([e]),new Co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},rg),Yy=(n(ng,Hy=R),ng.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ao(e,n);return e=r,null!==Lo(n=t)||null!==(t=Po(n))&&ag(0,t,e.field),r}(t._query,this.jc,this.zc);return new up(t.firestore,t.converter,(t=t._query,e=t.explicitOrderBy.concat([e]),new Co(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},ng),Xy=(n(eg,Qy=R),eg.prototype._apply=function(t){return new up(t.firestore,t.converter,Uo(t._query,this.Hc,this.Jc))},eg),$y=(n(tg,Gy=R),tg.prototype._apply=function(t){var e=ig(t,this.type,this.Yc,this.Xc);return new up(t.firestore,t.converter,(t=t._query,e=e,new Co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},tg),Jy=(n(Zy,Ky=R),Zy.prototype._apply=function(t){var e=ig(t,this.type,this.Yc,this.Xc);return new up(t.firestore,t.converter,(t=t._query,e=e,new Co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Zy);function Zy(t,e,n){var r=this;return(r=Ky.call(this)||this).type=t,r.Yc=e,r.Xc=n,r}function tg(t,e,n){var r=this;return(r=Gy.call(this)||this).type=t,r.Yc=e,r.Xc=n,r}function eg(t,e,n){var r=this;return(r=Qy.call(this)||this).type=t,r.Hc=e,r.Jc=n,r}function ng(t,e){var n=this;return(n=Hy.call(this)||this).jc=t,n.zc=e,n.type="orderBy",n}function rg(t,e,n){var r=this;return(r=zy.call(this)||this).jc=t,r.Wc=e,r.Gc=n,r.type="where",r}function ig(t,c,e,n){if(e[0]=E(e[0]),e[0]instanceof Sy)return function(t,e,n,r){if(!n)throw new Ur(Vr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Fo(t);o<s.length;o++){var a=s[o];if(a.field.isKeyField())i.push(Mi(e,n.key));else{var u=n.data.field(a.field);if(Ii(u))throw new Ur(Vr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){a=a.field.canonicalString();throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}i.push(u)}}return new bo(i,r)}(t._query,t.firestore._databaseId,e[0]._document,n);var r=Wp(t.firestore);return function(t,e,n,r,i,o){var s=t.explicitOrderBy;if(i.length>s.length)throw new Ur(Vr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var c=i[u];if(s[u].field.isKeyField()){if("string"!=typeof c)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Mo(t)&&-1!==c.indexOf("/"))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ci.fromString(c));if(!Ni.isDocumentKey(h))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Ni(h);a.push(Mi(e,h))}else{c=py(n,r,c);a.push(c)}}return new bo(a,o)}(t._query,t.firestore._databaseId,r,c,e,n)}function og(t,e,n){if("string"==typeof(n=E(n))){if(""===n)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mo(e)&&-1!==n.indexOf("/"))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ci.fromString(n));if(!Ni.isDocumentKey(e))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Mi(t,new Ni(e))}if(n instanceof ap)return Mi(t,n._key);throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ep(n)+".")}function sg(t,e){if(!Array.isArray(t)||0===t.length)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ag(t,e,n){if(!n.isEqual(e))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}ug.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),ki(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ei(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Ti(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw zr()}},ug.prototype.convertObject=function(t,n){var r=this,i={};return oi(t.fields,function(t,e){i[t]=r.convertValue(e,n)}),i},ug.prototype.convertGeoPoint=function(t){return new Lp(Ei(t.latitude),Ei(t.longitude))},ug.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.convertValue(t,e)})},ug.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=function t(e){e=e.mapValue.fields.__previous_value__;return Ii(e)?t(e):e}(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(_i(t));default:return null}},ug.prototype.convertTimestamp=function(t){t=bi(t);return new ti(t.seconds,t.nanos)},ug.prototype.convertDocumentKey=function(t,e){var n=ci.fromString(t);Wr(Ba(n));t=new Fd(n.get(1),n.get(3)),n=new Ni(n.popFirst(5));return t.isEqual(e)||Gr("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},A=ug;function ug(){}function cg(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var hg,lg=(n(pg,hg=A),pg.prototype.convertBytes=function(t){return new xp(t)},pg.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return new ap(this.firestore,null,t)},pg),fg=(dg.prototype.set=function(t,e,n){this._verifyNotCommitted();t=yg(t,this._firestore),e=cg(t.converter,e,n),n=Yp(this._dataReader,"WriteBatch.set",t._key,e,null!==t.converter,n);return this._mutations.push(n.toMutation(t._key,ds.none())),this},dg.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();t=yg(t,this._firestore),e="string"==typeof(e=E(e))||e instanceof Rp?dy(this._dataReader,"WriteBatch.update",t._key,e,n,r):fy(this._dataReader,"WriteBatch.update",t._key,e);return this._mutations.push(e.toMutation(t._key,ds.exists(!0))),this},dg.prototype.delete=function(t){this._verifyNotCommitted();t=yg(t,this._firestore);return this._mutations=this._mutations.concat(new xs(t._key,ds.none())),this},dg.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,0<this._mutations.length?this._commitHandler(this._mutations):Promise.resolve()},dg.prototype._verifyNotCommitted=function(){if(this._committed)throw new Ur(Vr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},dg);function dg(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Wp(t)}function pg(t){var e=this;return(e=hg.call(this)||this).firestore=t,e}function yg(t,e){if((t=E(t)).firestore!==e)throw new Ur(Vr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var gg,mg=(n(vg,gg=A),vg.prototype.convertBytes=function(t){return new xp(t)},vg.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return new ap(this.firestore,null,t)},vg);function vg(t){var e=this;return(e=gg.call(this)||this).firestore=t,e}function wg(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=np(t,ap);var o=np(t.firestore,_p),s=Wp(o);return Eg(o,[("string"==typeof(e=E(e))||e instanceof Rp?dy(s,"updateDoc",t._key,e,n,r):fy(s,"updateDoc",t._key,e)).toMutation(t._key,ds.exists(!0))])}function bg(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e=E(e);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Ep(n[i])||(r=n[i],i++);var o,s,a,u,c,h,l={includeMetadataChanges:r.includeMetadataChanges};return Ep(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof ap?(a=np(e.firestore,_p),u=Ro(e._key.path),h={next:function(t){n[i]&&n[i](Tg(a,e,t))},error:n[i+1],complete:n[i+2]}):(s=np(e,up),a=np(s.firestore,_p),u=s._query,c=new mg(a),h={next:function(t){n[i]&&n[i](new Py(a,c,s,t))},error:n[i+1],complete:n[i+2]},By(e._query)),function(n,t,e){var r=this,i=new pd(h),o=new wf(t,i,e);return n.asyncQueue.enqueueAndForget(function(){return y(r,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=gf,[4,xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.Wo(),n.asyncQueue.enqueueAndForget(function(){return y(r,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=mf,[4,xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(Dp(a),u,l)}function Eg(t,e){return function(n,r){var t=this,i=new lu;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=Ff,[4,Rd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(Dp(t),e)}function Tg(t,e,n){var r=n.docs.get(e._key),i=new mg(t);return new Oy(t,i,e._key,r,new xy(n.hasPendingWrites,n.fromCache),e.converter)}var Ig,_g=(Ag.prototype.get=function(t){var e=this,n=yg(t,this._firestore),r=new lg(this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return zr();t=t[0];if(t.isFoundDocument())return new Sy(e._firestore,r,t.key,t,n.converter);if(t.isNoDocument())return new Sy(e._firestore,r,n._key,null,n.converter);throw zr()})},Ag.prototype.set=function(t,e,n){t=yg(t,this._firestore),e=cg(t.converter,e,n),n=Yp(this._dataReader,"Transaction.set",t._key,e,null!==t.converter,n);return this._transaction.set(t._key,n),this},Ag.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=yg(t,this._firestore),e="string"==typeof(e=E(e))||e instanceof Rp?dy(this._dataReader,"Transaction.update",t._key,e,n,r):fy(this._dataReader,"Transaction.update",t._key,e);return this._transaction.update(t._key,e),this},Ag.prototype.delete=function(t){t=yg(t,this._firestore);return this._transaction.delete(t._key),this},n(Sg,Ig=Ag),Sg.prototype.get=function(t){var e=this,n=yg(t,this._firestore),r=new mg(this._firestore);return Ig.prototype.get.call(this,t).then(function(t){return new Oy(e._firestore,r,n._key,t._document,new xy(!1,!1),n.converter)})},Sg);function Sg(t,e){var n=this;return(n=Ig.call(this,t,e)||this)._firestore=t,n}function Ag(t,e){this._firestore=t,this._transaction=e,this._dataReader=Wp(t)}function Dg(){if("undefined"==typeof Uint8Array)throw new Ur(Vr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ng(){if("undefined"==typeof atob)throw new Ur(Vr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Cg,kg=(Fg.fromBase64String=function(t){return Ng(),new Fg(xp.fromBase64String(t))},Fg.fromUint8Array=function(t){return Dg(),new Fg(xp.fromUint8Array(t))},Fg.prototype.toBase64=function(){return Ng(),this._delegate.toBase64()},Fg.prototype.toUint8Array=function(){return Dg(),this._delegate.toUint8Array()},Fg.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},Fg.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Fg),Rg=(Mg.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){kp(t=np(t,_p));var n=Dp(t),r=t._freezeSettings(),t=new ud;return Cp(n,t,new sd(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},Mg.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){kp(t=np(t,_p));var e=Dp(t),n=t._freezeSettings(),t=new ud;return Cp(e,t,new ad(t,n.cacheSizeBytes))}(t._delegate)},Mg.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n._initialized&&!n._terminated)throw new Ur(Vr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new lu;return n._queue.enqueueAndForgetEvenWhileRestricted(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return pu.yt()?(e=n+"main",[4,pu.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(eh(n._databaseId,n._persistenceKey))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t._delegate)},Mg),xg=(Object.defineProperty(Pg.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),Pg.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Qr("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},Pg.prototype.useEmulator=function(t,e,n){(function(t,e,n,r){void 0===r&&(r={});var i,o=(t=np(t,sp))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Qr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){if("string"==typeof r.mockUserToken)s=r.mockUserToken,i=Ph.MOCK_USER;else{var s=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0;if(!(e=t.sub||t.user_id))throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");return t=a({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:e,user_id:e,firebase:{sign_in_provider:"custom",identities:{}}},t),[u(JSON.stringify({alg:"none",type:"JWT"})),u(JSON.stringify(t)),""].join(".")}(r.mockUserToken,null===(n=t._app)||void 0===n?void 0:n.options.projectId),r=r.mockUserToken.sub||r.mockUserToken.user_id;if(!r)throw new Ur(Vr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");i=new Ph(r)}t._credentials=new qd(new Pd(s,i))}})(this._delegate,t,e,n=void 0===n?{}:n)},Pg.prototype.enableNetwork=function(){return function(i){var t=this;return i.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var n,r;return g(this,function(t){switch(t.label){case 0:return[4,Nd(i)];case 1:return n=t.sent(),[4,kd(i)];case 2:return r=t.sent(),[2,(n.setNetworkEnabled(!0),(e=r).Or.delete(0),Ul(e))]}var e})})})}(Dp(np(this._delegate,_p)))},Pg.prototype.disableNetwork=function(){return function(r){var t=this;return r.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return g(this,function(t){switch(t.label){case 0:return[4,Nd(r)];case 1:return e=t.sent(),[4,kd(r)];case 2:return n=t.sent(),[2,(e.setNetworkEnabled(!1),function(n){return y(this,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return(e=n).Or.add(0),[4,ql(e)];case 1:return t.sent(),e.Br.set("Offline"),[2]}})})}(n))]}})})})}(Dp(np(this._delegate,_p)))},Pg.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Jd("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},Pg.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},Pg.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},Pg.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new lu;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=Bf,[4,Rd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(Dp(np(this._delegate,_p)))},Pg.prototype.onSnapshotsInSync=function(t){return e=this._delegate,t=t,function(n,t){var e=this,r=new pd(t);return n.asyncQueue.enqueueAndForget(function(){return y(e,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Gr.add(e),e.next()},[4,xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.Wo(),n.asyncQueue.enqueueAndForget(function(){return y(e,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Gr.delete(e)},[4,xd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(Dp(np(e,_p)),Ep(t)?t:{next:t});var e},Object.defineProperty(Pg.prototype,"app",{get:function(){if(!this.tu)throw new Ur(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),Pg.prototype.collection=function(t){try{return new nm(this,yp(this._delegate,t))}catch(t){throw Hg(t,"collection()","Firestore.collection()")}},Pg.prototype.doc=function(t){try{return new Gg(this,gp(this._delegate,t))}catch(t){throw Hg(t,"doc()","Firestore.doc()")}},Pg.prototype.collectionGroup=function(t){try{return new Zg(this,function(t,e){if(t=np(t,sp),Xd("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Ur(Vr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new up(t,null,(e=e,new Co(ci.emptyPath(),e)))}(this._delegate,t))}catch(t){throw Hg(t,"collectionGroup()","Firestore.collectionGroup()")}},Pg.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new lu;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return[4,Dd(n).then(function(t){return t.datastore})];case 1:return e=t.sent(),new md(n.asyncQueue,e,r,i).run(),[2]}})})}),i.promise}(Dp(n=this._delegate),function(t){return t=new _g(n,t),e(new Vg(r,t))})},Pg.prototype.batch=function(){var e=this;return Dp(this._delegate),new Ug(new fg(this._delegate,function(t){return Eg(e._delegate,t)}))},Pg.prototype.loadBundle=function(t){throw new Ur(Vr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},Pg.prototype.namedQuery=function(t){throw new Ur(Vr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},Pg),Og=(n(Lg,Cg=A),Lg.prototype.convertBytes=function(t){return new kg(new xp(t))},Lg.prototype.convertReference=function(t){t=this.convertDocumentKey(t,this.firestore._databaseId);return Gg.eu(t,this.firestore,null)},Lg);function Lg(t){var e=this;return(e=Cg.call(this)||this).firestore=t,e}function Pg(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Fd||(this.tu=t)}function Mg(){}function Fg(t){this._delegate=t}var Vg=(Kg.prototype.get=function(t){var e=this,n=cm(t);return this._delegate.get(n).then(function(t){return new $g(e._firestore,new Oy(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))})},Kg.prototype.set=function(t,e,n){t=cm(t);return n?($d("Transaction.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},Kg.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=cm(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,s([o,e,n],r)),this},Kg.prototype.delete=function(t){t=cm(t);return this._delegate.delete(t),this},Kg),Ug=(jg.prototype.set=function(t,e,n){t=cm(t);return n?($d("WriteBatch.set",n),this._delegate.set(t,e,n)):this._delegate.set(t,e),this},jg.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=cm(t);return 2===arguments.length?this._delegate.update(o,e):(t=this._delegate).update.apply(t,s([o,e,n],r)),this},jg.prototype.delete=function(t){t=cm(t);return this._delegate.delete(t),this},jg.prototype.commit=function(){return this._delegate.commit()},jg),qg=(Bg.prototype.fromFirestore=function(t,e){t=new Ly(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Jg(this._firestore,t),null!=e?e:{})},Bg.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},Bg.nu=function(t,e){var n=Bg.su,r=n.get(t);r||(r=new WeakMap,n.set(t,r));n=r.get(e);return n||(n=new Bg(t,new Og(t),e),r.set(e,n)),n},Bg);function Bg(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}function jg(t){this._delegate=t}function Kg(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Og(t)}qg.su=new WeakMap;var Gg=(Qg.iu=function(t,e,n){if(t.length%2!=0)throw new Ur(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new Qg(e,new ap(e._delegate,n,new Ni(t)))},Qg.eu=function(t,e,n){return new Qg(e,new ap(e._delegate,n,t))},Object.defineProperty(Qg.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(Qg.prototype,"parent",{get:function(){return new nm(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Qg.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Qg.prototype.collection=function(t){try{return new nm(this.firestore,yp(this._delegate,t))}catch(t){throw Hg(t,"collection()","DocumentReference.collection()")}},Qg.prototype.isEqual=function(t){return(t=E(t))instanceof ap&&mp(this._delegate,t)},Qg.prototype.set=function(t,e){e=$d("DocumentReference.set",e);try{return function(t,e,n){t=np(t,ap);var r=np(t.firestore,_p),e=cg(t.converter,e,n);return Eg(r,[Yp(Wp(r),"setDoc",t._key,e,null!==t.converter,n).toMutation(t._key,ds.none())])}(this._delegate,t,e)}catch(t){throw Hg(t,"setDoc()","DocumentReference.set()")}},Qg.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?wg(this._delegate,t):wg.apply(void 0,s([this._delegate,t,e],n))}catch(t){throw Hg(t,"updateDoc()","DocumentReference.update()")}},Qg.prototype.delete=function(){return Eg(np((t=this._delegate).firestore,_p),[new xs(t._key,ds.none())]);var t},Qg.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=zg(t),i=Wg(t,function(t){return new $g(e.firestore,new Oy(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))});return bg(this._delegate,r,i)},Qg.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=np(e,ap);var n=np(e.firestore,_p),t=Dp(n),r=new mg(n);return function(n,r){var t=this,i=new lu;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(o,s,a){return y(this,void 0,void 0,function(){var r,i;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Mn.mn(t,e)}))];case 1:return(i=t.sent()).isFoundDocument()?a.resolve(i):i.isNoDocument()?a.resolve(null):a.reject(new Ur(Vr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=af(r,"Failed to get document '"+s+" from cache"),a.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Cd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e._key).then(function(t){return new Oy(n,r,e._key,t,new xy(null!==t&&t.hasLocalMutations,!0),e.converter)})}:"server"===(null==t?void 0:t.source)?function(e){e=np(e,ap);var n=np(e.firestore,_p);return Od(Dp(n),e._key,{source:"server"}).then(function(t){return Tg(n,e,t)})}:function(e){e=np(e,ap);var n=np(e.firestore,_p);return Od(Dp(n),e._key).then(function(t){return Tg(n,e,t)})})(this._delegate).then(function(t){return new $g(e.firestore,new Oy(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))})},Qg.prototype.withConverter=function(t){return new Qg(this.firestore,t?this._delegate.withConverter(qg.nu(this.firestore,t)):this._delegate.withConverter(null))},Qg);function Qg(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Og(t)}function Hg(t,e,n){return t.message=t.message.replace(e,n),t}function zg(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Ep(r))return r}return{}}function Wg(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Ep(t[0])?t[0]:Ep(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Yg,Xg,$g=(Object.defineProperty(um.prototype,"ref",{get:function(){return new Gg(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(um.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(um.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(um.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),um.prototype.data=function(t){return this._delegate.data(t)},um.prototype.get=function(t,e){return this._delegate.get(t,e)},um.prototype.isEqual=function(t){return qy(this._delegate,t._delegate)},um),Jg=(n(am,Xg=$g),am.prototype.data=function(t){return this._delegate.data(t)},am),Zg=(sm.prototype.where=function(t,e,n){try{return new sm(this.firestore,jy(this._delegate,(r=n,i=e,o=Cy("where",t),new Wy(o,i,r))))}catch(t){throw Hg(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},sm.prototype.orderBy=function(t,e){try{return new sm(this.firestore,jy(this._delegate,(n=void 0===e?"asc":e,r=Cy("orderBy",t),new Yy(r,n))))}catch(t){throw Hg(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},sm.prototype.limit=function(t){try{return new sm(this.firestore,jy(this._delegate,(rp("limit",e=t),new Xy("limit",e,"F"))))}catch(t){throw Hg(t,"limit()","Query.limit()")}var e},sm.prototype.limitToLast=function(t){try{return new sm(this.firestore,jy(this._delegate,(rp("limitToLast",e=t),new Xy("limitToLast",e,"L"))))}catch(t){throw Hg(t,"limitToLast()","Query.limitToLast()")}var e},sm.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sm(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $y("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Hg(t,"startAt()","Query.startAt()")}},sm.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sm(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new $y("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Hg(t,"startAfter()","Query.startAfter()")}},sm.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sm(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Hg(t,"endBefore()","Query.endBefore()")}},sm.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new sm(this.firestore,jy(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Jy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Hg(t,"endAt()","Query.endAt()")}},sm.prototype.isEqual=function(t){return vp(this._delegate,t._delegate)},sm.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=np(e,up);var n=np(e.firestore,_p),t=Dp(n),r=new mg(n);return function(n,r){var t=this,i=new lu;return n.asyncQueue.enqueueAndForget(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return g(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,wh(i,o,!0)];case 1:return r=t.sent(),e=new kf(o,r.Bn),n=e._o(r.documents),n=e.applyChanges(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=af(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Cd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e._query).then(function(t){return new Py(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=np(e,up);var n=np(e.firestore,_p),t=Dp(n),r=new mg(n);return Ld(t,e._query,{source:"server"}).then(function(t){return new Py(n,r,e,t)})}:function(e){e=np(e,up);var n=np(e.firestore,_p),t=Dp(n),r=new mg(n);return By(e._query),Ld(t,e._query).then(function(t){return new Py(n,r,e,t)})})(this._delegate).then(function(t){return new em(e.firestore,new Py(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))})},sm.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=zg(t),i=Wg(t,function(t){return new em(e.firestore,new Py(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))});return bg(this._delegate,r,i)},sm.prototype.withConverter=function(t){return new sm(this.firestore,t?this._delegate.withConverter(qg.nu(this.firestore,t)):this._delegate.withConverter(null))},sm),tm=(Object.defineProperty(om.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(om.prototype,"doc",{get:function(){return new Jg(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(om.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(om.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),om),em=(Object.defineProperty(im.prototype,"query",{get:function(){return new Zg(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(im.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(im.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(im.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(im.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map(function(t){return new Jg(e._firestore,t)})},enumerable:!1,configurable:!0}),im.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map(function(t){return new tm(e._firestore,t)})},im.prototype.forEach=function(e,n){var r=this;this._delegate.forEach(function(t){e.call(n,new Jg(r._firestore,t))})},im.prototype.isEqual=function(t){return qy(this._delegate,t._delegate)},im),nm=(n(rm,Yg=Zg),Object.defineProperty(rm.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(rm.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(rm.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new Gg(this.firestore,t):null},enumerable:!1,configurable:!0}),rm.prototype.doc=function(t){try{return new Gg(this.firestore,void 0===t?gp(this._delegate):gp(this._delegate,t))}catch(t){throw Hg(t,"doc()","CollectionReference.doc()")}},rm.prototype.add=function(t){var e,n,r,i=this;return e=this._delegate,n=t,t=np(e.firestore,_p),r=gp(e),n=cg(e.converter,n),Eg(t,[Yp(Wp(e.firestore),"addDoc",r._key,n,null!==e.converter,{}).toMutation(r._key,ds.exists(!1))]).then(function(){return r}).then(function(t){return new Gg(i.firestore,t)})},rm.prototype.isEqual=function(t){return mp(this._delegate,t._delegate)},rm.prototype.withConverter=function(t){return new rm(this.firestore,t?this._delegate.withConverter(qg.nu(this.firestore,t)):this._delegate.withConverter(null))},rm);function rm(t,e){var n=this;return(n=Yg.call(this,t,e)||this).firestore=t,n._delegate=e,n}function im(t,e){this._firestore=t,this._delegate=e}function om(t,e){this._firestore=t,this._delegate=e}function sm(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Og(t)}function am(){return null!==Xg&&Xg.apply(this,arguments)||this}function um(t,e){this._firestore=t,this._delegate=e}function cm(t){return np(t,ap)}lm.documentId=function(){return new lm(li.keyField().canonicalString())},lm.prototype.isEqual=function(t){return(t=E(t))instanceof Rp&&this._delegate._internalPath.isEqual(t._internalPath)},R=lm,hm.serverTimestamp=function(){var t=new iy("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new hm(t)},hm.delete=function(){var t=new $p("deleteField");return t._methodName="FieldValue.delete",new hm(t)},hm.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new oy("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new hm(n)},hm.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sy("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new hm(n)},hm.increment=function(t){t=new ay("increment",t);return t._methodName="FieldValue.increment",new hm(t)},hm.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},A=hm;function hm(t){this._delegate=t}function lm(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Rp.bind.apply(Rp,s([void 0],t)))}function fm(t){return e=this._delegate,s=t,n=Dp(e=np(e,_p)),t=new Ip,function(n,t,r){var e,i=this,o=(e=s,t=Il(t),e=function(t){if(t instanceof Uint8Array)return dd(t,void 0);if(t instanceof ArrayBuffer)return dd(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new yd(e,t));n.asyncQueue.enqueueAndForget(function(){return y(i,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=nd,[4,Rd(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(n,e._databaseId,t),t;var e,s,n}function dm(t){var e=this,n=this._delegate,t=t;return function(n,r){var t=this;return n.asyncQueue.enqueue(function(){return y(t,void 0,void 0,function(){var e;return g(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.Ke.getNamedQuery(t,e)})},[4,Cd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(Dp(n=np(n,_p)),t).then(function(t){return t?new up(n,null,t.query):null}).then(function(t){return t?new Zg(e,t):null})}var pm=(ym.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},ym.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},ym.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ym.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},ym);function ym(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}var gm,mm,vm={Firestore:xg,GeoPoint:Lp,Timestamp:ti,Blob:kg,Transaction:Vg,WriteBatch:Ug,DocumentReference:Gg,DocumentSnapshot:$g,Query:Zg,QueryDocumentSnapshot:Jg,QuerySnapshot:em,CollectionReference:nm,FieldPath:R,FieldValue:A,setLogLevel:function(t){qr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(gm=e.default).INTERNAL.registerComponent(new pm("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new xg(e,new _p(e,t),new Rg)},"PUBLIC").setServiceProps(Object.assign({},vm))),gm.registerVersion("@firebase/firestore","2.4.0"),(mm=xg).prototype.loadBundle=fm,mm.prototype.namedQuery=dm}.apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).firebase)}(this,function(Du){"use strict";try{!function(){function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=e(Du),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e,s,a,u){return new(a=a||Promise)(function(n,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function i(e){try{o(u.throw(e))}catch(e){t(e)}}function o(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(r,i)}o((u=u.apply(e,s||[])).next())})}function p(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&t[0]?o.return:t[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;switch(o=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,o=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(n,a)}catch(e){t=[6,e],o=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function _(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&r>=e.length?void 0:e)&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function s(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}function o(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t}function a(e){return e=o(e),c.encodeByteArray(e,!0)}function u(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null}var h={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},g=function(e,t){if(!e)throw m(t)},m=function(e){return new Error("Firebase Database ("+h.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],s=i+1<e.length,a=s?e[i+1]:0,u=i+2<e.length,l=u?e[i+2]:0,h=(15&a)<<2|l>>6,l=63&l;u||(l=64,s||(h=64)),r.push(n[o>>2],n[(3&o)<<4|a>>4],n[h],n[l])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i,o,s,a=e[n++];a<128?t[r++]=String.fromCharCode(a):191<a&&a<224?(o=e[n++],t[r++]=String.fromCharCode((31&a)<<6|63&o)):239<a&&a<365?(i=((7&a)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536,t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))):(o=e[n++],s=e[n++],t[r++]=String.fromCharCode((15&a)<<12|(63&o)<<6|63&s))}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();r.push(o<<2|s>>4),64!==a&&(r.push(s<<4&240|a>>2),64!==u&&r.push(a<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},d=function(e){return a(e).replace(/\./g,"")};function f(e){return function e(t,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return n}for(var r in n)n.hasOwnProperty(r)&&v(r)&&(t[r]=e(t[r],n[r]));return t}(void 0,e)}function v(e){return"__proto__"!==e}var w=(C.prototype.wrapCallback=function(n){var r=this;return function(e,t){e?r.reject(e):r.resolve(t),"function"==typeof n&&(r.promise.catch(function(){}),1===n.length?n(e):n(e,t))}},C);function C(){var n=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})}function b(){return"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function T(){return!0===h.NODE_ADMIN}var E,I="FirebaseError",S=(n(k,E=Error),k);function k(e,t,n){t=E.call(this,t)||this;return t.code=e,t.customData=n,t.name=I,Object.setPrototypeOf(t,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(t,P.prototype.create),t}var P=(N.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=t[0]||{},o=this.service+"/"+e,e=this.errors[e],e=e?(r=i,e.replace(x,function(e,t){var n=r[t];return null!=n?String(n):"<"+t+"?>"})):"Error",e=this.serviceName+": "+e+" ("+o+").";return new S(o,e,i)},N);function N(e,t,n){this.service=e,this.serviceName=t,this.errors=n}var x=/\{\$([^}]+)}/g;function R(e){return JSON.parse(e)}function O(e){return JSON.stringify(e)}function D(e){var t={},n={},r={},i="";try{var o=e.split("."),t=R(u(o[0])||""),n=R(u(o[1])||""),i=o[2],r=n.d||{};delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function L(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function M(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function F(e,t,n){var r,i={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=t.call(n,e[r],r,e));return i}function q(e){for(var n=[],t=0,r=Object.entries(e);t<r.length;t++){var i=r[t];!function(t,e){Array.isArray(e)?e.forEach(function(e){n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}(i[0],i[1])}return n.length?"&"+n.join("&"):""}var W=(j.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},j.prototype.compress_=function(e,t){t=t||0;var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,s=this.chain_[0],a=this.chain_[1],u=this.chain_[2],l=this.chain_[3],h=this.chain_[4],r=0;r<80;r++)var c=r<40?r<20?(o=l^a&(u^l),1518500249):(o=a^u^l,1859775393):r<60?(o=a&u|l&(a|u),2400959708):(o=a^u^l,3395469782),i=(s<<5|s>>>27)+o+h+c+n[r]&4294967295,h=l,l=u,u=4294967295&(a<<30|a>>>2),a=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},j.prototype.update=function(e,t){if(null!=e){for(var n=(t=void 0===t?e.length:t)-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},j.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;0<=i;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},j);function j(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}function U(e,t,n,r){var i;if(r<t?i="at least "+t:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}function B(e,t){return e+" failed: "+t+" argument "}function V(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(B(e,t)+"must be a valid function.")}function z(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(B(e,t)+"must be a valid context object.")}function H(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:55296<=r&&r<=56319?(t+=4,n++):t+=3}return t}function Q(e){return e&&e._delegate?e._delegate:e}var Y=(K.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},K.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},K.prototype.setServiceProps=function(e){return this.serviceProps=e,this},K.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},K);function K(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}var G="[DEFAULT]",$=(J.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){e=new w;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{var n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise},J.prototype.getImmediate=function(t){var e=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),t=null!==(t=null==t?void 0:t.optional)&&void 0!==t&&t;if(!this.isInitialized(e)&&!this.shouldAutoInitialize()){if(t)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:e})}catch(e){if(t)return null;throw e}},J.prototype.getComponent=function(){return this.component},J.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:G})}catch(e){}try{for(var r=_(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=y(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var l=this.getOrInitializeService({instanceIdentifier:u});a.resolve(l)}catch(e){}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},J.prototype.clearInstance=function(e){this.instancesDeferred.delete(e=void 0===e?G:e),this.instancesOptions.delete(e),this.instances.delete(e)},J.prototype.delete=function(){return i(this,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(s(s([],y(t.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}))),y(t.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))))];case 1:return e.sent(),[2]}})})},J.prototype.isComponentSet=function(){return null!=this.component},J.prototype.isInitialized=function(e){return this.instances.has(e=void 0===e?G:e)},J.prototype.getOptions=function(e){return this.instancesOptions.get(e=void 0===e?G:e)||{}},J.prototype.initialize=function(e){var t,n,r=(e=void 0===e?{}:e).options,r=void 0===r?{}:r,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(this.name+"("+i+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var o=this.getOrInitializeService({instanceIdentifier:i,options:r});try{for(var s=_(this.instancesDeferred.entries()),a=s.next();!a.done;a=s.next()){var u=y(a.value,2),l=u[0],h=u[1];i===this.normalizeInstanceIdentifier(l)&&h.resolve(o)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o},J.prototype.onInit=function(e,t){var n=this.normalizeInstanceIdentifier(t),r=null!==(t=this.onInitCallbacks.get(n))&&void 0!==t?t:new Set;r.add(e),this.onInitCallbacks.set(n,r);t=this.instances.get(n);return t&&e(t,n),function(){r.delete(e)}},J.prototype.invokeOnInitCallbacks=function(e,t){var n,r,i=this.onInitCallbacks.get(t);if(i)try{for(var o=_(i),s=o.next();!s.done;s=o.next()){var a=s.value;try{a(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},J.prototype.getOrInitializeService=function(e){var t=e.instanceIdentifier,n=e.options,r=void 0===n?{}:n,e=this.instances.get(t);if(!e&&this.component&&(e=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t)===G?void 0:n,options:r}),this.instances.set(t,e),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(e,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,e)}catch(e){}return e||null},J.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=G),!this.component||this.component.multipleInstances?e:G},J.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},J);function J(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}var X,Z=(ee.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},ee.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},ee.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new $(e,this);return this.providers.set(e,t),t},ee.prototype.getProviders=function(){return Array.from(this.providers.values())},ee);function ee(e){this.name=e,this.providers=new Map}(Tt=X=X||{})[Tt.DEBUG=0]="DEBUG",Tt[Tt.VERBOSE=1]="VERBOSE",Tt[Tt.INFO=2]="INFO",Tt[Tt.WARN=3]="WARN",Tt[Tt.ERROR=4]="ERROR",Tt[Tt.SILENT=5]="SILENT";function te(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=ie[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[o].apply(console,s(["["+i+"]  "+e.name+":"],n))}}var ne={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},re=X.INFO,ie=((It={})[X.DEBUG]="log",It[X.VERBOSE]="log",It[X.INFO]="info",It[X.WARN]="warn",It[X.ERROR]="error",It),oe=(Object.defineProperty(se.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in X))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),se.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?ne[e]:e},Object.defineProperty(se.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(se.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),se.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,s([this,X.DEBUG],e)),this._logHandler.apply(this,s([this,X.DEBUG],e))},se.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,s([this,X.VERBOSE],e)),this._logHandler.apply(this,s([this,X.VERBOSE],e))},se.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,s([this,X.INFO],e)),this._logHandler.apply(this,s([this,X.INFO],e))},se.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,s([this,X.WARN],e)),this._logHandler.apply(this,s([this,X.WARN],e))},se.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,s([this,X.ERROR],e)),this._logHandler.apply(this,s([this,X.ERROR],e))},se);function se(e){this.name=e,this._logLevel=re,this._logHandler=te,this._userLogHandler=null}var ae="";function ue(e){ae=e}var le=(he.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),O(t))},he.prototype.get=function(e){e=this.domStorage_.getItem(this.prefixedName_(e));return null==e?null:R(e)},he.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},he.prototype.prefixedName_=function(e){return this.prefix_+e},he.prototype.toString=function(){return this.domStorage_.toString()},he);function he(e){this.domStorage_=e,this.prefix_="firebase:"}var ce=(pe.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},pe.prototype.get=function(e){return A(this.cache_,e)?this.cache_[e]:null},pe.prototype.remove=function(e){delete this.cache_[e]},pe);function pe(){this.cache_={},this.isInMemoryStorage=!0}function de(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i,o=e.charCodeAt(r);55296<=o&&o<=56319&&(i=o-55296,g(++r<e.length,"Surrogate pair missing trail surrogate."),o=65536+(i<<10)+(e.charCodeAt(r)-56320)),o<128?t[n++]=o:(o<2048?t[n++]=o>>6|192:(o<65536?t[n++]=o>>12|224:(t[n++]=o>>18|240,t[n++]=o>>12&63|128),t[n++]=o>>6&63|128),t[n++]=63&o|128)}return t}(e);return(e=new W).update(t),e=e.digest(),c.encodeByteArray(e)}function fe(e,t){g(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Ee.logLevel=X.VERBOSE,ke=Ee.log.bind(Ee),t&&Te.set("logging_enabled",!0)):"function"==typeof e?ke=e:(ke=null,Te.remove("logging_enabled"))}function _e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+Se.apply(void 0,s([],y(e)));Ee.error(n)}function ye(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)}function ve(e,t){return e===t?0:e<t?-1:1}function ge(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+O(t))}function me(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)n<i+t?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r}var we,Ce=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new le(t)}}catch(e){}return new ce},be=Ce("localStorage"),Te=Ce("sessionStorage"),Ee=new oe("@firebase/database"),Ie=(we=1,function(){return we++}),Se=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++){var i=e[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=Se.apply(null,i):n+="object"==typeof i?O(i):i,n+=" "}return n},ke=null,Pe=!0,Ne=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];!0===Pe&&(Pe=!1,null===ke&&!0===Te.get("logging_enabled")&&fe(!0)),ke&&(e=Se.apply(null,t),ke(e))},xe=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Ne.apply(void 0,s([n],y(e)))}},Re=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+Se.apply(void 0,s([],y(e)));throw Ee.error(n),new Error(n)},Oe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+Se.apply(void 0,s([],y(e)));Ee.warn(n)},De="[MIN_NAME]",Ae="[MAX_NAME]",Le=function(e,t){if(e===t)return 0;if(e===De||t===Ae)return-1;if(t===De||e===Ae)return 1;var n=Ve(e),r=Ve(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null===r&&e<t?-1:1},Me=function(e){if("object"!=typeof e||null===e)return O(e);var t,n=[];for(t in e)n.push(t);n.sort();for(var r="{",i=0;i<n.length;i++)0!==i&&(r+=","),r+=O(n[i]),r+=":",r+=Me(e[n[i]]);return r+="}"};function Fe(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function qe(e){var t,n,r,i;g(!ye(e),"Invalid JSON number"),0===e?t=1/e==-1/(r=n=0)?1:0:(t=e<0,r=(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(e/Math.pow(2,-1074))));for(var o=[],s=52;s;--s)o.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;--s)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();var a=o.join(""),u="";for(s=0;s<64;s+=8){var l=parseInt(a.substr(s,8),2).toString(16);u+=l=1===l.length?"0"+l:l}return u.toLowerCase()}function We(e,t){return"object"==typeof(t=setTimeout(e,t))&&t.unref&&t.unref(),t}var je=new RegExp("^-?(0*)\\d{1,10}$"),Ue=-2147483648,Be=2147483647,Ve=function(e){if(je.test(e)){e=Number(e);if(Ue<=e&&e<=Be)return e}return null},ze=function(e){try{e()}catch(t){setTimeout(function(){var e=t.stack||"";throw Oe("Exception was thrown by user callback.",e),t},Math.floor(0))}},He=(Qe.prototype.getToken=function(n){var r=this;return this.appCheck?this.appCheck.getToken(n):new Promise(function(e,t){setTimeout(function(){r.appCheck?r.getToken(n).then(e,t):e(null)},0)})},Qe.prototype.addTokenChangeListener=function(t){var e;null!==(e=this.appCheckProvider)&&void 0!==e&&e.get().then(function(e){return e.addTokenListener(t)})},Qe.prototype.notifyForInvalidToken=function(){Oe('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},Qe);function Qe(e,t){var n=this;this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null!=t&&t.get().then(function(e){return n.appCheck=e})}var Ye=(Ke.prototype.getToken=function(n){var r=this;return this.auth_?this.auth_.getToken(n).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(Ne("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):new Promise(function(e,t){setTimeout(function(){r.auth_?r.getToken(n).then(e,t):e(null)},0)})},Ke.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(function(e){return e.addAuthTokenListener(t)})},Ke.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then(function(e){return e.removeAuthTokenListener(t)})},Ke.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Oe(e)},Ke);function Ke(e,t,n){var r=this;this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(function(e){return r.auth_=e})}var Ge=($e.prototype.getToken=function(e){return Promise.resolve({accessToken:this.accessToken})},$e.prototype.addTokenChangeListener=function(e){e(this.accessToken)},$e.prototype.removeTokenChangeListener=function(e){},$e.prototype.notifyForInvalidToken=function(){},$e.OWNER="owner",$e);function $e(e){this.accessToken=e}var Je=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Xe="websocket",Ze="long_polling",et=(tt.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},tt.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(tt.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&be.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),tt.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},tt.prototype.toURLString=function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return e+this.host+"/"+t},tt);function tt(e,t,n,r,i,o,s){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===s&&(s=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=be.get("host:"+e)||this._host}function nt(e,t,n){var r;if(g("string"==typeof t,"typeof type must == string"),g("object"==typeof n,"typeof params must == object"),t===Xe)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Ze)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}((t=e).host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams)&&(n.ns=e.namespace);var i=[];return Fe(n,function(e,t){i.push(e+"="+t)}),r+i.join("&")}var rt=(it.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),A(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},it.prototype.get=function(){return f(this.counters_)},it);function it(){this.counters_={}}var ot={},st={};function at(e){e=e.toString();return ot[e]||(ot[e]=new rt),ot[e]}var ut=(lt.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},lt.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=0;e<t.length;++e)!function(e){t[e]&&ze(function(){n.onMessage_(t[e])})}(e);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];)if("break"===r())break},lt);function lt(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}var ht="pLPCommand",ct="pRTLPCB",pt=(dt.prototype.open=function(e,t){var n,r,i,s=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ut(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){s.log_("Timed out trying to connect."),s.onClosed_(),s.connectTimeoutTimer_=null},Math.floor(3e4)),n=function(){var e;s.isClosed_||(s.scriptTagHolder=new ft(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=y(e,5),r=n[0],i=n[1],o=n[2];if(n[3],n[4],s.incrementIncomingBytes_(e),s.scriptTagHolder)if(s.connectTimeoutTimer_&&(clearTimeout(s.connectTimeoutTimer_),s.connectTimeoutTimer_=null),s.everConnected_=!0,"start"===r)s.id=i,s.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(s.scriptTagHolder.sendNewPolls=!1,s.myPacketOrderer.closeAfter(i,function(){s.onClosed_()})):s.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=y(e,2),r=n[0],n=n[1];s.incrementIncomingBytes_(e),s.myPacketOrderer.handleResponse(r,n)},function(){s.onClosed_()},s.urlFn),(e={start:"t"}).ser=Math.floor(1e8*Math.random()),s.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=s.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",s.transportSessionId&&(e.s=s.transportSessionId),s.lastSessionId&&(e.ls=s.lastSessionId),s.applicationId&&(e.p=s.applicationId),s.appCheckToken&&(e.ac=s.appCheckToken),"undefined"!=typeof location&&location.hostname&&Je.test(location.hostname)&&(e.r="f"),e=s.urlFn(e),s.log_("Connecting via long-poll to "+e),s.scriptTagHolder.addTag(e,function(){}))},"complete"===document.readyState?n():(r=!1,i=function(){document.body?r||(r=!0,n()):setTimeout(i,Math.floor(10))},document.addEventListener?(document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",i,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&i()}),window.attachEvent("onload",i)))},dt.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},dt.forceAllow=function(){dt.forceAllow_=!0},dt.forceDisallow=function(){dt.forceDisallow_=!0},dt.isAvailable=function(){return!!dt.forceAllow_||!(dt.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},dt.prototype.markConnectionHealthy=function(){},dt.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},dt.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},dt.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},dt.prototype.send=function(e){e=O(e);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var e=a(e),t=me(e,1840),n=0;n<t.length;n++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,t.length,t[n]),this.curSegmentNum++},dt.prototype.addDisconnectPingFrame=function(e,t){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},dt.prototype.incrementIncomingBytes_=function(e){e=O(e).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},dt);function dt(e,t,n,r,i,o,s){var a=this;this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=xe(e),this.stats_=at(t),this.urlFn=function(e){return a.appCheckToken&&(e.ac=a.appCheckToken),nt(t,Ze,e)}}var ft=(_t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||Ne("No IE domain setting required")}catch(e){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},_t.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},_t.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},_t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(0<this.pendingSegs.length?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var e=this.urlFn(e),t="",n=0;0<this.pendingSegs.length;){if(!(this.pendingSegs[0].d.length+30+t.length<=1870))break;var r=this.pendingSegs.shift(),t=t+"&seg"+n+"="+r.seg+"&ts"+n+"="+r.ts+"&d"+n+"="+r.d;n++}return this.addLongPollTag_(e+=t,this.currentSerial),!0}return!1},_t.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},_t.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);function r(){n.outstandingRequests.delete(t),n.newRequest_()}var i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})},_t.prototype.addTag=function(e,n){var r=this;setTimeout(function(){try{if(!r.sendNewPolls)return;var t=r.myIFrame.doc.createElement("script");t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){var e=t.readyState;e&&"loaded"!==e&&"complete"!==e||(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),n())},t.onerror=function(){Ne("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(t)}catch(e){}},Math.floor(1))},_t);function _t(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=Ie(),window[ht+this.uniqueCallbackIdentifier]=e,window[ct+this.uniqueCallbackIdentifier]=t,this.myIFrame=_t.createIFrame_();t="",t="<html><body>"+(t=this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)?'<script>document.domain="'+document.domain+'";<\/script>':t)+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(t),this.myIFrame.doc.close()}catch(e){Ne("frame writing exception"),e.stack&&Ne(e.stack),Ne(e)}}var yt=null;"undefined"!=typeof MozWebSocket?yt=MozWebSocket:"undefined"!=typeof WebSocket&&(yt=WebSocket);var vt=(gt.connectionURL_=function(e,t,n,r){var i={v:"5"};return"undefined"!=typeof location&&location.hostname&&Je.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),nt(e,Xe,i)},gt.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,be.set("previous_websocket_failure",!0);try{T()||(r={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}},this.mySock=new yt(this.connURL,[],r))}catch(e){this.log_("Error instantiating WebSocket.");var r=e.message||e.data;return r&&this.log_(r),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");e=e.message||e.data;e&&n.log_(e),n.onClosed_()}},gt.prototype.start=function(){},gt.forceDisallow=function(){gt.forceDisallow_=!0},gt.isAvailable=function(){var e,t=!1;return"undefined"!=typeof navigator&&navigator.userAgent&&((e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/))&&1<e.length&&parseFloat(e[1])<4.4&&(t=!0)),!t&&null!==yt&&!gt.forceDisallow_},gt.previouslyFailed=function(){return be.isInMemoryStorage||!0===be.get("previous_websocket_failure")},gt.prototype.markConnectionHealthy=function(){be.remove("previous_websocket_failure")},gt.prototype.appendFrame_=function(e){this.frames.push(e),this.frames.length===this.totalFrames&&(e=this.frames.join(""),this.frames=null,e=R(e),this.onMessage(e))},gt.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},gt.prototype.extractFrameCount_=function(e){if(g(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},gt.prototype.handleIncomingFrame=function(e){null!==this.mySock&&(e=e.data,this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames?this.appendFrame_(e):null!==(e=this.extractFrameCount_(e))&&this.appendFrame_(e))},gt.prototype.send=function(e){this.resetKeepAlive();e=O(e);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var t=me(e,16384);1<t.length&&this.sendString_(String(t.length));for(var n=0;n<t.length;n++)this.sendString_(t[n])},gt.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},gt.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},gt.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},gt.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},gt.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},gt.responsesRequiredToBeHealthy=2,gt.healthyTimeout=3e4,gt);function gt(e,t,n,r,i,o,s){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=xe(this.connId),this.stats_=at(t),this.connURL=gt.connectionURL_(t,o,s,r),this.nodeAdmin=t.nodeAdmin}var mt=(Object.defineProperty(wt,"ALL_TRANSPORTS",{get:function(){return[pt,vt]},enumerable:!1,configurable:!0}),wt.prototype.initTransports_=function(e){var t,n,r=vt&&vt.isAvailable(),i=r&&!vt.previouslyFailed();if(e.webSocketOnly&&(r||Oe("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[vt];else{var o=this.transports_=[];try{for(var s=_(wt.ALL_TRANSPORTS),a=s.next();!a.done;a=s.next()){var u=a.value;u&&u.isAvailable()&&o.push(u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}},wt.prototype.initialTransport=function(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")},wt.prototype.upgradeTransport=function(){return 1<this.transports_.length?this.transports_[1]:null},wt);function wt(e){this.initTransports_(e)}var Ct=(bt.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));t=t.healthyTimeout||0;0<t&&(this.healthyTimeout_=We(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&102400<e.conn_.bytesReceived?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&10240<e.conn_.bytesSent?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(t)))},bt.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},bt.prototype.disconnReceiver_=function(t){var n=this;return function(e){t===n.conn_?n.onConnectionLost_(e):t===n.secondaryConn_?(n.log_("Secondary connection lost."),n.onSecondaryConnectionLost_()):n.log_("closing an old connection")}},bt.prototype.connReceiver_=function(t){var n=this;return function(e){2!==n.state_&&(t===n.rx_?n.onPrimaryMessageReceived_(e):t===n.secondaryConn_?n.onSecondaryMessageReceived_(e):n.log_("message on old connection"))}},bt.prototype.sendRequest=function(e){this.sendData_({t:"d",d:e})},bt.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},bt.prototype.onSecondaryControl_=function(e){"t"in e&&("a"===(e=e.t)?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_()))},bt.prototype.onSecondaryMessageReceived_=function(e){var t=ge("t",e),e=ge("d",e);if("c"===t)this.onSecondaryControl_(e);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(e)}},bt.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},bt.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},bt.prototype.onPrimaryMessageReceived_=function(e){var t=ge("t",e),e=ge("d",e);"c"===t?this.onControl_(e):"d"===t&&this.onDataMessage_(e)},bt.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},bt.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},bt.prototype.onControl_=function(e){var t=ge("t",e);if("d"in e){e=e.d;if("h"===t)this.onHandshake_(e);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(e):"r"===t?this.onReset_(e):"e"===t?_e("Server Error: "+e):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):_e("Unknown control packet command: "+t)}},bt.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Oe("Protocol version mismatch detected"),this.tryStartUpgrade_())},bt.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},bt.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),e=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,e),We(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},bt.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},bt.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):We(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},bt.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},bt.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},bt.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(be.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},bt.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},bt.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},bt.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},bt.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},bt);function bt(e,t,n,r,i,o,s,a,u,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=xe("c:"+this.id+":"),this.transportManager_=new mt(t),this.log_("Connection created"),this.start_()}var Tt=(Et.prototype.put=function(e,t,n,r){},Et.prototype.merge=function(e,t,n,r){},Et.prototype.refreshAuthToken=function(e){},Et.prototype.refreshAppCheckToken=function(e){},Et.prototype.onDisconnectPut=function(e,t,n){},Et.prototype.onDisconnectMerge=function(e,t,n){},Et.prototype.onDisconnectCancel=function(e,t){},Et.prototype.reportStats=function(e){},Et);function Et(){}var It=(St.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=s([],y(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},St.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});e=this.getInitialEvent(e);e&&t.apply(n,e)},St.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},St.prototype.validateEventType_=function(t){g(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},St);function St(e){this.allowedEvents_=e,this.listeners_={},g(Array.isArray(e)&&0<e.length,"Requires a non-empty array")}var kt,Pt=(n(Nt,kt=It),Nt.getInstance=function(){return new Nt},Nt.prototype.getInitialEvent=function(e){return g("online"===e,"Unknown event type: "+e),[this.online_]},Nt.prototype.currentlyOnline=function(){return this.online_},Nt);function Nt(){var e=kt.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||b()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}var xt=32,Rt=768,Ot=(Dt.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},Dt);function Dt(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)0<this.pieces_[r].length&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}function At(){return new Ot("")}function Lt(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Mt(e){return e.pieces_.length-e.pieceNum_}function Ft(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new Ot(e.pieces_,t)}function qt(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Wt(e,t){return e.pieces_.slice(e.pieceNum_+(t=void 0===t?0:t))}function jt(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Ot(t,0)}function Ut(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof Ot)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else for(var i=t.split("/"),r=0;r<i.length;r++)0<i[r].length&&n.push(i[r]);return new Ot(n,0)}function Bt(e){return e.pieceNum_>=e.pieces_.length}function Vt(e,t){var n=Lt(e),r=Lt(t);if(null===n)return t;if(n===r)return Vt(Ft(e),Ft(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function zt(e,t){for(var n=Wt(e,0),r=Wt(t,0),i=0;i<n.length&&i<r.length;i++){var o=Le(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Ht(e,t){if(Mt(e)!==Mt(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Qt(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(Mt(e)>Mt(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Yt=function(e,t){this.errorPrefix_=t,this.parts_=Wt(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=H(this.parts_[n]);Kt(this)};function Kt(e){if(e.byteLength_>Rt)throw new Error(e.errorPrefix_+"has a key path longer than "+Rt+" bytes ("+e.byteLength_+").");if(e.parts_.length>xt)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+xt+") or object contains a cycle "+Gt(e))}function Gt(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var $t,Jt=(n(Xt,$t=It),Xt.getInstance=function(){return new Xt},Xt.prototype.getInitialEvent=function(e){return g("visible"===e,"Unknown event type: "+e),[this.visible_]},Xt);function Xt(){var t,e,n=$t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,e&&document.addEventListener(e,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}var Zt,en=1e3,tn=3e5,nn=(n(rn,Zt=Tt),rn.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,t={r:r,a:e,b:t};this.log_(O(t)),g(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(t),n&&(this.requestCBHash_[r]=n)},rn.prototype.get=function(e){var n=this;this.initConnection_();var r=new w,i={p:e._path.toString(),q:e._queryObject},t={action:"g",request:i,onComplete:function(e){var t=e.d;"ok"===e.s?(n.onDataUpdate_(i.p,t,!1,null),r.resolve(t)):r.reject(t)}};this.outstandingGets_.push(t),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=n.outstandingGets_[o];void 0!==e&&t===e&&(delete n.outstandingGets_[o],n.outstandingGetCount_--,0===n.outstandingGetCount_&&(n.outstandingGets_=[]),n.log_("get "+o+" timed out on connection"),r.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(o),r.promise},rn.prototype.listen=function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),g(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),g(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");n={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,n),this.connected_&&this.sendListen_(n)},rn.prototype.sendGet_=function(t){var n=this,r=this.outstandingGets_[t];this.sendRequest("g",r.request,function(e){delete n.outstandingGets_[t],n.outstandingGetCount_--,0===n.outstandingGetCount_&&(n.outstandingGets_=[]),r.onComplete&&r.onComplete(e)})},rn.prototype.sendListen_=function(r){var i=this,o=r.query,s=o._path.toString(),a=o._queryIdentifier;this.log_("Listen on "+s+" for "+a);var e={p:s};r.tag&&(e.q=o._queryObject,e.t=r.tag),e.h=r.hashFn(),this.sendRequest("q",e,function(e){var t=e.d,n=e.s;rn.warnOnListenWarnings_(t,o),(i.listens.get(s)&&i.listens.get(s).get(a))===r&&(i.log_("listen response",e),"ok"!==n&&i.removeListen_(s,a),r.onComplete&&r.onComplete(n,t))})},rn.warnOnListenWarnings_=function(e,t){e&&"object"==typeof e&&A(e,"w")&&(e=L(e,"w"),Array.isArray(e)&&~e.indexOf("no_index")&&(e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',t=t._path.toString(),Oe("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+e+" at "+t+" to your security rules for better performance.")))},rn.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},rn.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||function(e){e=D(e).claims;return"object"==typeof e&&!0===e.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},rn.prototype.refreshAppCheckToken=function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})},rn.prototype.tryAuth=function(){var n,e,t,r=this;this.connected_&&this.authToken_&&(e=function(e){e=D(e).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(n=this.authToken_)?"auth":"gauth",t={cred:n},null===this.authOverride_?t.noauth=!0:"object"==typeof this.authOverride_&&(t.authvar=this.authOverride_),this.sendRequest(e,t,function(e){var t=e.s,e=e.d||"error";r.authToken_===n&&("ok"===t?r.invalidAuthTokenCount_=0:r.onAuthRevoked_(t,e))}))},rn.prototype.tryAppCheck=function(){var n=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(e){var t=e.s,e=e.d||"error";"ok"===t?n.invalidAppCheckTokenCount_=0:n.onAppCheckRevoked_(t,e)})},rn.prototype.unlisten=function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),g(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)},rn.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);e={p:e};r&&(e.q=n,e.t=r),this.sendRequest("n",e)},rn.prototype.onDisconnectPut=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},rn.prototype.onDisconnectMerge=function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},rn.prototype.onDisconnectCancel=function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},rn.prototype.sendOnDisconnect_=function(e,t,n,r){n={p:t,d:n};this.log_("onDisconnect "+e,n),this.sendRequest(e,n,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},rn.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},rn.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},rn.prototype.putInternal=function(e,t,n,r,i){this.initConnection_();n={p:t,d:n};void 0!==i&&(n.h=i),this.outstandingPuts_.push({action:e,request:n,onComplete:r}),this.outstandingPutCount_++;r=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(r):this.log_("Buffering put: "+t)},rn.prototype.sendPut_=function(t){var n=this,r=this.outstandingPuts_[t].action,e=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,e,function(e){n.log_(r+" response",e),delete n.outstandingPuts_[t],n.outstandingPutCount_--,0===n.outstandingPutCount_&&(n.outstandingPuts_=[]),i&&i(e.s,e.d)})},rn.prototype.reportStats=function(e){var t=this;this.connected_&&(this.log_("reportStats",e={c:e}),this.sendRequest("s",e,function(e){"ok"!==e.s&&(e=e.d,t.log_("reportStats","Error sending stats: "+e))}))},rn.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+O(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},rn.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):_e("Unrecognized action received from server: "+O(e)+"\nAre you using the latest client?")},rn.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},rn.prototype.scheduleConnect_=function(e){var t=this;g(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},rn.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},rn.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},rn.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},rn.prototype.onRealtimeDisconnect_=function(){var e;this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()&&(this.visible_?this.lastConnectionEstablishedTime_&&(3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=en),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime()),e=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-e),e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)),this.onConnectStatus_(!1)},rn.prototype.establishConnection_=function(){return i(this,void 0,void 0,function(){var t,n,r,i,o,s,a,u,l,h,c=this;return p(this,function(e){switch(e.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+rn.nextConnectionId_++,h=this.lastSessionId,o=!1,s=null,a=function(){s?s.close():(o=!0,r())},l=function(e){g(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)},this.realtime_={close:a,sendRequest:l},u=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)])];case 2:return l=y.apply(void 0,[e.sent(),2]),u=l[0],l=l[1],o?Ne("getToken() completed but was canceled"):(Ne("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=l&&l.token,s=new Ct(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,function(e){Oe(e+" ("+c.repoInfo_.toString()+")"),c.interrupt("server_kill")},h)),[3,4];case 3:return h=e.sent(),this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Oe(h),a()),[3,4];case 4:return[2]}})})},rn.prototype.interrupt=function(e){Ne("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},rn.prototype.resume=function(e){Ne("Resuming connection for reason: "+e),delete this.interruptReasons_[e],M(this.interruptReasons_)&&(this.reconnectDelay_=en,this.realtime_||this.scheduleConnect_(0))},rn.prototype.handleTimestamp_=function(e){e-=(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},rn.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},rn.prototype.onListenRevoked_=function(e,t){t=t?t.map(function(e){return Me(e)}).join("$"):"default",t=this.removeListen_(e,t);t&&t.onComplete&&t.onComplete("permission_denied")},rn.prototype.removeListen_=function(e,t){var n,r=new Ot(e).toString();return this.listens.has(r)?(n=(e=this.listens.get(r)).get(t),e.delete(t),0===e.size&&this.listens.delete(r)):n=void 0,n},rn.prototype.onAuthRevoked_=function(e,t){Ne("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,3<=this.invalidAuthTokenCount_&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},rn.prototype.onAppCheckRevoked_=function(e,t){Ne("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,3<=this.invalidAppCheckTokenCount_&&this.appCheckTokenProvider_.notifyForInvalidToken())},rn.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},rn.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=_(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,_(s.values())),u=a.next();!u.done;u=a.next()){var l=u.value;this.sendListen_(l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var c=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(c.action,c.pathString,c.data,c.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},rn.prototype.sendConnectStats_=function(){var e={};e["sdk.js."+ae.replace(/\./g,"-")]=1,b()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)},rn.prototype.shouldReconnect_=function(){var e=Pt.getInstance().currentlyOnline();return M(this.interruptReasons_)&&e},rn.nextPersistentConnectionId_=0,rn.nextConnectionId_=0,rn);function rn(e,t,n,r,i,o,s,a){var u=Zt.call(this)||this;if(u.repoInfo_=e,u.applicationId_=t,u.onDataUpdate_=n,u.onConnectStatus_=r,u.onServerInfoUpdate_=i,u.authTokenProvider_=o,u.appCheckTokenProvider_=s,u.authOverride_=a,u.id=rn.nextPersistentConnectionId_++,u.log_=xe("p:"+u.id+":"),u.interruptReasons_={},u.listens=new Map,u.outstandingPuts_=[],u.outstandingGets_=[],u.outstandingPutCount_=0,u.outstandingGetCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=en,u.maxReconnectDelay_=tn,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.appCheckToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.invalidAppCheckTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,a&&!T())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Jt.getInstance().on("visible",u.onVisible_,u),-1===e.host.indexOf("fblocal")&&Pt.getInstance().on("online",u.onOnline_,u),u}var on=(sn.Wrap=function(e,t){return new sn(e,t)},sn);function sn(e,t){this.name=e,this.node=t}var an,Ce=(un.prototype.getCompare=function(){return this.compare.bind(this)},un.prototype.indexedValueChanged=function(e,t){e=new on(De,e),t=new on(De,t);return 0!==this.compare(e,t)},un.prototype.minPost=function(){return on.MIN},un);function un(){}var ln,oe=(n(hn,ln=Ce),Object.defineProperty(hn,"__EMPTY_NODE",{get:function(){return an},set:function(e){an=e},enumerable:!1,configurable:!0}),hn.prototype.compare=function(e,t){return Le(e.name,t.name)},hn.prototype.isDefinedOn=function(e){throw m("KeyIndex.isDefinedOn not expected to be called.")},hn.prototype.indexedValueChanged=function(e,t){return!1},hn.prototype.minPost=function(){return on.MIN},hn.prototype.maxPost=function(){return new on(Ae,an)},hn.prototype.makePost=function(e,t){return g("string"==typeof e,"KeyIndex indexValue must always be a string."),new on(e,an)},hn.prototype.toString=function(){return".key"},hn);function hn(){return null!==ln&&ln.apply(this,arguments)||this}var cn=new oe,pn=(dn.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_.pop(),t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value};if(this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},dn.prototype.hasNext=function(){return 0<this.nodeStack_.length},dn.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},dn);function dn(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}var fn=(_n.prototype.copy=function(e,t,n,r,i){return new _n(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},_n.prototype.count=function(){return this.left.count()+1+this.right.count()},_n.prototype.isEmpty=function(){return!1},_n.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},_n.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},_n.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},_n.prototype.minKey=function(){return this.min_().key},_n.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},_n.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},_n.prototype.removeMin_=function(){if(this.left.isEmpty())return gn.EMPTY_NODE;var e=this;return(e=(e=!e.left.isRed_()&&!e.left.left.isRed_()?e.moveRedLeft_():e).copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},_n.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r=(r=!(r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_())?r.moveRedLeft_():r).copy(null,null,null,r.left.remove(e,t),null);else{if(0===t(e,(r=!((r=r.left.isRed_()?r.rotateRight_():r).right.isEmpty()||r.right.isRed_()||r.right.left.isRed_())?r.moveRedRight_():r).key)){if(r.right.isEmpty())return gn.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},_n.prototype.isRed_=function(){return this.color},_n.prototype.fixUp_=function(){var e=this;return e=(e=(e=e.right.isRed_()&&!e.left.isRed_()?e.rotateLeft_():e).left.isRed_()&&e.left.left.isRed_()?e.rotateRight_():e).left.isRed_()&&e.right.isRed_()?e.colorFlip_():e},_n.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e=e.right.left.isRed_()?(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_():e},_n.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e=e.left.left.isRed_()?(e=e.rotateRight_()).colorFlip_():e},_n.prototype.rotateLeft_=function(){var e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},_n.prototype.rotateRight_=function(){var e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},_n.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},_n.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},_n.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},_n.RED=!0,_n.BLACK=!1,_n);function _n(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:_n.RED,this.left=null!=r?r:gn.EMPTY_NODE,this.right=null!=i?i:gn.EMPTY_NODE}yn.prototype.copy=function(e,t,n,r,i){return this},yn.prototype.insert=function(e,t,n){return new fn(e,t,null)},yn.prototype.remove=function(e,t){return this},yn.prototype.count=function(){return 0},yn.prototype.isEmpty=function(){return!0},yn.prototype.inorderTraversal=function(e){return!1},yn.prototype.reverseTraversal=function(e){return!1},yn.prototype.minKey=function(){return null},yn.prototype.maxKey=function(){return null},yn.prototype.check_=function(){return 0},yn.prototype.isRed_=function(){return!1},It=yn;function yn(){}var vn,gn=(mn.prototype.insert=function(e,t){return new mn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,fn.BLACK,null,null))},mn.prototype.remove=function(e){return new mn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,fn.BLACK,null,null))},mn.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:0<t&&(n=n.right)}return null},mn.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:0<t&&(n=(r=n).right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},mn.prototype.isEmpty=function(){return this.root_.isEmpty()},mn.prototype.count=function(){return this.root_.count()},mn.prototype.minKey=function(){return this.root_.minKey()},mn.prototype.maxKey=function(){return this.root_.maxKey()},mn.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},mn.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},mn.prototype.getIterator=function(e){return new pn(this.root_,null,this.comparator_,!1,e)},mn.prototype.getIteratorFrom=function(e,t){return new pn(this.root_,e,this.comparator_,!1,t)},mn.prototype.getReverseIteratorFrom=function(e,t){return new pn(this.root_,e,this.comparator_,!0,t)},mn.prototype.getReverseIterator=function(e){return new pn(this.root_,null,this.comparator_,!0,e)},mn.EMPTY_NODE=new It,mn);function mn(e,t){void 0===t&&(t=mn.EMPTY_NODE),this.comparator_=e,this.root_=t}function wn(e,t){return Le(e.name,t.name)}function Cn(e,t){return Le(e,t)}function bn(e){return"number"==typeof e?"number:"+qe(e):"string:"+e}var Tn,En,In,Sn,kn=function(e){var t;e.isLeafNode()?(t=e.val(),g("string"==typeof t||"number"==typeof t||"object"==typeof t&&A(t,".sv"),"Priority must be a string or number.")):g(e===vn||e.isEmpty(),"priority of unexpected type."),g(e===vn||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Pn=(Object.defineProperty(Nn,"__childrenNodeConstructor",{get:function(){return Tn},set:function(e){Tn=e},enumerable:!1,configurable:!0}),Nn.prototype.isLeafNode=function(){return!0},Nn.prototype.getPriority=function(){return this.priorityNode_},Nn.prototype.updatePriority=function(e){return new Nn(this.value_,e)},Nn.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:Nn.__childrenNodeConstructor.EMPTY_NODE},Nn.prototype.getChild=function(e){return Bt(e)?this:".priority"===Lt(e)?this.priorityNode_:Nn.__childrenNodeConstructor.EMPTY_NODE},Nn.prototype.hasChild=function(){return!1},Nn.prototype.getPredecessorChildName=function(e,t){return null},Nn.prototype.updateImmediateChild=function(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Nn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)},Nn.prototype.updateChild=function(e,t){var n=Lt(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(g(".priority"!==n||1===Mt(e),".priority must be the last token in a path"),this.updateImmediateChild(n,Nn.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ft(e),t)))},Nn.prototype.isEmpty=function(){return!1},Nn.prototype.numChildren=function(){return 0},Nn.prototype.forEachChild=function(e,t){return!1},Nn.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},Nn.prototype.hash=function(){var e,t;return null===this.lazyHash_&&(e="",this.priorityNode_.isEmpty()||(e+="priority:"+bn(this.priorityNode_.val())+":"),e+=(t=typeof this.value_)+":",e+="number"==t?qe(this.value_):this.value_,this.lazyHash_=de(e)),this.lazyHash_},Nn.prototype.getValue=function(){return this.value_},Nn.prototype.compareTo=function(e){return e===Nn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Nn.__childrenNodeConstructor?-1:(g(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},Nn.prototype.compareToLeafNode_=function(e){var t=typeof e.value_,n=typeof this.value_,r=Nn.VALUE_TYPE_ORDER.indexOf(t),i=Nn.VALUE_TYPE_ORDER.indexOf(n);return g(0<=r,"Unknown leaf type: "+t),g(0<=i,"Unknown leaf type: "+n),r===i?"object"==n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r},Nn.prototype.withIndex=function(){return this},Nn.prototype.isIndexed=function(){return!0},Nn.prototype.equals=function(e){return e===this||!!e.isLeafNode()&&(this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_))},Nn.VALUE_TYPE_ORDER=["object","boolean","number","string"],Nn);function Nn(e,t){void 0===t&&(t=Nn.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=t,this.lazyHash_=null,g(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),kn(this.priorityNode_)}function xn(){return null!==Sn&&Sn.apply(this,arguments)||this}var Rn=new(n(xn,Sn=Ce),xn.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),r=n.compareTo(r);return 0===r?Le(e.name,t.name):r},xn.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},xn.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},xn.prototype.minPost=function(){return on.MIN},xn.prototype.maxPost=function(){return new on(Ae,new Pn("[PRIORITY-POST]",In))},xn.prototype.makePost=function(e,t){e=En(e);return new on(t,new Pn("[PRIORITY-POST]",e))},xn.prototype.toString=function(){return".priority"},xn),On=Math.log(2),Dn=(An.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},An);function An(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/On,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}var Ln,Mn,Fn=function(l,e,h,t){l.sort(e);var c=function(e,t){var n=t-e;if(0==n)return null;if(1==n)return r=l[e],i=h?h(r):r,new fn(i,r.node,fn.BLACK,null,null);var n=parseInt(n/2,10)+e,e=c(e,n),t=c(n+1,t),r=l[n],i=h?h(r):r;return new fn(i,r.node,fn.BLACK,e,t)},n=function(e){for(var t=null,n=null,i=l.length,r=function(e,t){var n=i-e,r=i;i-=e;e=c(1+n,r),r=l[n],n=h?h(r):r;o(new fn(n,r.node,t,null,e))},o=function(e){t=t?t.left=e:n=e},s=0;s<e.count;++s){var a=e.nextBitIsOne(),u=Math.pow(2,e.count-(s+1));a?r(u,fn.BLACK):(r(u,fn.BLACK),r(u,fn.RED))}return n}(new Dn(l.length));return new gn(t||e,n)},qn={},Wn=(Object.defineProperty(jn,"Default",{get:function(){return g(Rn,"ChildrenNode.ts has not been loaded"),Ln=Ln||new jn({".priority":qn},{".priority":Rn})},enumerable:!1,configurable:!0}),jn.prototype.get=function(e){var t=L(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof gn?t:null},jn.prototype.hasIndex=function(e){return A(this.indexSet_,e.toString())},jn.prototype.addIndex=function(e,t){g(e!==cn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n=[],r=!1,i=t.getIterator(on.Wrap),o=i.getNext();o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();var s=r?Fn(n,e.getCompare()):qn,a=e.toString(),u=l({},this.indexSet_);u[a]=e;t=l({},this.indexes_);return t[a]=s,new jn(t,u)},jn.prototype.addToIndexes=function(s,a){var u=this;return new jn(F(this.indexes_,function(e,t){var n=L(u.indexSet_,t);if(g(n,"Missing index implementation for "+t),e===qn){if(n.isDefinedOn(s.node)){for(var r=[],i=a.getIterator(on.Wrap),o=i.getNext();o;)o.name!==s.name&&r.push(o),o=i.getNext();return r.push(s),Fn(r,n.getCompare())}return qn}t=a.get(s.name),n=e;return(n=t?e.remove(new on(s.name,t)):n).insert(s,s.node)}),this.indexSet_)},jn.prototype.removeFromIndexes=function(n,r){return new jn(F(this.indexes_,function(e){if(e===qn)return e;var t=r.get(n.name);return t?e.remove(new on(n.name,t)):e}),this.indexSet_)},jn);function jn(e,t){this.indexes_=e,this.indexSet_=t}var Un,Bn=(Object.defineProperty(Vn,"EMPTY_NODE",{get:function(){return Mn=Mn||new Vn(new gn(Cn),null,Wn.Default)},enumerable:!1,configurable:!0}),Vn.prototype.isLeafNode=function(){return!1},Vn.prototype.getPriority=function(){return this.priorityNode_||Mn},Vn.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new Vn(this.children_,e,this.indexMap_)},Vn.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();e=this.children_.get(e);return null===e?Mn:e},Vn.prototype.getChild=function(e){var t=Lt(e);return null===t?this:this.getImmediateChild(t).getChild(Ft(e))},Vn.prototype.hasChild=function(e){return null!==this.children_.get(e)},Vn.prototype.updateImmediateChild=function(e,t){if(g(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);var n=new on(e,t),r=void 0,i=void 0,i=t.isEmpty()?(r=this.children_.remove(e),this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),this.indexMap_.addToIndexes(n,this.children_)),n=r.isEmpty()?Mn:this.priorityNode_;return new Vn(r,n,i)},Vn.prototype.updateChild=function(e,t){var n=Lt(e);if(null===n)return t;g(".priority"!==Lt(e)||1===Mt(e),".priority must be the last token in a path");t=this.getImmediateChild(n).updateChild(Ft(e),t);return this.updateImmediateChild(n,t)},Vn.prototype.isEmpty=function(){return this.children_.isEmpty()},Vn.prototype.numChildren=function(){return this.children_.count()},Vn.prototype.val=function(n){if(this.isEmpty())return null;var r={},i=0,o=0,s=!0;if(this.forEachChild(Rn,function(e,t){r[e]=t.val(n),i++,s&&Vn.INTEGER_REGEXP_.test(e)?o=Math.max(o,Number(e)):s=!1}),!n&&s&&o<2*i){var e,t=[];for(e in r)t[e]=r[e];return t}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},Vn.prototype.hash=function(){var n;return null===this.lazyHash_&&(n="",this.getPriority().isEmpty()||(n+="priority:"+bn(this.getPriority().val())+":"),this.forEachChild(Rn,function(e,t){t=t.hash();""!==t&&(n+=":"+e+":"+t)}),this.lazyHash_=""===n?"":de(n)),this.lazyHash_},Vn.prototype.getPredecessorChildName=function(e,t,n){n=this.resolveIndex_(n);if(n){t=n.getPredecessorKey(new on(e,t));return t?t.name:null}return this.children_.getPredecessorKey(e)},Vn.prototype.getFirstChildName=function(e){e=this.resolveIndex_(e);if(e){e=e.minKey();return e&&e.name}return this.children_.minKey()},Vn.prototype.getFirstChild=function(e){e=this.getFirstChildName(e);return e?new on(e,this.children_.get(e)):null},Vn.prototype.getLastChildName=function(e){e=this.resolveIndex_(e);if(e){e=e.maxKey();return e&&e.name}return this.children_.maxKey()},Vn.prototype.getLastChild=function(e){e=this.getLastChildName(e);return e?new on(e,this.children_.get(e)):null},Vn.prototype.forEachChild=function(e,t){e=this.resolveIndex_(e);return e?e.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},Vn.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},Vn.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,on.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},Vn.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},Vn.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,on.Wrap),i=r.peek();null!=i&&0<t.compare(i,e);)r.getNext(),i=r.peek();return r},Vn.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Hn?-1:0},Vn.prototype.withIndex=function(e){if(e===cn||this.indexMap_.hasIndex(e))return this;e=this.indexMap_.addIndex(e,this.children_);return new Vn(this.children_,this.priorityNode_,e)},Vn.prototype.isIndexed=function(e){return e===cn||this.indexMap_.hasIndex(e)},Vn.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()!==e.children_.count())return!1;for(var t=this.getIterator(Rn),n=e.getIterator(Rn),r=t.getNext(),i=n.getNext();r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=t.getNext(),i=n.getNext()}return null===r&&null===i}return!1},Vn.prototype.resolveIndex_=function(e){return e===cn?null:this.indexMap_.get(e.toString())},Vn.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,Vn);function Vn(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&kn(this.priorityNode_),this.children_.isEmpty()&&g(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}function zn(){return Un.call(this,new gn(Cn),Bn.EMPTY_NODE,Wn.Default)||this}var Hn=new(n(zn,Un=Bn),zn.prototype.compareTo=function(e){return e===this?0:1},zn.prototype.equals=function(e){return e===this},zn.prototype.getPriority=function(){return this},zn.prototype.getImmediateChild=function(e){return Bn.EMPTY_NODE},zn.prototype.isEmpty=function(){return!1},zn);Object.defineProperties(on,{MIN:{value:new on(De,Bn.EMPTY_NODE)},MAX:{value:new on(Ae,Hn)}}),oe.__EMPTY_NODE=Bn.EMPTY_NODE,Pn.__childrenNodeConstructor=Bn,In=vn=Hn;var Qn=!0;function Yn(n,e){if(void 0===e&&(e=null),null===n)return Bn.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),g(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"!=typeof(n="object"==typeof n&&".value"in n&&null!==n[".value"]?n[".value"]:n)||".sv"in n)return new Pn(n,Yn(e));if(n instanceof Array||!Qn){var r=Bn.EMPTY_NODE;return Fe(n,function(e,t){A(n,e)&&"."!==e.substring(0,1)&&(!(t=Yn(t)).isLeafNode()&&t.isEmpty()||(r=r.updateImmediateChild(e,t)))}),r.updatePriority(Yn(e))}var i=[],o=!1;if(Fe(n,function(e,t){"."!==e.substring(0,1)&&((t=Yn(t)).isEmpty()||(o=o||!t.getPriority().isEmpty(),i.push(new on(e,t))))}),0===i.length)return Bn.EMPTY_NODE;var t=Fn(i,wn,function(e){return e.name},Cn);if(o){var s=Fn(i,Rn.getCompare());return new Bn(t,Yn(e),new Wn({".priority":s},{".priority":Rn}))}return new Bn(t,Yn(e),Wn.Default)}En=Yn;var Kn,Gn,$n=(n(Jn,Kn=Ce),Jn.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},Jn.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},Jn.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),r=n.compareTo(r);return 0===r?Le(e.name,t.name):r},Jn.prototype.makePost=function(e,t){e=Yn(e),e=Bn.EMPTY_NODE.updateChild(this.indexPath_,e);return new on(t,e)},Jn.prototype.maxPost=function(){var e=Bn.EMPTY_NODE.updateChild(this.indexPath_,Hn);return new on(Ae,e)},Jn.prototype.toString=function(){return Wt(this.indexPath_,0).join("/")},Jn);function Jn(e){var t=Kn.call(this)||this;return t.indexPath_=e,g(!Bt(e)&&".priority"!==Lt(e),"Can't create PathIndex with empty path or .priority key"),t}function Xn(){return null!==Gn&&Gn.apply(this,arguments)||this}function Zn(e){if(e===""+Be)return"-";var t=Ve(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;0<=i&&"z"===n[i];)i--;return-1===i?Ae:(t=n[i],t=ir.charAt(ir.indexOf(t)+1),n[i]=t,n.slice(0,i+1).join(""))}function er(e){if(e===""+Ue)return De;var t=Ve(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?""+Be:(delete n[n.length-1],n.join("")):(n[n.length-1]=ir.charAt(ir.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))}var tr,nr,rr=new(n(Xn,Gn=Ce),Xn.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?Le(e.name,t.name):n},Xn.prototype.isDefinedOn=function(e){return!0},Xn.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},Xn.prototype.minPost=function(){return on.MIN},Xn.prototype.maxPost=function(){return on.MAX},Xn.prototype.makePost=function(e,t){e=Yn(e);return new on(t,e)},Xn.prototype.toString=function(){return".value"},Xn),ir="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",or=(tr=0,nr=[],function(e){var t=e===tr;tr=e;for(var n=new Array(8),r=7;0<=r;r--)n[r]=ir.charAt(e%64),e=Math.floor(e/64);g(0===e,"Cannot push at time == 0");var i=n.join("");if(t){for(r=11;0<=r&&63===nr[r];r--)nr[r]=0;nr[r]++}else for(r=0;r<12;r++)nr[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)i+=ir.charAt(nr[r]);return g(20===i.length,"nextPushId: Length should be 20."),i});function sr(e){return{type:"value",snapshotNode:e}}function ar(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function ur(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function lr(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var hr=(cr.prototype.updateChild=function(e,t,n,r,i,o){g(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(ur(t,s)):g(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(ar(t,n)):o.trackChildChange(lr(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},cr.prototype.updateFullNode=function(r,n,i){return null!=i&&(r.isLeafNode()||r.forEachChild(Rn,function(e,t){n.hasChild(e)||i.trackChildChange(ur(e,t))}),n.isLeafNode()||n.forEachChild(Rn,function(e,t){var n;r.hasChild(e)?(n=r.getImmediateChild(e)).equals(t)||i.trackChildChange(lr(e,t,n)):i.trackChildChange(ar(e,t))})),n.withIndex(this.index_)},cr.prototype.updatePriority=function(e,t){return e.isEmpty()?Bn.EMPTY_NODE:e.updatePriority(t)},cr.prototype.filtersNodes=function(){return!1},cr.prototype.getIndexedFilter=function(){return this},cr.prototype.getIndex=function(){return this.index_},cr);function cr(e){this.index_=e}var pr=(dr.prototype.getStartPost=function(){return this.startPost_},dr.prototype.getEndPost=function(){return this.endPost_},dr.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},dr.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new on(t,n))||(n=Bn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},dr.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Bn.EMPTY_NODE);var r=(r=t.withIndex(this.index_)).updatePriority(Bn.EMPTY_NODE),i=this;return t.forEachChild(Rn,function(e,t){i.matches(new on(e,t))||(r=r.updateImmediateChild(e,Bn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},dr.prototype.updatePriority=function(e,t){return e},dr.prototype.filtersNodes=function(){return!0},dr.prototype.getIndexedFilter=function(){return this.indexedFilter_},dr.prototype.getIndex=function(){return this.index_},dr.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},dr.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},dr);function dr(e){this.indexedFilter_=new hr(e.getIndex()),this.index_=e.getIndex(),this.startPost_=dr.getStartPost_(e),this.endPost_=dr.getEndPost_(e)}var fr=(_r.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new on(t,n))||(n=Bn.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},_r.prototype.updateFullNode=function(e,t,n){if(t.isLeafNode()||t.isEmpty())r=Bn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var r=Bn.EMPTY_NODE.withIndex(this.index_),i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Bn.EMPTY_NODE);var a,u=void 0,l=void 0,h=void 0,i=void 0;h=this.reverse_?(i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost(),a=this.index_.getCompare(),function(e,t){return a(t,e)}):(i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),this.index_.getCompare());for(var o=0,c=!1;i.hasNext();){s=i.getNext();(c=!c&&h(u,s)<=0?!0:c)&&o<this.limit_&&h(s,l)<=0?o++:r=r.updateImmediateChild(s.name,Bn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},_r.prototype.updatePriority=function(e,t){return e},_r.prototype.filtersNodes=function(){return!0},_r.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},_r.prototype.getIndex=function(){return this.index_},_r.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o,s;s=this.reverse_?(o=this.index_.getCompare(),function(e,t){return o(t,e)}):this.index_.getCompare();var a=e;g(a.numChildren()===this.limit_,"");var u=new on(t,n),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(a.hasChild(t)){for(var c=a.getImmediateChild(t),p=r.getChildAfterChild(this.index_,l,this.reverse_);null!=p&&(p.name===t||a.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:s(p,u);if(h&&!n.isEmpty()&&0<=d)return null!=i&&i.trackChildChange(lr(t,n,c)),a.updateImmediateChild(t,n);null!=i&&i.trackChildChange(ur(t,c));c=a.updateImmediateChild(t,Bn.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(ar(p.name,p.node)),c.updateImmediateChild(p.name,p.node)):c}return!n.isEmpty()&&h&&0<=s(l,u)?(null!=i&&(i.trackChildChange(ur(l.name,l.node)),i.trackChildChange(ar(t,n))),a.updateImmediateChild(t,n).updateImmediateChild(l.name,Bn.EMPTY_NODE)):e},_r);function _r(e){this.rangedFilter_=new pr(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}var yr=(vr.prototype.hasStart=function(){return this.startSet_},vr.prototype.hasStartAfter=function(){return this.startAfterSet_},vr.prototype.hasEndBefore=function(){return this.endBeforeSet_},vr.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},vr.prototype.getIndexStartValue=function(){return g(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},vr.prototype.getIndexStartName=function(){return g(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:De},vr.prototype.hasEnd=function(){return this.endSet_},vr.prototype.getIndexEndValue=function(){return g(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},vr.prototype.getIndexEndName=function(){return g(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ae},vr.prototype.hasLimit=function(){return this.limitSet_},vr.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},vr.prototype.getLimit=function(){return g(this.limitSet_,"Only valid if limit has been set"),this.limit_},vr.prototype.getIndex=function(){return this.index_},vr.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},vr.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Rn},vr.prototype.copy=function(){var e=new vr;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},vr);function vr(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Rn}function gr(e,t,n){e=e.copy();return e.startSet_=!0,e.indexStartValue_=t=void 0===t?null:t,null!=n?(e.startNameSet_=!0,e.indexStartName_=n):(e.startNameSet_=!1,e.indexStartName_=""),e}function mr(e,t,n){e=e.copy();return e.endSet_=!0,e.indexEndValue_=t=void 0===t?null:t,void 0!==n?(e.endNameSet_=!0,e.indexEndName_=n):(e.endNameSet_=!1,e.indexEndName_=""),e}function wr(e,t){e=e.copy();return e.index_=t,e}function Cr(e){var t,n={};return e.isDefault()||(t=e.index_===Rn?"$priority":e.index_===rr?"$value":e.index_===cn?"$key":(g(e.index_ instanceof $n,"Unrecognized index type!"),e.index_.toString()),n.orderBy=O(t),e.startSet_&&(n.startAt=O(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+O(e.indexStartName_))),e.endSet_&&(n.endAt=O(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+O(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function br(e){var t,n={};return e.startSet_&&(n.sp=e.indexStartValue_,e.startNameSet_&&(n.sn=e.indexStartName_)),e.endSet_&&(n.ep=e.indexEndValue_,e.endNameSet_&&(n.en=e.indexEndName_)),e.limitSet_&&(n.l=e.limit_,""===(t=e.viewFrom_)&&(t=e.isViewFromLeft()?"l":"r"),n.vf=t),e.index_!==Rn&&(n.i=e.index_.toString()),n}var Tr,Er=(n(Ir,Tr=Tt),Ir.prototype.reportStats=function(e){throw new Error("Method not implemented.")},Ir.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(g(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())},Ir.prototype.listen=function(e,t,n,r){var i=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var s=Ir.getListenId_(e,n),a={};this.listens_[s]=a;e=Cr(e._queryParams);this.restRequest_(o+".json",e,function(e,t){null===(e=404===e?t=null:e)&&i.onDataUpdate_(o,t,!1,n),L(i.listens_,s)===a&&r(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},Ir.prototype.unlisten=function(e,t){t=Ir.getListenId_(e,t);delete this.listens_[t]},Ir.prototype.get=function(e){var n=this,t=Cr(e._queryParams),r=e._path.toString(),i=new w;return this.restRequest_(r+".json",t,function(e,t){null===(e=404===e?t=null:e)?(n.onDataUpdate_(r,t,!1,null),i.resolve(t)):i.reject(new Error(t))}),i.promise},Ir.prototype.refreshAuthToken=function(e){},Ir.prototype.restRequest_=function(i,o,s){var a=this;return(o=void 0===o?{}:o).format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(e){var t=y(e,2),e=t[0],t=t[1];e&&e.accessToken&&(o.auth=e.accessToken),t&&t.token&&(o.ac=t.token);var n=(a.repoInfo_.secure?"https://":"http://")+a.repoInfo_.host+i+"?ns="+a.repoInfo_.namespace+q(o);a.log_("Sending REST request for "+n);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(s&&4===r.readyState){a.log_("REST Response for "+n+" received. status:",r.status,"response:",r.responseText);var e=null;if(200<=r.status&&r.status<300){try{e=R(r.responseText)}catch(e){Oe("Failed to parse JSON response for "+n+": "+r.responseText)}s(null,e)}else 401!==r.status&&404!==r.status&&Oe("Got unsuccessful REST response for "+n+" Status: "+r.status),s(r.status);s=null}},r.open("GET",n,!0),r.send()})},Ir);function Ir(e,t,n,r){var i=Tr.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=t,i.authTokenProvider_=n,i.appCheckTokenProvider_=r,i.log_=xe("p:rest:"),i.listens_={},i}var Sr=(kr.prototype.getNode=function(e){return this.rootNode_.getChild(e)},kr.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},kr);function kr(){this.rootNode_=Bn.EMPTY_NODE}function Pr(){return{value:null,children:new Map}}function Nr(e,t,n){var r;Bt(t)?(e.value=n,e.children.clear()):null!==e.value?e.value=e.value.updateChild(t,n):(r=Lt(t),e.children.has(r)||e.children.set(r,Pr()),Nr(e.children.get(r),t=Ft(t),n))}function xr(e,n,r){var i;null!==e.value?r(n,e.value):(i=function(e,t){xr(t,new Ot(n.toString()+"/"+e),r)},e.children.forEach(function(e,t){i(t,e)}))}var Rr=(Or.prototype.get=function(){var e=this.collection_.get(),n=l({},e);return this.last_&&Fe(this.last_,function(e,t){n[e]=n[e]-t}),this.last_=e,n},Or);function Or(e){this.collection_=e,this.last_=null}var Dr,Ar=(Lr.prototype.reportStats_=function(){var n=this,e=this.statsListener_.get(),r={},i=!1;Fe(e,function(e,t){0<t&&A(n.statsToReport_,e)&&(r[e]=t,i=!0)}),i&&this.server_.reportStats(r),We(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},Lr);function Lr(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Rr(e);e=1e4+2e4*Math.random();We(this.reportStats_.bind(this),Math.floor(e))}function Mr(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Fr(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function qr(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(Tt=Dr=Dr||{})[Tt.OVERWRITE=0]="OVERWRITE",Tt[Tt.MERGE=1]="MERGE",Tt[Tt.ACK_USER_WRITE=2]="ACK_USER_WRITE",Tt[Tt.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var Wr=(jr.prototype.operationForChild=function(e){if(Bt(this.path)){if(null!=this.affectedTree.value)return g(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var t=this.affectedTree.subtree(new Ot(e));return new jr(At(),t,this.revert)}return g(Lt(this.path)===e,"operationForChild called for unrelated child."),new jr(Ft(this.path),this.affectedTree,this.revert)},jr);function jr(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Dr.ACK_USER_WRITE,this.source=Mr()}var Ur=(Br.prototype.operationForChild=function(e){return Bt(this.path)?new Br(this.source,At()):new Br(this.source,Ft(this.path))},Br);function Br(e,t){this.source=e,this.path=t,this.type=Dr.LISTEN_COMPLETE}var Vr=(zr.prototype.operationForChild=function(e){return Bt(this.path)?new zr(this.source,At(),this.snap.getImmediateChild(e)):new zr(this.source,Ft(this.path),this.snap)},zr);function zr(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Dr.OVERWRITE}var Hr=(Qr.prototype.operationForChild=function(e){if(Bt(this.path)){var t=this.children.subtree(new Ot(e));return t.isEmpty()?null:t.value?new Vr(this.source,At(),t.value):new Qr(this.source,At(),t)}return g(Lt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Qr(this.source,Ft(this.path),this.children)},Qr.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Qr);function Qr(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Dr.MERGE}var Yr=(Kr.prototype.isFullyInitialized=function(){return this.fullyInitialized_},Kr.prototype.isFiltered=function(){return this.filtered_},Kr.prototype.isCompleteForPath=function(e){if(Bt(e))return this.isFullyInitialized()&&!this.filtered_;e=Lt(e);return this.isCompleteForChild(e)},Kr.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},Kr.prototype.getNode=function(){return this.node_},Kr);function Kr(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}var Gr,$r=function(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()};function Jr(n,e,t,r){var i=[],o=[];return e.forEach(function(e){var t;"child_changed"===e.type&&n.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((t=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:t}))}),Xr(n,i,"child_removed",e,r,t),Xr(n,i,"child_added",e,r,t),Xr(n,i,"child_moved",o,r,t),Xr(n,i,"child_changed",e,r,t),Xr(n,i,"value",e,r,t),i}function Xr(o,s,t,e,a,u){e=e.filter(function(e){return e.type===t});e.sort(function(e,t){return function(e,t,n){if(null==t.childName||null==n.childName)throw m("Should only compare child_ events.");t=new on(t.childName,t.snapshotNode),n=new on(n.childName,n.snapshotNode);return e.index_.compare(t,n)}(o,e,t)}),e.forEach(function(t){var e,n,r,i=(e=o,r=u,"value"===(n=t).type||"child_removed"===n.type||(n.prevName=r.getPredecessorChildName(n.childName,n.snapshotNode,e.index_)),n);a.forEach(function(e){e.respondsTo(t.type)&&s.push(e.createEvent(i,o.query_))})})}function Zr(e,t){return{eventCache:e,serverCache:t}}function ei(e,t,n,r){return Zr(new Yr(t,n,r),e.serverCache)}function ti(e,t,n,r){return Zr(e.eventCache,new Yr(t,n,r))}function ni(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ri(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var ii=(oi.fromObject=function(e){var n=new oi(null);return Fe(e,function(e,t){n=n.set(new Ot(e),t)}),n},oi.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},oi.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:At(),value:this.value};if(Bt(e))return null;var n=Lt(e),r=this.children.get(n);if(null===r)return null;t=r.findRootMostMatchingPathAndValue(Ft(e),t);return null==t?null:{path:Ut(new Ot(n),t.path),value:t.value}},oi.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},oi.prototype.subtree=function(e){if(Bt(e))return this;var t=Lt(e),t=this.children.get(t);return null!==t?t.subtree(Ft(e)):new oi(null)},oi.prototype.set=function(e,t){if(Bt(e))return new oi(t,this.children);var n=Lt(e),t=(this.children.get(n)||new oi(null)).set(Ft(e),t),t=this.children.insert(n,t);return new oi(this.value,t)},oi.prototype.remove=function(e){if(Bt(e))return this.children.isEmpty()?new oi(null):new oi(null,this.children);var t=Lt(e),n=this.children.get(t);if(n){n=n.remove(Ft(e)),e=void 0,e=n.isEmpty()?this.children.remove(t):this.children.insert(t,n);return null===this.value&&e.isEmpty()?new oi(null):new oi(this.value,e)}return this},oi.prototype.get=function(e){if(Bt(e))return this.value;var t=Lt(e),t=this.children.get(t);return t?t.get(Ft(e)):null},oi.prototype.setTree=function(e,t){if(Bt(e))return t;var n=Lt(e),e=(this.children.get(n)||new oi(null)).setTree(Ft(e),t),t=void 0,t=e.isEmpty()?this.children.remove(n):this.children.insert(n,e);return new oi(this.value,t)},oi.prototype.fold=function(e){return this.fold_(At(),e)},oi.prototype.fold_=function(n,r){var i={};return this.children.inorderTraversal(function(e,t){i[e]=t.fold_(Ut(n,e),r)}),r(n,this.value,i)},oi.prototype.findOnPath=function(e,t){return this.findOnPath_(e,At(),t)},oi.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(Bt(e))return null;var i=Lt(e),r=this.children.get(i);return r?r.findOnPath_(Ft(e),Ut(t,i),n):null},oi.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,At(),t)},oi.prototype.foreachOnPath_=function(e,t,n){if(Bt(e))return this;this.value&&n(t,this.value);var r=Lt(e),i=this.children.get(r);return i?i.foreachOnPath_(Ft(e),Ut(t,r),n):new oi(null)},oi.prototype.foreach=function(e){this.foreach_(At(),e)},oi.prototype.foreach_=function(n,r){this.children.inorderTraversal(function(e,t){t.foreach_(Ut(n,e),r)}),this.value&&r(n,this.value)},oi.prototype.foreachChild=function(n){this.children.inorderTraversal(function(e,t){t.value&&n(e,t.value)})},oi);function oi(e,t){void 0===t&&(t=Gr=Gr||new gn(ve)),this.value=e,this.children=t}var si=(ai.empty=function(){return new ai(new ii(null))},ai);function ai(e){this.writeTree_=e}function ui(e,t,n){if(Bt(t))return new si(new ii(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,r=Vt(i,t),o=o.updateChild(r,n);return new si(e.writeTree_.set(i,o))}n=new ii(n),n=e.writeTree_.setTree(t,n);return new si(n)}function li(e,n,t){var r=e;return Fe(t,function(e,t){r=ui(r,Ut(n,e),t)}),r}function hi(e,t){if(Bt(t))return si.empty();t=e.writeTree_.setTree(t,new ii(null));return new si(t)}function ci(e,t){return null!=pi(e,t)}function pi(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Vt(n.path,t)):null}function di(e){var n=[],t=e.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Rn,function(e,t){n.push(new on(e,t))}):e.writeTree_.children.inorderTraversal(function(e,t){null!=t.value&&n.push(new on(e,t.value))}),n}function fi(e,t){if(Bt(t))return e;var n=pi(e,t);return new si(null!=n?new ii(n):e.writeTree_.subtree(t))}function _i(e){return e.writeTree_.isEmpty()}function yi(e,t){return function n(r,e,i){{if(null!=e.value)return i.updateChild(r,e.value);var o=null;return e.children.inorderTraversal(function(e,t){".priority"===e?(g(null!==t.value,"Priority writes must always be leaf nodes"),o=t.value):i=n(Ut(r,e),t,i)}),i=!i.getChild(r).isEmpty()&&null!==o?i.updateChild(Ut(r,".priority"),o):i}}(At(),e.writeTree_,t)}function vi(e,t){return Ni(t,e)}function gi(t,n){var e=t.allWrites.findIndex(function(e){return e.writeId===n});g(0<=e,"removeWrite called with nonexistent writeId.");var r=t.allWrites[e];t.allWrites.splice(e,1);for(var i,o=r.visible,s=!1,a=t.allWrites.length-1;o&&0<=a;){var u=t.allWrites[a];u.visible&&(e<=a&&function(e,t){{if(e.snap)return Qt(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Qt(Ut(e.path,n),t))return!0;return!1}}(u,r.path)?o=!1:Qt(r.path,u.path)&&(s=!0)),a--}return!!o&&(s?((i=t).visibleWrites=wi(i.allWrites,mi,At()),0<i.allWrites.length?i.lastWriteId=i.allWrites[i.allWrites.length-1].writeId:i.lastWriteId=-1):r.snap?t.visibleWrites=hi(t.visibleWrites,r.path):Fe(r.children,function(e){t.visibleWrites=hi(t.visibleWrites,Ut(r.path,e))}),!0)}function mi(e){return e.visible}function wi(e,t,n){for(var r=si.empty(),i=0;i<e.length;++i){var o=e[i];if(t(o)){var s=o.path,a=void 0;if(o.snap)Qt(n,s)?r=ui(r,a=Vt(n,s),o.snap):Qt(s,n)&&(a=Vt(s,n),r=ui(r,At(),o.snap.getChild(a)));else{if(!o.children)throw m("WriteRecord should have .snap or .children");Qt(n,s)?r=li(r,a=Vt(n,s),o.children):Qt(s,n)&&(Bt(a=Vt(s,n))?r=li(r,At(),o.children):(o=L(o.children,Lt(a)))&&(a=o.getChild(Ft(a)),r=ui(r,At(),a)))}}}return r}function Ci(e,t,n,r,i){if(r||i){var o=fi(e.visibleWrites,t);if(!i&&_i(o))return n;if(i||null!=n||ci(o,At()))return yi(wi(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Qt(e.path,t)||Qt(t,e.path))},t),n||Bn.EMPTY_NODE);return null}o=pi(e.visibleWrites,t);if(null!=o)return o;e=fi(e.visibleWrites,t);return _i(e)?n:null!=n||ci(e,At())?yi(e,n||Bn.EMPTY_NODE):null}function bi(e,t,n,r){return Ci(e.writeTree,e.treePath,t,n,r)}function Ti(e,t){return function(e,t,n){var r=Bn.EMPTY_NODE,i=pi(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Rn,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(n){var o=fi(e.visibleWrites,t);return n.forEachChild(Rn,function(e,t){t=yi(fi(o,new Ot(e)),t);r=r.updateImmediateChild(e,t)}),di(o).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return di(fi(e.visibleWrites,t)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function Ei(e,t,n,r){return i=e.writeTree,e=e.treePath,t=t,r=r,g(n||r,"Either existingEventSnap or existingServerSnap must exist"),e=Ut(e,t),ci(i.visibleWrites,e)?null:_i(e=fi(i.visibleWrites,e))?r.getChild(t):yi(e,r.getChild(t));var i}function Ii(e,t){return n=e.writeTree,t=Ut(e.treePath,t),pi(n.visibleWrites,t);var n}function Si(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){var a,e=fi(e.visibleWrites,t);if(null!=(t=pi(e,At())))a=t;else{if(null==n)return[];a=yi(e,n)}if((a=a.withIndex(s)).isEmpty()||a.isLeafNode())return[];for(var u=[],l=s.getCompare(),h=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),c=h.getNext();c&&u.length<i;)0!==l(c,r)&&u.push(c),c=h.getNext();return u}(e.writeTree,e.treePath,t,n,r,i,o)}function ki(e,t,n){return r=e.writeTree,i=e.treePath,e=n,t=Ut(i,n=t),null!=(i=pi(r.visibleWrites,t))?i:e.isCompleteForChild(n)?yi(fi(r.visibleWrites,t),e.getNode().getImmediateChild(n)):null;var r,i}function Pi(e,t){return Ni(Ut(e.treePath,t),e.writeTree)}function Ni(e,t){return{treePath:e,writeTree:t}}var xi=(Ri.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;g("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),g(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,lr(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,ur(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ar(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw m("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,lr(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},Ri.prototype.getChanges=function(){return Array.from(this.changeMap.values())},Ri);function Ri(){this.changeMap=new Map}function Oi(){}var Di=new(Oi.prototype.getCompleteChild=function(e){return null},Oi.prototype.getChildAfterChild=function(e,t,n){return null},Oi),Ai=(Li.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);t=null!=this.optCompleteServerCache_?new Yr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ki(this.writes_,e,t)},Li.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ri(this.viewCache_),e=Si(this.writes_,r,t,1,n,e);return 0===e.length?null:e[0]},Li);function Li(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}function Mi(e,t,n,r,i){var o,s,a,u,l,h,c,p,d=new xi;if(n.type===Dr.OVERWRITE)var f=n,_=f.source.fromUser?Wi(e,t,f.path,f.snap,r,i,d):(g(f.source.fromServer,"Unknown source."),o=f.source.tagged||t.serverCache.isFiltered()&&!Bt(f.path),qi(e,t,f.path,f.snap,r,i,o,d));else if(n.type===Dr.MERGE){var y=n;_=y.source.fromUser?(s=e,a=t,u=y.path,f=y.children,l=r,h=i,c=d,p=a,f.foreach(function(e,t){e=Ut(u,e);ji(a,Lt(e))&&(p=Wi(s,p,e,t,l,h,c))}),f.foreach(function(e,t){e=Ut(u,e);ji(a,Lt(e))||(p=Wi(s,p,e,t,l,h,c))}),p):(g(y.source.fromServer,"Unknown source."),o=y.source.tagged||t.serverCache.isFiltered(),Bi(e,t,y.path,y.children,r,i,o,d))}else if(n.type===Dr.ACK_USER_WRITE){var v=n;_=v.revert?function(e,t,n,r,i,o){var s;{if(null!=Ii(r,n))return t;var a,u,l=new Ai(r,t,i),h=t.eventCache.getNode(),i=void 0;return Bt(n)||".priority"===Lt(n)?(u=void 0,u=t.serverCache.isFullyInitialized()?bi(r,ri(t)):(a=t.serverCache.getNode(),g(a instanceof Bn,"serverChildren would be complete if leaf node"),Ti(r,a)),i=e.filter.updateFullNode(h,u,o)):(a=Lt(n),null==(u=ki(r,a,t.serverCache))&&t.serverCache.isCompleteForChild(a)&&(u=h.getImmediateChild(a)),(i=null!=u?e.filter.updateChild(h,a,u,Ft(n),l,o):t.eventCache.getNode().hasChild(a)?e.filter.updateChild(h,a,Bn.EMPTY_NODE,Ft(n),l,o):h).isEmpty()&&t.serverCache.isFullyInitialized()&&(s=bi(r,ri(t))).isLeafNode()&&(i=e.filter.updateFullNode(i,s,o))),s=t.serverCache.isFullyInitialized()||null!=Ii(r,At()),ei(t,i,s,e.filter.filtersNodes())}}(e,t,v.path,r,i,d):function(e,t,r,n,i,o,s){if(null!=Ii(i,r))return t;var a=t.serverCache.isFiltered(),u=t.serverCache;{if(null!=n.value){if(Bt(r)&&u.isFullyInitialized()||u.isCompleteForPath(r))return qi(e,t,r,u.getNode().getChild(r),i,o,a,s);if(Bt(r)){var l=new ii(null);return u.getNode().forEachChild(cn,function(e,t){l=l.set(new Ot(e),t)}),Bi(e,t,r,l,i,o,a,s)}return t}var h=new ii(null);return n.foreach(function(e,t){var n=Ut(r,e);u.isCompleteForPath(n)&&(h=h.set(e,u.getNode().getChild(n)))}),Bi(e,t,r,h,i,o,a,s)}}(e,t,v.path,v.affectedTree,r,i,d)}else{if(n.type!==Dr.LISTEN_COMPLETE)throw m("Unknown operation type: "+n.type);v=e,i=n.path,e=r,n=d,r=ti(t,(r=t.serverCache).getNode(),r.isFullyInitialized()||Bt(i),r.isFiltered()),_=Fi(v,r,i,e,Di,n)}d=d.getChanges();return function(e,t,n){var r=t.eventCache;{var i,o;r.isFullyInitialized()&&(i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=ni(e),(0<n.length||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(sr(ni(t))))}}(t,_,d),{viewCache:_,changes:d}}function Fi(e,t,n,r,i,o){var s=t.eventCache;if(null!=Ii(r,n))return t;var a,u,l,h,c=void 0,p=void 0;return c=Bt(n)?(g(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()?(a=Ti(r,(a=ri(t))instanceof Bn?a:Bn.EMPTY_NODE),e.filter.updateFullNode(t.eventCache.getNode(),a,o)):(u=bi(r,ri(t)),e.filter.updateFullNode(t.eventCache.getNode(),u,o))):".priority"===(u=Lt(n))?(g(1===Mt(n),"Can't have a priority with additional path components"),null!=(h=Ei(r,n,l=s.getNode(),p=t.serverCache.getNode()))?e.filter.updatePriority(l,h):s.getNode()):(l=Ft(n),h=void 0,null!=(h=s.isCompleteForChild(u)?(p=t.serverCache.getNode(),null!=(p=Ei(r,n,s.getNode(),p))?s.getNode().getImmediateChild(u).updateChild(l,p):s.getNode().getImmediateChild(u)):ki(r,u,t.serverCache))?e.filter.updateChild(s.getNode(),u,h,l,i,o):s.getNode()),ei(t,c,s.isFullyInitialized()||Bt(n),e.filter.filtersNodes())}function qi(e,t,n,r,i,o,s,a){var u=t.serverCache,l=s?e.filter:e.filter.getIndexedFilter();if(Bt(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered())var h=u.getNode().updateChild(n,r),c=l.updateFullNode(u.getNode(),h,null);else{s=Lt(n);if(!u.isCompleteForPath(n)&&1<Mt(n))return t;h=Ft(n),r=u.getNode().getImmediateChild(s).updateChild(h,r);c=".priority"===s?l.updatePriority(u.getNode(),r):l.updateChild(u.getNode(),s,r,h,Di,null)}l=ti(t,c,u.isFullyInitialized()||Bt(n),l.filtersNodes());return Fi(e,l,n,i,new Ai(i,l,o),a)}function Wi(e,t,n,r,i,o,s){var a,u,l=t.eventCache,h=new Ai(i,t,o);return Bt(n)?(u=e.filter.updateFullNode(t.eventCache.getNode(),r,s),ei(t,u,!0,e.filter.filtersNodes())):".priority"===(a=Lt(n))?(u=e.filter.updatePriority(t.eventCache.getNode(),r),ei(t,u,l.isFullyInitialized(),l.isFiltered())):(i=Ft(n),o=l.getNode().getImmediateChild(a),u=void 0,u=Bt(i)?r:null!=(n=h.getCompleteChild(a))?".priority"===qt(i)&&n.getChild(jt(i)).isEmpty()?n:n.updateChild(i,r):Bn.EMPTY_NODE,o.equals(u)?t:ei(t,e.filter.updateChild(l.getNode(),a,u,i,h,s),l.isFullyInitialized(),e.filter.filtersNodes()))}function ji(e,t){return e.eventCache.isCompleteForChild(t)}function Ui(e,n,t){return t.foreach(function(e,t){n=n.updateChild(e,t)}),n}function Bi(r,i,e,t,o,s,a,u){if(i.serverCache.getNode().isEmpty()&&!i.serverCache.isFullyInitialized())return i;var l=i,t=Bt(e)?t:new ii(null).setTree(e,t),h=i.serverCache.getNode();return t.children.inorderTraversal(function(e,t){h.hasChild(e)&&(t=Ui(0,i.serverCache.getNode().getImmediateChild(e),t),l=qi(r,l,new Ot(e),t,o,s,a,u))}),t.children.inorderTraversal(function(e,t){var n=!i.serverCache.isCompleteForChild(e)&&void 0===t.value;h.hasChild(e)||n||(t=Ui(0,i.serverCache.getNode().getImmediateChild(e),t),l=qi(r,l,new Ot(e),t,o,s,a,u))}),l}var Vi,zi=(Object.defineProperty(Hi.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),Hi);function Hi(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_._queryParams,r=new hr(n.getIndex()),i=(o=n).loadsAllData()?new hr(o.getIndex()):new(o.hasLimit()?fr:pr)(o);this.processor_={filter:i};var e=t.serverCache,n=t.eventCache,o=r.updateFullNode(Bn.EMPTY_NODE,e.getNode(),null),t=i.updateFullNode(Bn.EMPTY_NODE,n.getNode(),null),r=new Yr(o,e.isFullyInitialized(),r.filtersNodes()),i=new Yr(t,n.isFullyInitialized(),i.filtersNodes());this.viewCache_=Zr(i,r),this.eventGenerator_=new $r(this.query_)}function Qi(e){return 0===e.eventRegistrations_.length}function Yi(e,t,n){var r,i=[];if(n&&(g(null==t,"A cancel should cancel all event registrations."),r=e.query._path,e.eventRegistrations_.forEach(function(e){e=e.createCancelEvent(n,r);e&&i.push(e)})),t){for(var o=[],s=0;s<e.eventRegistrations_.length;++s){var a=e.eventRegistrations_[s];if(a.matches(t)){if(t.hasAnyCallback()){o=o.concat(e.eventRegistrations_.slice(s+1));break}}else o.push(a)}e.eventRegistrations_=o}else e.eventRegistrations_=[];return i}function Ki(e,t,n,r){t.type===Dr.MERGE&&null!==t.source.queryId&&(g(ri(e.viewCache_),"We should always have a full cache before handling merges"),g(ni(e.viewCache_),"Missing event cache, even though we have a server cache"));var i=e.viewCache_,t=Mi(e.processor_,i,t,n,r);return n=e.processor_,r=t.viewCache,g(r.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),g(r.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed"),g(t.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=t.viewCache,Gi(e,t.changes,t.viewCache.eventCache.getNode(),null)}function Gi(e,t,n,r){r=r?[r]:e.eventRegistrations_;return Jr(e.eventGenerator_,t,n,r)}var $i,Ji=function(){this.views=new Map};function Xi(e,t,n,r){var i,o,s=t.source.queryId;if(null!==s){var a=e.views.get(s);return g(null!=a,"SyncTree gave us an op for an invalid query."),Ki(a,t,n,r)}var u=[];try{for(var l=_(e.views.values()),h=l.next();!h.done;h=l.next())a=h.value,u=u.concat(Ki(a,t,n,r))}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return u}function Zi(e,t,n,r,i){var o=t._queryIdentifier,e=e.views.get(o);if(e)return e;o=bi(n,i?r:null),e=!1,e=!!o||(o=r instanceof Bn?Ti(n,r):Bn.EMPTY_NODE,!1),i=Zr(new Yr(o,e,!1),new Yr(r,i,!1));return new zi(t,i)}function eo(e,t,n,r,i,o){var s,o=Zi(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),o.eventRegistrations_.push(n),t=n,o=(n=o).viewCache_.eventCache,s=[],o.getNode().isLeafNode()||o.getNode().forEachChild(Rn,function(e,t){s.push(ar(e,t))}),o.isFullyInitialized()&&s.push(sr(o.getNode())),Gi(n,s,o.getNode(),t)}function to(e,t,n,r){var i,o,s=t._queryIdentifier,a=[],u=[],l=so(e);if("default"===s)try{for(var h=_(e.views.entries()),c=h.next();!c.done;c=h.next()){var p=y(c.value,2),d=p[0],f=p[1],u=u.concat(Yi(f,n,r));Qi(f)&&(e.views.delete(d),f.query._queryParams.loadsAllData()||a.push(f.query))}}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else(f=e.views.get(s))&&(u=u.concat(Yi(f,n,r)),Qi(f)&&(e.views.delete(s),f.query._queryParams.loadsAllData()||a.push(f.query)));return l&&!so(e)&&a.push((g(Vi,"Reference.ts has not been loaded"),new Vi(t._repo,t._path))),{removed:a,events:u}}function no(e){var t,n,r=[];try{for(var i=_(e.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function ro(e,t){var n,r,i,o,s,a=null;try{for(var u=_(e.views.values()),l=u.next();!l.done;l=u.next())var h=l.value,a=a||(o=t,s=void 0,(s=ri((i=h).viewCache_))&&(i.query._queryParams.loadsAllData()||!Bt(o)&&!s.getImmediateChild(Lt(o)).isEmpty())?s.getChild(o):null)}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return a}function io(e,t){if(t._queryParams.loadsAllData())return ao(e);t=t._queryIdentifier;return e.views.get(t)}function oo(e,t){return null!=io(e,t)}function so(e){return null!=ao(e)}function ao(e){var t,n;try{for(var r=_(e.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}var uo=1,lo=function(e){this.listenProvider_=e,this.syncPointTree_=new ii(null),this.pendingWriteTree_={visibleWrites:si.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function ho(e,t,n,r,i){var o,s,a,u;return o=e.pendingWriteTree_,s=t,a=n,u=i,g((r=r)>o.lastWriteId,"Stacking an older write on top of newer ones"),o.allWrites.push({path:s,snap:a,writeId:r,visible:u=void 0===u?!0:u}),u&&(o.visibleWrites=ui(o.visibleWrites,s,a)),o.lastWriteId=r,i?mo(e,new Vr(Mr(),t,n)):[]}function co(e,t,n,r){var i,o,s;i=e.pendingWriteTree_,o=t,s=n,g((r=r)>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:o,children:s,writeId:r,visible:!0}),i.visibleWrites=li(i.visibleWrites,o,s),i.lastWriteId=r;n=ii.fromObject(n);return mo(e,new Hr(Mr(),t,n))}function po(e,t,n){void 0===n&&(n=!1);var r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(gi(e.pendingWriteTree_,t)){var i=new ii(null);return null!=r.snap?i=i.set(At(),!0):Fe(r.children,function(e){i=i.set(new Ot(e),!0)}),mo(e,new Wr(r.path,i,n))}return[]}function fo(e,t,n){return mo(e,new Vr(Fr(),t,n))}function _o(n,e,t,r){var i=e._path,o=n.syncPointTree_.get(i),s=[];if(o&&("default"===e._queryIdentifier||oo(o,e))){var a=to(o,e,t,r);0===o.views.size&&(n.syncPointTree_=n.syncPointTree_.remove(i));t=a.removed,s=a.events,o=-1!==t.findIndex(function(e){return e._queryParams.loadsAllData()}),a=n.syncPointTree_.findOnPath(i,function(e,t){return so(t)});if(o&&!a){i=n.syncPointTree_.subtree(i);if(!i.isEmpty())for(var u=i.fold(function(e,t,n){if(t&&so(t))return[ao(t)];var r=[];return t&&(r=no(t)),Fe(n,function(e,t){r=r.concat(t)}),r}),l=0;l<u.length;++l){var h=u[l],c=h.query,h=Co(n,h);n.listenProvider_.startListening(ko(c),bo(n,c),h.hashFn,h.onComplete)}}!a&&0<t.length&&!r&&(o?n.listenProvider_.stopListening(ko(e),null):t.forEach(function(e){var t=n.queryToTagMap.get(To(e));n.listenProvider_.stopListening(ko(e),t)})),function(e,t){for(var n=0;n<t.length;++n){var r,i=t[n];i._queryParams.loadsAllData()||(r=To(i),i=e.queryToTagMap.get(r),e.queryToTagMap.delete(r),e.tagToQueryMap.delete(i))}}(n,t)}return s}function yo(e,t,n){var r=t._path,i=null,o=!1;e.syncPointTree_.foreachOnPath(r,function(e,t){e=Vt(e,r);i=i||ro(t,e),o=o||so(t)});var s=e.syncPointTree_.get(r);s?(o=o||so(s),i=i||ro(s,At())):(s=new Ji,e.syncPointTree_=e.syncPointTree_.set(r,s)),null!=i?h=!0:(h=!1,i=Bn.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild(function(e,t){t=ro(t,At());t&&(i=i.updateImmediateChild(e,t))}));var a,u,l=oo(s,t);l||t._queryParams.loadsAllData()||(a=To(t),g(!e.queryToTagMap.has(a),"View does not exist, but we have a tag"),u=uo++,e.queryToTagMap.set(a,u),e.tagToQueryMap.set(u,a));var h=eo(s,t,n,vi(e.pendingWriteTree_,r),i,h);return l||o||(s=io(s,t),h=h.concat(function(e,t,n){var r=t._path,i=bo(e,t),n=Co(e,n),n=e.listenProvider_.startListening(ko(t),i,n.hashFn,n.onComplete),r=e.syncPointTree_.subtree(r);if(i)g(!so(r.value),"If we're adding a query, it shouldn't be shadowed");else for(var o=r.fold(function(e,t,n){if(!Bt(e)&&t&&so(t))return[ao(t).query];var r=[];return t&&(r=r.concat(no(t).map(function(e){return e.query}))),Fe(n,function(e,t){r=r.concat(t)}),r}),s=0;s<o.length;++s){var a=o[s];e.listenProvider_.stopListening(ko(a),bo(e,a))}return n}(e,t,s))),h}function vo(e,n,t){var r=e.pendingWriteTree_,e=e.syncPointTree_.findOnPath(n,function(e,t){e=ro(t,Vt(e,n));if(e)return e});return Ci(r,n,e,t,!0)}function go(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,function(e,t){e=Vt(e,n);r=r||ro(t,e)});var i=e.syncPointTree_.get(n);i?r=r||ro(i,At()):(i=new Ji,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,s=o?new Yr(r,!0,!1):null;return ni(Zi(i,t,vi(e.pendingWriteTree_,t._path),o?s.getNode():Bn.EMPTY_NODE,o).viewCache_)}function mo(e,t){return function e(t,n,r,i){{if(Bt(t.path))return wo(t,n,r,i);var o=n.get(At());null==r&&null!=o&&(r=ro(o,At()));var s=[],a=Lt(t.path),u=t.operationForChild(a),l=n.children.get(a);return l&&u&&(n=r?r.getImmediateChild(a):null,a=Pi(i,a),s=s.concat(e(u,l,n,a))),s=o?s.concat(Xi(o,t,i,r)):s}}(t,e.syncPointTree_,null,vi(e.pendingWriteTree_,At()))}function wo(i,e,o,s){var t=e.get(At());null==o&&null!=t&&(o=ro(t,At()));var a=[];return e.children.inorderTraversal(function(e,t){var n=o?o.getImmediateChild(e):null,r=Pi(s,e),e=i.operationForChild(e);e&&(a=a.concat(wo(e,t,n,r)))}),a=t?a.concat(Xi(t,i,s,o)):a}function Co(n,e){var r=e.query,i=bo(n,r);return{hashFn:function(){return(e.viewCache_.serverCache.getNode()||Bn.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return i?function(e,t,n){var r=Eo(e,n);if(r){n=Io(r),r=n.path,n=n.queryId,t=Vt(r,t);return So(e,r,new Ur(qr(n),t))}return[]}(n,r._path,i):(t=r._path,mo(n,new Ur(Fr(),t)));var t,t=(t="Unknown Error","too_big"===(e=e)?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?t="Client doesn't have permission to access the desired data.":"unavailable"===e&&(t="The service is unavailable"),(t=new Error(e+" at "+r._path.toString()+": "+t)).code=e.toUpperCase(),t);return _o(n,r,null,t)}}}function bo(e,t){t=To(t);return e.queryToTagMap.get(t)}function To(e){return e._path.toString()+"$"+e._queryIdentifier}function Eo(e,t){return e.tagToQueryMap.get(t)}function Io(e){var t=e.indexOf("$");return g(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Ot(e.substr(0,t))}}function So(e,t,n){var r=e.syncPointTree_.get(t);return g(r,"Missing sync point for query tag that we're tracking"),Xi(r,n,vi(e.pendingWriteTree_,t),null)}function ko(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?(g($i,"Reference.ts has not been loaded"),new $i(e._repo,e._path)):e}var Po=(No.prototype.getImmediateChild=function(e){return new No(this.node_.getImmediateChild(e))},No.prototype.node=function(){return this.node_},No);function No(e){this.node_=e}var xo=(Ro.prototype.getImmediateChild=function(e){e=Ut(this.path_,e);return new Ro(this.syncTree_,e)},Ro.prototype.node=function(){return vo(this.syncTree_,this.path_)},Ro);function Ro(e,t){this.syncTree_=e,this.path_=t}var Oo=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Do=function(e,t,n){return e&&"object"==typeof e?(g(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Ao(e[".sv"],t,n):"object"==typeof e[".sv"]?Lo(e[".sv"],t):void g(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Ao=function(e,t,n){if("timestamp"===e)return n.timestamp;g(!1,"Unexpected server value: "+e)},Lo=function(e,t,n){e.hasOwnProperty("increment")||g(!1,"Unexpected server value: "+JSON.stringify(e,null,2));e=e.increment;"number"!=typeof e&&g(!1,"Unexpected increment value: "+e);t=t.node();if(g(null!=t,"Expected ChildrenNode.EMPTY_NODE for nulls"),!t.isLeafNode())return e;t=t.getValue();return"number"!=typeof t?e:t+e},Mo=function(e,t,n,r){return qo(t,new xo(n,e),r)},Fo=function(e,t,n){return qo(e,new Po(t),n)};function qo(e,r,i){var t=e.getPriority().val(),n=Do(t,r.getImmediateChild(".priority"),i);if(e.isLeafNode()){var o=e,t=Do(o.getValue(),r,i);return t!==o.getValue()||n!==o.getPriority().val()?new Pn(t,Yn(n)):e}var e=e,s=e;return n!==e.getPriority().val()&&(s=s.updatePriority(new Pn(n))),e.forEachChild(Rn,function(e,t){var n=qo(t,r.getImmediateChild(e),i);n!==t&&(s=s.updateImmediateChild(e,n))}),s}var Wo=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e=void 0===e?"":e,this.parent=t,this.node=n};function jo(e,t){for(var n=t instanceof Ot?t:new Ot(t),r=e,i=Lt(n);null!==i;)var o=L(r.node.children,i)||{children:{},childCount:0},r=new Wo(i,r,o),i=Lt(n=Ft(n));return r}function Uo(e){return e.node.value}function Bo(e,t){e.node.value=t,Qo(e)}function Vo(e){return 0<e.node.childCount}function zo(n,r){Fe(n.node.children,function(e,t){r(new Wo(e,n,t))})}function Ho(e){return new Ot(null===e.parent?e.name:Ho(e.parent)+"/"+e.name)}function Qo(e){var t,n,r,i;null!==e.parent&&(t=e.parent,n=e.name,i=function(e){return void 0===Uo(e)&&!Vo(e)}(r=e),e=A(t.node.children,n),i&&e?(delete t.node.children[n],t.node.childCount--,Qo(t)):i||e||(t.node.children[n]=r.node,t.node.childCount++,Qo(t)))}function Yo(e){return"string"==typeof e&&0!==e.length&&!Xo.test(e)}function Ko(e){return"string"==typeof e&&0!==e.length&&!Zo.test(e)}function Go(e,t,n,r){if(!r||void 0!==t){var i=B(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var o=[];Fe(t,function(e,t){e=new Ot(e);if(rs(i,t,Ut(n,e)),".priority"===qt(e)&&!ts(t))throw new Error(i+"contains an invalid value for '"+e.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(e)}),function(e,t){for(var n=0;n<t.length;n++)for(var r,i=Wt(r=t[n]),o=0;o<i.length;o++)if((".priority"!==i[o]||o!==i.length-1)&&!Yo(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(zt);var s=null;for(n=0;n<t.length;n++){if(r=t[n],null!==s&&Qt(s,r))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(i,o)}}function $o(e,t,n){if(!n||void 0!==t){if(ye(t))throw new Error(B(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ts(t))throw new Error(B(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}}function Jo(e,t,n,r){if(!(r&&void 0===n||Yo(n)))throw new Error(B(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}var Xo=/[\[\].#$\/\u0000-\u001F\u007F]/,Zo=/[\[\].#$\u0000-\u001F\u007F]/,es=10485760,ts=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!ye(e)||e&&"object"==typeof e&&A(e,".sv")},ns=function(e,t,n,r){r&&void 0===t||rs(B(e,"value"),t,n)},rs=function(r,e,t){var i=t instanceof Ot?new Yt(t,r):t;if(void 0===e)throw new Error(r+"contains undefined "+Gt(i));if("function"==typeof e)throw new Error(r+"contains a function "+Gt(i)+" with contents = "+e.toString());if(ye(e))throw new Error(r+"contains "+e.toString()+" "+Gt(i));if("string"==typeof e&&e.length>es/3&&H(e)>es)throw new Error(r+"contains a string greater than "+es+" utf8 bytes "+Gt(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var o=!1,s=!1;if(Fe(e,function(e,t){if(".value"===e)o=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!Yo(e)))throw new Error(r+" contains an invalid key ("+e+") "+Gt(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var n;n=e,0<(e=i).parts_.length&&(e.byteLength_+=1),e.parts_.push(n),e.byteLength_+=H(n),Kt(e),rs(r,t,i),t=(e=i).parts_.pop(),e.byteLength_-=H(t),0<e.parts_.length&&--e.byteLength_}),o&&s)throw new Error(r+' contains ".value" child '+Gt(i)+" in addition to actual children.")}},is=function(e,t,n,r){if(!(r&&void 0===n||Ko(n)))throw new Error(B(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},os=function(e,t,n,r){n=n&&n.replace(/^\/*\.info(\/|$)/,"/"),is(e,t,n,r)},ss=function(e,t){if(".info"===Lt(t))throw new Error(e+" failed = Can't modify data under /.info/")},as=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Yo(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&(n=(n=n)&&n.replace(/^\/*\.info(\/|$)/,"/"),!Ko(n)))throw new Error(B(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},us=function(){this.eventLists_=[],this.recursionDepth_=0};function ls(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||Ht(o,n.path)||(e.eventLists_.push(n),n=null),(n=null===n?{events:[],path:o}:n).events.push(i)}n&&e.eventLists_.push(n)}function hs(e,t,n){ls(e,n),ps(e,function(e){return Ht(e,t)})}function cs(e,t,n){ls(e,n),ps(e,function(e){return Qt(e,t)||Qt(t,e)})}function ps(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];i&&(t(i.path)?(function(e){for(var t=0;t<e.events.length;t++){var n,r=e.events[t];null!==r&&(e.events[t]=null,n=r.getEventRunner(),ke&&Ne("event: "+r.toString()),ze(n))}}(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}var ds="repo_interrupt",fs=25,_s=(ys.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},ys);function ys(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new us,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Pr(),this.transactionQueueTree_=new Wo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}function vs(s,e,t){if(s.stats_=at(s.repoInfo_),s.forceRestClient_||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))s.server_=new Er(s.repoInfo_,function(e,t,n,r){ws(s,e,t,n,r)},s.authTokenProvider_,s.appCheckProvider_),setTimeout(function(){return Cs(s,!0)},0);else{if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{O(t)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}s.persistentConnection_=new nn(s.repoInfo_,e,function(e,t,n,r){ws(s,e,t,n,r)},function(e){Cs(s,e)},function(e){var n;n=s,Fe(e,function(e,t){bs(n,e,t)})},s.authTokenProvider_,s.appCheckProvider_,t),s.server_=s.persistentConnection_}s.authTokenProvider_.addTokenChangeListener(function(e){s.server_.refreshAuthToken(e)}),s.appCheckProvider_.addTokenChangeListener(function(e){s.server_.refreshAppCheckToken(e.token)}),s.statsReporter_=(e=s.repoInfo_,t=function(){return new Ar(s.stats_,s.server_)},e=e.toString(),st[e]||(st[e]=t()),st[e]),s.infoData_=new Sr,s.infoSyncTree_=new lo({startListening:function(e,t,n,r){var i=[],o=s.infoData_.getNode(e._path);return o.isEmpty()||(i=fo(s.infoSyncTree_,e._path,o),setTimeout(function(){r("ok")},0)),i},stopListening:function(){}}),bs(s,"connected",!1),s.serverSyncTree_=new lo({startListening:function(n,e,t,r){return s.server_.listen(n,t,e,function(e,t){t=r(e,t);cs(s.eventQueue_,n._path,t)}),[]},stopListening:function(e,t){s.server_.unlisten(e,t)}})}function gs(e){e=e.infoData_.getNode(new Ot(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function ms(e){return Oo({timestamp:gs(e)})}function ws(e,t,n,r,i){e.dataUpdateCount++;var o=new Ot(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var s,a,u,l,h=[],t=o;0<(h=i?r?(s=F(n,function(e){return Yn(e)}),function(e,t,n,r){var i=Eo(e,r);if(i){r=Io(i),i=r.path,r=r.queryId,t=Vt(i,t),n=ii.fromObject(n);return So(e,i,new Hr(qr(r),t,n))}return[]}(e.serverSyncTree_,o,s,i)):(l=Yn(n),s=e.serverSyncTree_,a=o,u=l,null==(i=Eo(s,l=i))?[]:(l=Io(i),i=l.path,l=l.queryId,a=Vt(i,a),So(s,i,new Vr(qr(l),a,u)))):r?(l=F(n,function(e){return Yn(e)}),a=e.serverSyncTree_,u=o,r=l,r=ii.fromObject(l),mo(a,new Hr(Fr(),u,r))):(n=Yn(n),fo(e.serverSyncTree_,o,n))).length&&(t=Ds(e,o)),cs(e.eventQueue_,t,h)}function Cs(e,t){bs(e,"connected",t),!1===t&&function(n){Ns(n,"onDisconnectEvents");var r=ms(n),i=Pr();xr(n.onDisconnect_,At(),function(e,t){t=Mo(e,t,n.serverSyncTree_,r);Nr(i,e,t)});var o=[];xr(i,At(),function(e,t){o=o.concat(fo(n.serverSyncTree_,e,t));e=Fs(n,e);Ds(n,e)}),n.onDisconnect_=Pr(),cs(n.eventQueue_,At(),o)}(e)}function bs(e,t,n){t=new Ot("/.info/"+t),n=Yn(n);e.infoData_.updateSnapshot(t,n);n=fo(e.infoSyncTree_,t,n);cs(e.eventQueue_,t,n)}function Ts(e){return e.nextWriteId_++}function Es(r,i,e,t,o){Ns(r,"set",{path:i.toString(),value:e,priority:t});var n=ms(r),e=Yn(e,t),t=vo(r.serverSyncTree_,i),n=Fo(e,t,n),s=Ts(r),n=ho(r.serverSyncTree_,i,n,s,!0);ls(r.eventQueue_,n),r.server_.put(i.toString(),e.val(!0),function(e,t){var n="ok"===e;n||Oe("set at "+i+" failed: "+e);n=po(r.serverSyncTree_,s,!n);cs(r.eventQueue_,i,n),xs(0,o,e,t)});e=Fs(r,i);Ds(r,e),cs(r.eventQueue_,e,[])}function Is(n,r,i){n.server_.onDisconnectCancel(r.toString(),function(e,t){"ok"===e&&!function e(n,t){if(Bt(t))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;var r=n.value;return n.value=null,r.forEachChild(Rn,function(e,t){Nr(n,new Ot(e),t)}),e(n,t)}if(0<n.children.size)return r=Lt(t),t=Ft(t),n.children.has(r)&&e(n.children.get(r),t)&&n.children.delete(r),0===n.children.size;return!0}(n.onDisconnect_,r),xs(0,i,e,t)})}function Ss(n,r,e,i){var o=Yn(e);n.server_.onDisconnectPut(r.toString(),o.val(!0),function(e,t){"ok"===e&&Nr(n.onDisconnect_,r,o),xs(0,i,e,t)})}function ks(e,t,n){n=".info"===Lt(t._path)?_o(e.infoSyncTree_,t,n):_o(e.serverSyncTree_,t,n);hs(e.eventQueue_,t._path,n)}function Ps(e){e.persistentConnection_&&e.persistentConnection_.interrupt(ds)}function Ns(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),Ne.apply(void 0,s([r],y(t)))}function xs(e,n,r,i){n&&ze(function(){var e,t;"ok"===r?n(null):(t=e=(r||"error").toUpperCase(),i&&(t+=": "+i),(t=new Error(t)).code=e,n(t))})}function Rs(e,t,n){return vo(e.serverSyncTree_,t,n)||Bn.EMPTY_NODE}function Os(t,e){var n;(e=void 0===e?t.transactionQueueTree_:e)||Ms(t,e),Uo(e)?(n=Ls(t,e),g(0<n.length,"Sending zero length transaction queue"),n.every(function(e){return 0===e.status})&&function(i,o,s){for(var e=s.map(function(e){return e.currentWriteId}),t=Rs(i,o,e),n=t,e=t.hash(),r=0;r<s.length;r++){var a=s[r];g(0===a.status,"tryToSendTransactionQueue_: items in queue should all be run."),a.status=1,a.retryCount++;var u=Vt(o,a.path);n=n.updateChild(u,a.currentOutputSnapshotRaw)}var t=n.val(!0),l=o;i.server_.put(l.toString(),t,function(e){Ns(i,"transaction put response",{path:l.toString(),status:e});var t=[];if("ok"===e){for(var n=[],r=0;r<s.length;r++)!function(e){s[e].status=2,t=t.concat(po(i.serverSyncTree_,s[e].currentWriteId)),s[e].onComplete&&n.push(function(){return s[e].onComplete(null,!0,s[e].currentOutputSnapshotResolved)}),s[e].unwatcher()}(r);Ms(i,jo(i.transactionQueueTree_,o)),Os(i,i.transactionQueueTree_),cs(i.eventQueue_,o,t);for(r=0;r<n.length;r++)ze(n[r])}else{if("datastale"===e)for(r=0;r<s.length;r++)3===s[r].status?s[r].status=4:s[r].status=0;else{Oe("transaction at "+l.toString()+" failed: "+e);for(r=0;r<s.length;r++)s[r].status=4,s[r].abortReason=e}Ds(i,o)}},e)}(t,Ho(e),n)):Vo(e)&&zo(e,function(e){Os(t,e)})}function Ds(e,t){var n=As(e,t),t=Ho(n);return function(u,l,h){if(0!==l.length){for(var c=[],p=[],d=l.filter(function(e){return 0===e.status}).map(function(e){return e.currentWriteId}),e=0;e<l.length;e++)!function(e){var t,n,r,i,o=l[e],s=Vt(h,o.path),a=!1;g(null!==s,"rerunTransactionsUnderNode_: relativePath should not be null."),4===o.status?(t=o.abortReason,p=p.concat(po(u.serverSyncTree_,o.currentWriteId,a=!0))):0===o.status&&(p=o.retryCount>=fs?(t="maxretry",p.concat(po(u.serverSyncTree_,o.currentWriteId,a=!0))):(n=Rs(u,o.path,d),o.currentInputSnapshot=n,void 0!==(i=l[e].update(n.val()))?(rs("transaction failed: Data returned ",i,o.path),r=Yn(i),"object"==typeof i&&null!=i&&A(i,".priority")||(r=r.updatePriority(n.getPriority())),s=o.currentWriteId,i=ms(u),i=Fo(r,n,i),o.currentOutputSnapshotRaw=r,o.currentOutputSnapshotResolved=i,o.currentWriteId=Ts(u),d.splice(d.indexOf(s),1),(p=p.concat(ho(u.serverSyncTree_,o.path,i,o.currentWriteId,o.applyLocally))).concat(po(u.serverSyncTree_,s,!0))):(t="nodata",p.concat(po(u.serverSyncTree_,o.currentWriteId,a=!0))))),cs(u.eventQueue_,h,p),p=[],a&&(l[e].status=2,a=l[e].unwatcher,setTimeout(a,Math.floor(0)),l[e].onComplete&&("nodata"===t?c.push(function(){return l[e].onComplete(null,!1,l[e].currentInputSnapshot)}):c.push(function(){return l[e].onComplete(new Error(t),!1,null)})))}(e);Ms(u,u.transactionQueueTree_);for(e=0;e<c.length;e++)ze(c[e]);Os(u,u.transactionQueueTree_)}}(e,Ls(e,n),t),t}function As(e,t){for(var n=e.transactionQueueTree_,r=Lt(t);null!==r&&void 0===Uo(n);)n=jo(n,r),r=Lt(t=Ft(t));return n}function Ls(e,t){var n=[];return function t(n,e,r){var i=Uo(e);if(i)for(var o=0;o<i.length;o++)r.push(i[o]);zo(e,function(e){t(n,e,r)})}(e,t,n),n.sort(function(e,t){return e.order-t.order}),n}function Ms(t,e){var n=Uo(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Bo(e,0<n.length?n:void 0)}zo(e,function(e){Ms(t,e)})}function Fs(t,e){var n=Ho(As(t,e)),e=jo(t.transactionQueueTree_,e);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return;r=r.parent}}(e,function(e){qs(t,e)}),qs(t,e),function t(e,n,r,i){r&&!i&&n(e),zo(e,function(e){t(e,n,!0,i)}),r&&i&&n(e)}(e,function(e){qs(t,e)}),n}function qs(e,t){var n=Uo(t);if(n){for(var r=[],i=[],o=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?(g(o===s-1,"All SENT items should be at beginning of queue."),n[o=s].status=3,n[s].abortReason="set"):(g(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(po(e.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Bo(t,void 0):n.length=o+1,cs(e.eventQueue_,Ho(t),i);for(s=0;s<r.length;s++)ze(r[s])}}var Ws=function(e,t){var n=js(e),r=n.namespace;"firebase.com"===n.domain&&Re(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Re("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Oe("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");e="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new et(n.host,n.secure,r,t,e,"",r!==n.subdomain),path:new Ot(n.pathString)}},js=function(e){var t,n,r,i="",o="",s="",a="",u="",l=!0,h="https",c=443;return"string"==typeof e&&(0<=(r=e.indexOf("//"))&&(h=e.substring(0,r-1),e=e.substring(r+2)),-1===(t=e.indexOf("/"))&&(t=e.length),-1===(n=e.indexOf("?"))&&(n=e.length),i=e.substring(0,Math.min(t,n)),t<n&&(a=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(0<n[r].length){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(t,n))),n=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=_(e.split("&")),o=i.next();!o.done;o=i.next()){var s,a=o.value;0!==a.length&&(2===(s=a.split("=")).length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Oe("Invalid query segment '"+a+"' in query '"+e+"'"))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,n))),0<=(r=i.indexOf(":"))?(l="https"===h||"wss"===h,c=parseInt(i.substring(r+1),10)):r=i.length,"localhost"===(r=i.slice(0,r)).toLowerCase()?o="localhost":r.split(".").length<=2?o=r:(r=i.indexOf("."),s=i.substring(0,r).toLowerCase(),o=i.substring(r+1),u=s),"ns"in n&&(u=n.ns)),{host:i,port:c,domain:o,subdomain:s,secure:l,scheme:h,pathString:a,namespace:u}},Us=(Bs.prototype.getPath=function(){var e=this.snapshot.ref;return("value"===this.eventType?e:e.parent)._path},Bs.prototype.getEventType=function(){return this.eventType},Bs.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},Bs.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+O(this.snapshot.exportVal())},Bs);function Bs(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}var Vs=(zs.prototype.getPath=function(){return this.path},zs.prototype.getEventType=function(){return"cancel"},zs.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},zs.prototype.toString=function(){return this.path.toString()+":cancel"},zs);function zs(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}var Hs=(Qs.prototype.onValue=function(e,t){this.snapshotCallback.call(null,e,t)},Qs.prototype.onCancel=function(e){return g(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(Qs.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),Qs.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},Qs);function Qs(e,t){this.snapshotCallback=e,this.cancelCallback=t}var Ys=(Ks.prototype.cancel=function(){var e=new w;return Is(this._repo,this._path,e.wrapCallback(function(){})),e.promise},Ks.prototype.remove=function(){ss("OnDisconnect.remove",this._path);var e=new w;return Ss(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise},Ks.prototype.set=function(e){ss("OnDisconnect.set",this._path),ns("OnDisconnect.set",e,this._path,!1);var t=new w;return Ss(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise},Ks.prototype.setWithPriority=function(e,t){ss("OnDisconnect.setWithPriority",this._path),ns("OnDisconnect.setWithPriority",e,this._path,!1),$o("OnDisconnect.setWithPriority",t,!1);var n,r,i,o,s=new w;return n=this._repo,r=this._path,e=e,t=t,i=s.wrapCallback(function(){}),o=Yn(e,t),n.server_.onDisconnectPut(r.toString(),o.val(!0),function(e,t){"ok"===e&&Nr(n.onDisconnect_,r,o),xs(0,i,e,t)}),s.promise},Ks.prototype.update=function(e){ss("OnDisconnect.update",this._path),Go("OnDisconnect.update",e,this._path,!1);var t=new w;return function(n,r,i,o){if(M(i))return Ne("onDisconnect().update() called with empty data.  Don't do anything."),xs(0,o,"ok",void 0);n.server_.onDisconnectMerge(r.toString(),i,function(e,t){"ok"===e&&Fe(i,function(e,t){t=Yn(t);Nr(n.onDisconnect_,Ut(r,e),t)}),xs(0,o,e,t)})}(this._repo,this._path,e,t.wrapCallback(function(){})),t.promise},Ks);function Ks(e,t){this._repo=e,this._path=t}var Gs=(Object.defineProperty($s.prototype,"key",{get:function(){return Bt(this._path)?null:qt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"ref",{get:function(){return new ta(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"_queryIdentifier",{get:function(){var e=br(this._queryParams),e=Me(e);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"_queryObject",{get:function(){return br(this._queryParams)},enumerable:!1,configurable:!0}),$s.prototype.isEqual=function(e){if(!((e=Q(e))instanceof $s))return!1;var t=this._repo===e._repo,n=Ht(this._path,e._path),e=this._queryIdentifier===e._queryIdentifier;return t&&n&&e},$s.prototype.toJSON=function(){return this.toString()},$s.prototype.toString=function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)},$s);function $s(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}function Js(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Xs(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===cn){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==De)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Ae)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Rn){if(null!=t&&!ts(t)||null!=n&&!ts(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(g(e.getIndex()instanceof $n||e.getIndex()===rr,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Zs(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var ea,ta=(n(na,ea=Gs),Object.defineProperty(na.prototype,"parent",{get:function(){var e=jt(this._path);return null===e?null:new na(this._repo,e)},enumerable:!1,configurable:!0}),Object.defineProperty(na.prototype,"root",{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e},enumerable:!1,configurable:!0}),na);function na(e,t){return ea.call(this,e,t,new yr,!1)||this}var ra=(Object.defineProperty(ia.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(ia.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(ia.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),ia.prototype.child=function(e){var t=new Ot(e),e=aa(this.ref,e);return new ia(this._node.getChild(t),e,Rn)},ia.prototype.exists=function(){return!this._node.isEmpty()},ia.prototype.exportVal=function(){return this._node.val(!0)},ia.prototype.forEach=function(n){var r=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,function(e,t){return n(new ia(t,aa(r.ref,e),Rn))})},ia.prototype.hasChild=function(e){e=new Ot(e);return!this._node.getChild(e).isEmpty()},ia.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},ia.prototype.toJSON=function(){return this.exportVal()},ia.prototype.val=function(){return this._node.val()},ia);function ia(e,t,n){this._node=e,this.ref=t,this._index=n}function oa(e,t){return(e=Q(e))._checkNotDeleted("ref"),void 0!==t?aa(e._root,t):e._root}function sa(e,t){(e=Q(e))._checkNotDeleted("refFromURL");var n=Ws(t,e._repo.repoInfo_.nodeAdmin);as("refFromURL",n);t=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||t.host===e._repo.repoInfo_.host||Re("refFromURL: Host name does not match the current database: (found "+t.host+" but expected "+e._repo.repoInfo_.host+")"),oa(e,n.path.toString())}function aa(e,t){return(null===Lt((e=Q(e))._path)?os:is)("child","path",t,!1),new ta(e._repo,Ut(e._path,t))}function ua(e,t){e=Q(e),ss("set",e._path),ns("set",t,e._path,!1);var n=new w;return Es(e._repo,e._path,t,null,n.wrapCallback(function(){})),n.promise}function la(e,t){Go("update",t,e._path,!1);var n=new w;return function(i,o,e,s){Ns(i,"update",{path:o.toString(),value:e});var a,t,n=!0,r=ms(i),u={};Fe(e,function(e,t){n=!1,u[e]=Mo(Ut(o,e),Yn(t),i.serverSyncTree_,r)}),n?(Ne("update() called with empty data.  Don't do anything."),xs(0,s,"ok",void 0)):(a=Ts(i),t=co(i.serverSyncTree_,o,u,a),ls(i.eventQueue_,t),i.server_.merge(o.toString(),e,function(e,t){var n="ok"===e;n||Oe("update at "+o+" failed: "+e);var r=po(i.serverSyncTree_,a,!n),n=0<r.length?Ds(i,o):o;cs(i.eventQueue_,n,r),xs(0,s,e,t)}),Fe(e,function(e){e=Fs(i,Ut(o,e));Ds(i,e)}),cs(i.eventQueue_,o,[]))}(e._repo,e._path,t,n.wrapCallback(function(){})),n.promise}function ha(t){return t=Q(t),n=t._repo,r=t,(null!=(e=go(n.serverSyncTree_,r))?Promise.resolve(e):n.server_.get(r).then(function(e){var t=Yn(e).withIndex(r._queryParams.getIndex()),e=fo(n.serverSyncTree_,r._path,t);return hs(n.eventQueue_,r._path,e),Promise.resolve(t)},function(e){return Ns(n,"get for query "+O(r)+" failed: "+e),Promise.reject(new Error(e))})).then(function(e){return new ra(e,new ta(t._repo,t._path),t._queryParams.getIndex())});var n,r,e}var ca=(pa.prototype.respondsTo=function(e){return"value"===e},pa.prototype.createEvent=function(e,t){var n=t._queryParams.getIndex();return new Us("value",this,new ra(e.snapshotNode,new ta(t._repo,t._path),n))},pa.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}},pa.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new Vs(this,e,t):null},pa.prototype.matches=function(e){return e instanceof pa&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},pa.prototype.hasAnyCallback=function(){return null!==this.callbackContext},pa);function pa(e){this.callbackContext=e}var da=(fa.prototype.respondsTo=function(e){e="children_added"===e?"child_added":e;return this.eventType===(e="children_removed"===e?"child_removed":e)},fa.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new Vs(this,e,t):null},fa.prototype.createEvent=function(e,t){g(null!=e.childName,"Child events should have a childName.");var n=aa(new ta(t._repo,t._path),e.childName),t=t._queryParams.getIndex();return new Us(e.type,this,new ra(e.snapshotNode,n,t),e.prevName)},fa.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}},fa.prototype.matches=function(e){return e instanceof fa&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))},fa.prototype.hasAnyCallback=function(){return!!this.callbackContext},fa);function fa(e,t){this.eventType=e,this.callbackContext=t}function _a(n,e,t,r,i){var o;"object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce&&((i=function(e,t){ks(n._repo,n,a),o(e,t)}).userCallback=(o=t).userCallback,i.context=t.context,t=i);var s,t=new Hs(t,s||void 0),a="value"===e?new ca(t):new da(e,t);return s=n._repo,e=a,e=".info"===Lt((t=n)._path)?yo(s.infoSyncTree_,t,e):yo(s.serverSyncTree_,t,e),hs(s.eventQueue_,t._path,e),function(){return ks(n._repo,n,a)}}function ya(e,t,n,r){return _a(e,"value",t,n,r)}function va(e,t,n,r){return _a(e,"child_added",t,n,r)}function ga(e,t,n,r){return _a(e,"child_changed",t,n,r)}function ma(e,t,n,r){return _a(e,"child_moved",t,n,r)}function wa(e,t,n,r){return _a(e,"child_removed",t,n,r)}function Ca(e,t,n){var r=null,n=n?new Hs(n):null;"value"===t?r=new ca(n):t&&(r=new da(t,n)),ks(e._repo,e,r)}var ba,Tt=function(){},Ta=(n(Ea,ba=Tt),Ea.prototype._apply=function(e){ns("endAt",this._value,e._path,!0);var t=mr(e._queryParams,this._value,this._key);if(Zs(t),Xs(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gs(e._repo,e._path,t,e._orderByCalled)},Ea);function Ea(e,t){var n=ba.call(this)||this;return n._value=e,n._key=t,n}var Ia,Sa=(n(ka,Ia=Tt),ka.prototype._apply=function(e){ns("endBefore",this._value,e._path,!1);var t,n,r,r=(t=e._queryParams,n=this._value,r=this._key,(r=t.index_===cn?mr(t,n="string"==typeof n?er(n):n,r):mr(t,n,null==r?De:er(r))).endBeforeSet_=!0,r);if(Zs(r),Xs(r),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gs(e._repo,e._path,r,e._orderByCalled)},ka);function ka(e,t){var n=Ia.call(this)||this;return n._value=e,n._key=t,n}var Pa,Na=(n(xa,Pa=Tt),xa.prototype._apply=function(e){ns("startAt",this._value,e._path,!0);var t=gr(e._queryParams,this._value,this._key);if(Zs(t),Xs(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Gs(e._repo,e._path,t,e._orderByCalled)},xa);function xa(e,t){var n=Pa.call(this)||this;return n._value=e,n._key=t,n}var Ra,Oa=(n(Da,Ra=Tt),Da.prototype._apply=function(e){ns("startAfter",this._value,e._path,!1);var t,n,r,r=(t=e._queryParams,n=this._value,r=this._key,(r=t.index_===cn?gr(t,n="string"==typeof n?Zn(n):n,r):gr(t,n,null==r?Ae:Zn(r))).startAfterSet_=!0,r);if(Zs(r),Xs(r),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Gs(e._repo,e._path,r,e._orderByCalled)},Da);function Da(e,t){var n=Ra.call(this)||this;return n._value=e,n._key=t,n}var Aa,La=(n(Ma,Aa=Tt),Ma.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gs(e._repo,e._path,(t=e._queryParams,n=this._limit,(t=t.copy()).limitSet_=!0,t.limit_=n,t.viewFrom_="l",t),e._orderByCalled);var t,n},Ma);function Ma(e){var t=Aa.call(this)||this;return t._limit=e,t}var Fa,qa=(n(Wa,Fa=Tt),Wa.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gs(e._repo,e._path,(t=e._queryParams,n=this._limit,(t=t.copy()).limitSet_=!0,t.limit_=n,t.viewFrom_="r",t),e._orderByCalled);var t,n},Wa);function Wa(e){var t=Fa.call(this)||this;return t._limit=e,t}var ja,Ua=(n(Ba,ja=Tt),Ba.prototype._apply=function(e){Js(e,"orderByChild");var t=new Ot(this._path);if(Bt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");t=new $n(t),t=wr(e._queryParams,t);return Xs(t),new Gs(e._repo,e._path,t,!0)},Ba);function Ba(e){var t=ja.call(this)||this;return t._path=e,t}var Va,za=(n(Ha,Va=Tt),Ha.prototype._apply=function(e){Js(e,"orderByKey");var t=wr(e._queryParams,cn);return Xs(t),new Gs(e._repo,e._path,t,!0)},Ha);function Ha(){return null!==Va&&Va.apply(this,arguments)||this}var Qa,Ya=(n(Ka,Qa=Tt),Ka.prototype._apply=function(e){Js(e,"orderByPriority");var t=wr(e._queryParams,Rn);return Xs(t),new Gs(e._repo,e._path,t,!0)},Ka);function Ka(){return null!==Qa&&Qa.apply(this,arguments)||this}var Ga,$a=(n(Ja,Ga=Tt),Ja.prototype._apply=function(e){Js(e,"orderByValue");var t=wr(e._queryParams,rr);return Xs(t),new Gs(e._repo,e._path,t,!0)},Ja);function Ja(){return null!==Ga&&Ga.apply(this,arguments)||this}var Xa,Za,eu,tu=(n(nu,Xa=Tt),nu.prototype._apply=function(e){if(ns("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Ta(this._value,this._key)._apply(new Na(this._value,this._key)._apply(e))},nu);function nu(e,t){var n=Xa.call(this)||this;return n._value=e,n._key=t,n}function ru(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=Q(e);try{for(var s=_(r),a=s.next();!a.done;a=s.next())o=a.value._apply(o)}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o}Za=ta,g(!Vi,"__referenceConstructor has already been defined"),Vi=Za,eu=ta,g(!$i,"__referenceConstructor has already been defined"),$i=eu;var iu="FIREBASE_DATABASE_EMULATOR_HOST",ou={},su=!1;function au(e,t,n,r,i){var o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||Re("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ne("Using default host for project ",e.options.projectId),o=e.options.projectId+"-default-rtdb.firebaseio.com");var s,a=Ws(o,i),u=a.repoInfo,r=void 0;(r="undefined"!=typeof process?process.env[iu]:r)?(s=!0,o="http://"+r+"?ns="+u.namespace,u=(a=Ws(o,i)).repoInfo):s=!a.repoInfo.secure;t=i&&s?new Ge(Ge.OWNER):new Ye(e.name,e.options,t);as("Invalid Firebase Database URL",a),Bt(a.path)||Re("Database URL must point to the root of a Firebase Database (not including a child path).");n=function(e,t,n,r){var i=ou[t.name];i||(i={},ou[t.name]=i);(t=i[e.toURLString()])&&Re("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return t=new _s(e,su,n,r),i[e.toURLString()]=t}(u,e,t,new He(e.name,n));return new uu(n,e)}var uu=(Object.defineProperty(lu.prototype,"_repo",{get:function(){return this._instanceStarted||(vs(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(lu.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new ta(this._repo,At())),this._rootInternal},enumerable:!1,configurable:!0}),lu.prototype._delete=function(){var e,t,n;return null!==this._rootInternal&&(e=this._repo,t=this.app.name,(n=ou[t])&&n[e.key]===e||Re("Database "+t+"("+e.repoInfo_+") has already been deleted."),Ps(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()},lu.prototype._checkNotDeleted=function(e){null===this._rootInternal&&Re("Cannot call "+e+" on a deleted database.")},lu);function lu(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}function hu(e,t,n,r){void 0===r&&(r={}),(e=Q(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Re("Cannot call useEmulator() after instance has already been initialized.");var i=e._repoInternal,o=void 0;i.repoInfo_.nodeAdmin?(r.mockUserToken&&Re('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Ge(Ge.OWNER)):r.mockUserToken&&(e="string"==typeof r.mockUserToken?r.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0;if(!(t=e.sub||e.user_id))throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");return e=l({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:t,user_id:t,firebase:{sign_in_provider:"custom",identities:{}}},e),[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(e)),""].join(".")}(r.mockUserToken,e.app.options.projectId),o=new Ge(e)),o=o,(i=i).repoInfo_=new et(t+":"+n,!1,i.repoInfo_.namespace,i.repoInfo_.webSocketOnly,i.repoInfo_.nodeAdmin,i.repoInfo_.persistenceKey,i.repoInfo_.includeNamespaceInQueryParams),o&&(i.authTokenProvider_=o)}function cu(e){(e=Q(e))._checkNotDeleted("goOnline"),(e=e._repo).persistentConnection_&&e.persistentConnection_.resume(ds)}var pu={".sv":"timestamp"};var du=(fu.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},fu);function fu(e,t){this.committed=e,this.snapshot=t}function _u(i,e,t){if(i=Q(i),ss("Reference.transaction",i._path),".length"===i.key||".keys"===i.key)throw"Reference.transaction failed: "+i.key+" is a read-only object.";var t=null===(n=null==t?void 0:t.applyLocally)||void 0===n||n,o=new w,n=ya(i,function(){});return function(e,t,n,r,i,o){Ns(e,"transaction on "+t);var s={path:t,update:n,onComplete:r,status:null,order:Ie(),applyLocally:o,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},n=Rs(e,t,void 0);s.currentInputSnapshot=n,void 0===(r=s.update(n.val()))?(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot)):(rs("transaction failed: Data returned ",r,s.path),s.status=0,(i=Uo(o=jo(e.transactionQueueTree_,t))||[]).push(s),Bo(o,i),o=void 0,"object"==typeof r&&null!==r&&A(r,".priority")?(o=L(r,".priority"),g(ts(o),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):o=(vo(e.serverSyncTree_,t)||Bn.EMPTY_NODE).getPriority().val(),i=ms(e),o=Yn(r,o),i=Fo(o,n,i),s.currentOutputSnapshotRaw=o,s.currentOutputSnapshotResolved=i,s.currentWriteId=Ts(e),s=ho(e.serverSyncTree_,t,i,s.currentWriteId,s.applyLocally),cs(e.eventQueue_,t,s),Os(e,e.transactionQueueTree_))}(i._repo,i._path,e,function(e,t,n){var r;e?o.reject(e):(r=new ra(n,new ta(i._repo,i._path),Rn),o.resolve(new du(t,r)))},n,t),o.promise}var yu=(vu.prototype.cancel=function(t){U("OnDisconnect.cancel",0,1,arguments.length),V("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},vu.prototype.remove=function(t){U("OnDisconnect.remove",0,1,arguments.length),V("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},vu.prototype.set=function(e,t){U("OnDisconnect.set",1,2,arguments.length),V("OnDisconnect.set","onComplete",t,!0);e=this._delegate.set(e);return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},vu.prototype.setWithPriority=function(e,t,n){U("OnDisconnect.setWithPriority",2,3,arguments.length),V("OnDisconnect.setWithPriority","onComplete",n,!0);t=this._delegate.setWithPriority(e,t);return n&&t.then(function(){return n(null)},function(e){return n(e)}),t},vu.prototype.update=function(e,t){if(U("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Oe("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}V("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then(function(){return t(null)},function(e){return t(e)}),i},vu);function vu(e){this._delegate=e}var gu=(mu.prototype.toJSON=function(){return U("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},mu);function mu(e,t){this.committed=e,this.snapshot=t}var wu=(Cu.prototype.val=function(){return U("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},Cu.prototype.exportVal=function(){return U("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},Cu.prototype.toJSON=function(){return U("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},Cu.prototype.exists=function(){return U("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},Cu.prototype.child=function(e){return U("DataSnapshot.child",0,1,arguments.length),e=String(e),is("DataSnapshot.child","path",e,!1),new Cu(this._database,this._delegate.child(e))},Cu.prototype.hasChild=function(e){return U("DataSnapshot.hasChild",1,1,arguments.length),is("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)},Cu.prototype.getPriority=function(){return U("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},Cu.prototype.forEach=function(t){var n=this;return U("DataSnapshot.forEach",1,1,arguments.length),V("DataSnapshot.forEach","action",t,!1),this._delegate.forEach(function(e){return t(new Cu(n._database,e))})},Cu.prototype.hasChildren=function(){return U("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(Cu.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),Cu.prototype.numChildren=function(){return U("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},Cu.prototype.getRef=function(){return U("DataSnapshot.ref",0,0,arguments.length),new Iu(this._database,this._delegate.ref)},Object.defineProperty(Cu.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),Cu);function Cu(e,t){this._database=e,this._delegate=t}var bu=(Tu.prototype.on=function(e,n,t,r){var i=this;U("Query.on",2,4,arguments.length),V("Query.on","callback",n,!1);function o(e,t){n.call(s.context,new wu(i.database,e),t)}var s=Tu.getCancelAndContextArgs_("Query.on",t,r);o.userCallback=n,o.context=s.context;var a=null===(r=s.cancel)||void 0===r?void 0:r.bind(s.context);switch(e){case"value":return ya(this._delegate,o,a),n;case"child_added":return va(this._delegate,o,a),n;case"child_removed":return wa(this._delegate,o,a),n;case"child_changed":return ga(this._delegate,o,a),n;case"child_moved":return ma(this._delegate,o,a),n;default:throw new Error(B("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Tu.prototype.off=function(e,t,n){var r;U("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(B(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),V("Query.off","callback",t,!0),z("Query.off","context",n,!0),t?((r=function(){}).userCallback=t,r.context=n,Ca(this._delegate,e,r)):Ca(this._delegate,e)},Tu.prototype.get=function(){var t=this;return ha(this._delegate).then(function(e){return new wu(t.database,e)})},Tu.prototype.once=function(e,n,t,r){var i=this;U("Query.once",1,4,arguments.length),V("Query.once","callback",n,!0);function o(e,t){e=new wu(i.database,e),n&&n.call(s.context,e,t),a.resolve(e)}var s=Tu.getCancelAndContextArgs_("Query.once",t,r),a=new w;o.userCallback=n,o.context=s.context;function u(e){s.cancel&&s.cancel.call(s.context,e),a.reject(e)}switch(e){case"value":ya(this._delegate,o,u,{onlyOnce:!0});break;case"child_added":va(this._delegate,o,u,{onlyOnce:!0});break;case"child_removed":wa(this._delegate,o,u,{onlyOnce:!0});break;case"child_changed":ga(this._delegate,o,u,{onlyOnce:!0});break;case"child_moved":ma(this._delegate,o,u,{onlyOnce:!0});break;default:throw new Error(B("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return a.promise},Tu.prototype.limitToFirst=function(e){return U("Query.limitToFirst",1,1,arguments.length),new Tu(this.database,ru(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new La(e)}(e)))},Tu.prototype.limitToLast=function(e){return U("Query.limitToLast",1,1,arguments.length),new Tu(this.database,ru(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new qa(e)}(e)))},Tu.prototype.orderByChild=function(e){return U("Query.orderByChild",1,1,arguments.length),new Tu(this.database,ru(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return is("orderByChild","path",e,!1),new Ua(e)}(e)))},Tu.prototype.orderByKey=function(){return U("Query.orderByKey",0,0,arguments.length),new Tu(this.database,ru(this._delegate,new za))},Tu.prototype.orderByPriority=function(){return U("Query.orderByPriority",0,0,arguments.length),new Tu(this.database,ru(this._delegate,new Ya))},Tu.prototype.orderByValue=function(){return U("Query.orderByValue",0,0,arguments.length),new Tu(this.database,ru(this._delegate,new $a))},Tu.prototype.startAt=function(e,t){return void 0===e&&(e=null),U("Query.startAt",0,2,arguments.length),new Tu(this.database,ru(this._delegate,(void 0===(e=e)&&(e=null),Jo("startAt","key",t=t,!0),new Na(e,t))))},Tu.prototype.startAfter=function(e,t){return void 0===e&&(e=null),U("Query.startAfter",0,2,arguments.length),new Tu(this.database,ru(this._delegate,(e=e,Jo("startAfter","key",t=t,!0),new Oa(e,t))))},Tu.prototype.endAt=function(e,t){return void 0===e&&(e=null),U("Query.endAt",0,2,arguments.length),new Tu(this.database,ru(this._delegate,(e=e,Jo("endAt","key",t=t,!0),new Ta(e,t))))},Tu.prototype.endBefore=function(e,t){return void 0===e&&(e=null),U("Query.endBefore",0,2,arguments.length),new Tu(this.database,ru(this._delegate,(e=e,Jo("endBefore","key",t=t,!0),new Sa(e,t))))},Tu.prototype.equalTo=function(e,t){return U("Query.equalTo",1,2,arguments.length),new Tu(this.database,ru(this._delegate,(e=e,Jo("equalTo","key",t=t,!0),new tu(e,t))))},Tu.prototype.toString=function(){return U("Query.toString",0,0,arguments.length),this._delegate.toString()},Tu.prototype.toJSON=function(){return U("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},Tu.prototype.isEqual=function(e){if(U("Query.isEqual",1,1,arguments.length),e instanceof Tu)return this._delegate.isEqual(e._delegate);throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")},Tu.getCancelAndContextArgs_=function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,V(e,"cancel",r.cancel,!0),r.context=n,z(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(B(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(Tu.prototype,"ref",{get:function(){return new Iu(this.database,new ta(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),Tu);function Tu(e,t){this.database=e,this._delegate=t}var Eu,Iu=(n(Su,Eu=bu),Su.prototype.getKey=function(){return U("Reference.key",0,0,arguments.length),this._delegate.key},Su.prototype.child=function(e){return U("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Su(this.database,aa(this._delegate,e))},Su.prototype.getParent=function(){U("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new Su(this.database,e):null},Su.prototype.getRoot=function(){return U("Reference.root",0,0,arguments.length),new Su(this.database,this._delegate.root)},Su.prototype.set=function(e,t){U("Reference.set",1,2,arguments.length),V("Reference.set","onComplete",t,!0);e=ua(this._delegate,e);return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},Su.prototype.update=function(e,t){if(U("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,Oe("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ss("Reference.update",this._delegate._path),V("Reference.update","onComplete",t,!0);var i=la(this._delegate,e);return t&&i.then(function(){return t(null)},function(e){return t(e)}),i},Su.prototype.setWithPriority=function(e,t,n){U("Reference.setWithPriority",2,3,arguments.length),V("Reference.setWithPriority","onComplete",n,!0);t=function(e,t,n){if(ss("setWithPriority",e._path),ns("setWithPriority",t,e._path,!1),$o("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new w;return Es(e._repo,e._path,t,n,r.wrapCallback(function(){})),r.promise}(this._delegate,e,t);return n&&t.then(function(){return n(null)},function(e){return n(e)}),t},Su.prototype.remove=function(t){U("Reference.remove",0,1,arguments.length),V("Reference.remove","onComplete",t,!0);var e,e=(e=this._delegate,ss("remove",e._path),ua(e,null));return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},Su.prototype.transaction=function(e,t,n){var r=this;U("Reference.transaction",1,3,arguments.length),V("Reference.transaction","transactionUpdate",e,!1),V("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(B(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);n=_u(this._delegate,e,{applyLocally:n}).then(function(e){return new gu(e.committed,new wu(r.database,e.snapshot))});return t&&n.then(function(e){return t(null,e.committed,e.snapshot)},function(e){return t(e,!1,null)}),n},Su.prototype.setPriority=function(e,t){U("Reference.setPriority",1,2,arguments.length),V("Reference.setPriority","onComplete",t,!0);e=function(e,t){e=Q(e),ss("setPriority",e._path),$o("setPriority",t,!1);var n=new w;return Es(e._repo,Ut(e._path,".priority"),t,null,n.wrapCallback(function(){})),n.promise}(this._delegate,e);return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},Su.prototype.push=function(e,t){var n=this;U("Reference.push",0,2,arguments.length),V("Reference.push","onComplete",t,!0);var r=function(e,t){e=Q(e),ss("push",e._path),ns("push",t,e._path,!0);var n=gs(e._repo),r=or(n),n=aa(e,r),i=aa(e,r),t=null!=t?ua(i,t).then(function(){return i}):Promise.resolve(i);return n.then=t.then.bind(t),n.catch=t.then.bind(t,void 0),n}(this._delegate,e),e=r.then(function(e){return new Su(n.database,e)});t&&e.then(function(){return t(null)},function(e){return t(e)});r=new Su(this.database,r);return r.then=e.then.bind(e),r.catch=e.catch.bind(e,void 0),r},Su.prototype.onDisconnect=function(){return ss("Reference.onDisconnect",this._delegate._path),new yu(new Ys(this._delegate._repo,this._delegate._path))},Object.defineProperty(Su.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(Su.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),Su);function Su(e,t){var n=Eu.call(this,e,new Gs(t._repo,t._path,new yr,!1))||this;return n.database=e,n._delegate=t,n}var ku=(Pu.prototype.useEmulator=function(e,t,n){hu(this._delegate,e,t,n=void 0===n?{}:n)},Pu.prototype.ref=function(e){if(U("database.ref",0,1,arguments.length),e instanceof Iu){var t=sa(this._delegate,e.toString());return new Iu(this,t)}t=oa(this._delegate,e);return new Iu(this,t)},Pu.prototype.refFromURL=function(e){U("database.refFromURL",1,1,arguments.length);e=sa(this._delegate,e);return new Iu(this,e)},Pu.prototype.goOffline=function(){var e;U("database.goOffline",0,0,arguments.length),(e=Q(e=this._delegate))._checkNotDeleted("goOffline"),Ps(e._repo)},Pu.prototype.goOnline=function(){return U("database.goOnline",0,0,arguments.length),cu(this._delegate)},Pu.ServerValue={TIMESTAMP:pu,increment:function(e){return{".sv":{increment:e}}}},Pu);function Pu(e,t){var n=this;this._delegate=e,this.app=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}var Nu=Object.freeze({__proto__:null,forceLongPolling:function(){vt.forceDisallow(),pt.forceAllow()},forceWebSockets:function(){pt.forceDisallow()},isWebSocketsAvailable:function(){return vt.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){var i;e=e._delegate._repo,void 0===(t=t)&&(t=!1),"undefined"!=typeof console&&(e=t?(e.statsListener_||(e.statsListener_=new Rr(e.stats_)),e.statsListener_.get()):e.stats_.get(),i=Object.keys(e).reduce(function(e,t){return Math.max(t.length,e)},0),Fe(e,function(e,t){for(var n=e,r=e.length;r<i+2;r++)n+=" ";console.log(n+t)}))},statsIncrementCounter:function(e,t){e=e._delegate._repo,t=t,e.stats_.incrementCounter(t),e.statsReporter_.statsToReport_[t]=!0},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){e._delegate._repo.interceptServerDataCallback_=t},initStandalone:function(e){var t=e.app,n=e.url,r=e.version,i=e.customAuthImpl,o=e.namespace,e=void 0!==(e=e.nodeAdmin)&&e;return ue(r),(r=new $("auth-internal",new Z("database-standalone"))).setComponent(new Y("auth-internal",function(){return i},"PRIVATE")),{instance:new ku(au(t,r,void 0,n,e),t),namespace:o}}}),Tt=nn;nn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},nn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var xu,Ru=Object.freeze({__proto__:null,DataConnection:Tt,RealTimeConnection:Ct,hijackHash:function(i){var o=nn.prototype.put;return nn.prototype.put=function(e,t,n,r){void 0!==r&&(r=i()),o.call(this,e,t,n,r)},function(){nn.prototype.put=o}},ConnectionTarget:et,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){su=e}}),Ou=ku.ServerValue;ue((xu=t.default).SDK_VERSION),xu.INTERNAL.registerComponent(new Y("database",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),t=e.getProvider("auth-internal"),e=e.getProvider("app-check-internal");return new ku(au(r,t,e,n),r)},"PUBLIC").setServiceProps({Reference:Iu,Query:bu,Database:ku,DataSnapshot:wu,enableLogging:fe,INTERNAL:Nu,ServerValue:Ou,TEST_ACCESS:Ru}).setMultipleInstances(!0)),xu.registerVersion("@firebase/database","0.11.0")}.apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-database.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-database.js.map
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(e){"use strict";try{!function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var Zl=t(e);!function(){var t,o="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var u=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function c(t){var e,n,i="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return i?i.call(t):{next:(e=t,n=0,function(){return n<e.length?{done:!1,value:e[n++]}:{done:!0}})}}!function(t,e){if(e){var n=u;t=t.split(".");for(var i=0;i<t.length-1;i++){var r=t[i];r in n||(n[r]={}),n=n[r]}(e=e(i=n[t=t[t.length-1]]))!=i&&null!=e&&o(n,t,{configurable:!0,writable:!0,value:e})}}("Promise",function(t){function a(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function e(){this.a=null}function s(e){return e instanceof a?e:new a(function(t){t(e)})}if(t)return t;e.prototype.b=function(t){var e;null==this.a&&(this.a=[],(e=this).c(function(){e.g()})),this.a.push(t)};var n=u.setTimeout;e.prototype.c=function(t){n(t,0)},e.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},e.prototype.f=function(t){this.c(function(){throw t})},a.prototype.f=function(){function t(e){return function(t){i||(i=!0,e.call(n,t))}}var n=this,i=!1;return{resolve:t(this.m),reject:t(this.g)}},a.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof a)this.s(t);else{t:switch(typeof t){case"object":var e=null!=t;break t;case"function":e=!0;break t;default:e=!1}e?this.v(t):this.h(t)}},a.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},a.prototype.g=function(t){this.i(2,t)},a.prototype.h=function(t){this.i(1,t)},a.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},a.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)r.b(this.a[t]);this.a=null}};var r=new e;return a.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},a.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},a.prototype.then=function(t,e){function n(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(t){r(t)}}:t}var i,r,o=new a(function(t,e){i=t,r=e});return this.Ra(n(t,i),n(e,r)),o},a.prototype.catch=function(t){return this.then(void 0,t)},a.prototype.Ra=function(t,e){function n(){switch(i.b){case 1:t(i.c);break;case 2:e(i.c);break;default:throw Error("Unexpected state: "+i.b)}}var i=this;null==this.a?r.b(n):this.a.push(n)},a.resolve=s,a.reject=function(n){return new a(function(t,e){e(n)})},a.race=function(r){return new a(function(t,e){for(var n=c(r),i=n.next();!i.done;i=n.next())s(i.value).Ra(t,e)})},a.all=function(t){var e=c(t),o=e.next();return o.done?s([]):new a(function(n,t){for(var i=[],r=0;i.push(void 0),r++,s(o.value).Ra(function(e){return function(t){i[e]=t,0==--r&&n(i)}}(i.length-1),t),!(o=e.next()).done;);})},a});var h=h||{},l=this||self,e=/^[\w+/_-]+[=]{0,2}$/,s=null;function f(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&e.test(t)?t:""}function a(){}function d(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==d(t)}function m(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var n="closure_uid_"+(1e9*Math.random()>>>0),i=0;function r(t,e,n){return t.call.apply(t.bind,arguments)}function g(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?r:g).apply(null,arguments)}function y(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function w(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function I(t){return t}function T(t,e,n){this.code=k+t,this.message=e||S[t]||"",this.a=n||null}function E(t){var e=t&&t.code;return e?new T(e.substring(k.length),t.message,t.serverResponse):null}w(T,Error),T.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},T.prototype.toJSON=function(){return this.w()};var A,k="auth/",S={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},N={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function _(t){for(var e in N)if(N[e].id===t)return t=N[e],{firebaseEndpoint:t.Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function O(t){if(t)try{return t.$goog_Thenable}catch(t){return}}function C(t){var e;Error.captureStackTrace?Error.captureStackTrace(this,C):(e=Error().stack)&&(this.stack=e),t&&(this.message=String(t))}function R(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");C.call(this,n+t[i])}function D(t){throw new R("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function P(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function L(t,e){t.f(e),t.b<100&&(t.b++,e.next=t.a,t.a=e)}function x(){this.b=this.a=null}A=_("__EID__")?"__EID__":void 0,w(C,Error),C.prototype.name="CustomError",w(R,C),R.prototype.name="AssertionError",P.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t};var M=new P(function(){return new j},function(t){t.reset()});function j(){this.next=this.b=this.a=null}x.prototype.add=function(t,e){var n=M.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},j.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},j.prototype.reset=function(){this.next=this.b=this.a=null};var U=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},V=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};var F=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n,i=t.length,r=[],o=0,a="string"==typeof t?t.split(""):t,s=0;s<i;s++)s in a&&(n=a[s],e.call(void 0,n,s,t)&&(r[o++]=n));return r},q=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),r="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in r&&(i[o]=e.call(void 0,r[o],o,t));return i},H=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t))return!0;return!1};function K(t,e){return 0<=U(t,e)}function G(t,e){var n;return(n=0<=(e=U(t,e)))&&Array.prototype.splice.call(t,e,1),n}function B(n,i){!function(t,e){for(var n="string"==typeof t?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)}(n,function(t,e){i.call(void 0,t,e,n)&&1==Array.prototype.splice.call(n,e,1).length&&0})}function W(){return Array.prototype.concat.apply([],arguments)}function X(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}var J,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},z=/&/g,$=/</g,Z=/>/g,Q=/"/g,tt=/'/g,et=/\x00/g,nt=/[\x00&<>"']/;function it(t,e){return-1!=t.indexOf(e)}function rt(t,e){return t<e?-1:e<t?1:0}t:{var ot=l.navigator;if(ot){ot=ot.userAgent;if(ot){J=ot;break t}}J=""}function at(t){return it(J,t)}function st(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function ut(t){for(var e in t)return;return 1}function ct(t){var e,n={};for(e in t)n[e]=t[e];return n}var ht="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lt(t){for(var e,n,i=1;i<arguments.length;i++){for(e in n=arguments[i])t[e]=n[e];for(var r=0;r<ht.length;r++)e=ht[r],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function ft(t,e){t:{try{var n,i=t&&t.ownerDocument;if((n=(n=i&&(i.defaultView||i.parentWindow))||l).Element&&n.Location){var r=n;break t}}catch(t){}r=null}if(r&&void 0!==r[e]&&(!t||!(t instanceof r[e])&&(t instanceof r.Location||t instanceof r.Element))){if(m(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function dt(t,e){this.a=t===gt&&e||"",this.b=mt}function pt(t){return t instanceof dt&&t.constructor===dt&&t.b===mt?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}dt.prototype.ta=!0,dt.prototype.sa=function(){return this.a},dt.prototype.toString=function(){return"Const{"+this.a+"}"};var vt,mt={},gt={};function bt(){if(void 0===vt){var t=null,e=l.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:I,createScript:I,createScriptURL:I})}catch(t){l.console&&l.console.error(t.message)}vt=t}else vt=t}return vt}function yt(t,e){this.a=e===At?t:""}function wt(t){return t instanceof yt&&t.constructor===yt?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function It(t,n){var e,i=pt(t);if(!Et.test(i))throw Error("Invalid TrustedResourceUrl format: "+i);return t=i.replace(Tt,function(t,e){if(!Object.prototype.hasOwnProperty.call(n,e))throw Error('Found marker, "'+e+'", in format string, "'+i+'", but no valid label mapping found in args: '+JSON.stringify(n));return(t=n[e])instanceof dt?pt(t):encodeURIComponent(String(t))}),e=t,t=bt(),new yt(e=t?t.createScriptURL(e):e,At)}yt.prototype.ta=!0,yt.prototype.sa=function(){return this.a.toString()},yt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Tt=/%{(\w+)}/g,Et=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,At={};function kt(t,e){this.a=e===Dt?t:""}function St(t){return t instanceof kt&&t.constructor===kt?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}kt.prototype.ta=!0,kt.prototype.sa=function(){return this.a.toString()},kt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Nt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,_t=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Ot=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ct(t){return t instanceof kt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),t=Ot.test(t)||(e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(_t))&&Nt.test(e[1])?new kt(t,Dt):null);var e}function Rt(t){return t instanceof kt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),new kt(t=!Ot.test(t)?"about:invalid#zClosurez":t,Dt))}var Dt={},Pt=new kt("about:invalid#zClosurez",Dt);function Lt(t,e,n){this.a=n===xt?t:""}Lt.prototype.ta=!0,Lt.prototype.sa=function(){return this.a.toString()},Lt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var xt={};function Mt(t,e,n,i){return t=t instanceof kt?t:Rt(t),e=e||l,n=n instanceof dt?pt(n):n||"",e.open(St(t),n,i,void 0)}function jt(t){for(var e=t.split("%s"),n="",i=Array.prototype.slice.call(arguments,1);i.length&&1<e.length;)n+=e.shift()+i.shift();return n+e.join("%s")}function Ut(t){return nt.test(t)&&(-1!=(t=-1!=(t=-1!=(t=-1!=(t=-1!=(t=-1!=t.indexOf("&")?t.replace(z,"&amp;"):t).indexOf("<")?t.replace($,"&lt;"):t).indexOf(">")?t.replace(Z,"&gt;"):t).indexOf('"')?t.replace(Q,"&quot;"):t).indexOf("'")?t.replace(tt,"&#39;"):t).indexOf("\0")&&(t=t.replace(et,"&#0;"))),t}function Vt(t){return Vt[" "](t),t}Vt[" "]=a;var Ft,qt=at("Opera"),Ht=at("Trident")||at("MSIE"),Kt=at("Edge"),Gt=Kt||Ht,Bt=at("Gecko")&&!(it(J.toLowerCase(),"webkit")&&!at("Edge"))&&!(at("Trident")||at("MSIE"))&&!at("Edge"),Wt=it(J.toLowerCase(),"webkit")&&!at("Edge");function Xt(){var t=l.document;return t?t.documentMode:void 0}t:{var Jt="",Yt=(Yt=J,Bt?/rv:([^\);]+)(\)|;)/.exec(Yt):Kt?/Edge\/([\d\.]+)/.exec(Yt):Ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Yt):Wt?/WebKit\/(\S+)/.exec(Yt):qt?/(?:Version)[ \/]?(\S+)/.exec(Yt):void 0);if(Yt&&(Jt=Yt?Yt[1]:""),Ht){Yt=Xt();if(null!=Yt&&Yt>parseFloat(Jt)){Ft=String(Yt);break t}}Ft=Jt}var zt={};function $t(s){return t=s,e=function(){for(var t=0,e=Y(String(Ft)).split("."),n=Y(String(s)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++)for(var o=e[r]||"",a=n[r]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],(0!=o[0].length||0!=a[0].length)&&(t=rt(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||rt(0==o[2].length,0==a[2].length)||rt(o[2],a[2]),o=o[3],a=a[3],0==t););return 0<=t},n=zt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var Zt=l.document&&Ht&&(Xt()||parseInt(Ft,10))||void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(t){}var Qt=!Ht||9<=Number(Zt);function te(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function ee(n,t){st(t,function(t,e){t&&"object"==typeof t&&t.ta&&(t=t.sa()),"style"==e?n.style.cssText=t:"class"==e?n.className=t:"for"==e?n.htmlFor=t:re.hasOwnProperty(e)?n.setAttribute(re[e],t):0==e.lastIndexOf("aria-",0)||0==e.lastIndexOf("data-",0)?n.setAttribute(e,t):n[e]=t})}var ne,ie,re={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function oe(){var t,e=arguments,n=document,i=String(e[0]),r=e[1];return!Qt&&r&&(r.name||r.type)&&(i=["<",i],r.name&&i.push(' name="',Ut(r.name),'"'),r.type&&(i.push(' type="',Ut(r.type),'"'),lt(t={},r),delete t.type,r=t),i.push(">"),i=i.join("")),i=ae(n,i),r&&("string"==typeof r?i.className=r:Array.isArray(r)?i.className=r.join(" "):ee(i,r)),2<e.length&&function(e,n,t){function i(t){t&&n.appendChild("string"==typeof t?e.createTextNode(t):t)}for(var r=2;r<t.length;r++){var o=t[r];if(!p(o)||m(o)&&0<o.nodeType)i(o);else{t:{if(o&&"number"==typeof o.length){if(m(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(v(o)){a="function"==typeof o.item;break t}}a=!1}V(a?X(o):o,i)}}}(n,i,e),i}function ae(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function se(t){l.setTimeout(function(){throw t},0)}function ue(t,e){ie||function(){{var t;ie=l.Promise&&l.Promise.resolve?(t=l.Promise.resolve(void 0),function(){t.then(le)}):function(){var t=le;!v(l.setImmediate)||l.Window&&l.Window.prototype&&!at("Edge")&&l.Window.prototype.setImmediate==l.setImmediate?(ne=ne||function(){var t=l.MessageChannel;if(void 0===(t=void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!at("Presto")?function(){var t=ae(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=b(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}:t)||at("Trident")||at("MSIE"))return function(t){l.setTimeout(t,0)};var e=new t,n={},i=n;return e.port1.onmessage=function(){var t;void 0!==n.next&&(t=(n=n.next).Hb,n.Hb=null,t())},function(t){i.next={Hb:t},i=i.next,e.port2.postMessage(0)}}())(t):l.setImmediate(t)}}}(),ce||(ie(),ce=!0),he.add(t,e)}var ce=!1,he=new x;function le(){for(var t,e;e=t=void 0,e=null,(t=he).a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e=e;){try{e.a.call(e.b)}catch(t){se(t)}L(M,e)}ce=!1}function fe(t,e){if(this.a=de,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=a)try{var n=this;t.call(e,function(t){ke(n,pe,t)},function(t){if(!(t instanceof De))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}ke(n,ve,t)})}catch(t){ke(this,ve,t)}}var de=0,pe=2,ve=3;function me(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}me.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var ge=new P(function(){return new me},function(t){t.reset()});function be(t,e,n){var i=ge.get();return i.g=t,i.b=e,i.f=n,i}function ye(t){if(t instanceof fe)return t;var e=new fe(a);return ke(e,pe,t),e}function we(n){return new fe(function(t,e){e(n)})}function Ie(t,e,n){Se(t,e,n,null)||ue(y(e,t))}function Te(n){return new fe(function(i){var r=n.length,o=[];if(r)for(var t=function(t,e,n){r--,o[t]=e?{Qb:!0,value:n}:{Qb:!1,reason:n},0==r&&i(o)},e=0;e<n.length;e++)Ie(n[e],y(t,e,!0),y(t,e,!1));else i(o)})}function Ee(t,e){t.b||t.a!=pe&&t.a!=ve||Ne(t),t.f?t.f.next=e:t.b=e,t.f=e}function Ae(t,r,o,a){var e=be(null,null,null);return e.a=new fe(function(n,i){e.g=r?function(t){try{var e=r.call(a,t);n(e)}catch(t){i(t)}}:n,e.b=o?function(t){try{var e=o.call(a,t);void 0===e&&t instanceof De?i(t):n(e)}catch(t){i(t)}}:i}),Ee(e.a.c=t,e),e.a}function ke(t,e,n){var i,r;t.a==de&&(t===n&&(e=ve,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Se(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Ne(t),e!=ve||n instanceof De||(r=n,(i=t).g=!0,ue(function(){i.g&&Re.call(null,r)}))))}function Se(t,e,n,i){if(t instanceof fe)return Ee(t,be(e||a,n||null,i)),1;if(O(t))return t.then(e,n,i),1;if(m(t))try{var r=t.then;if(v(r))return function(t,e,n,i,r){function o(t){a||(a=!0,i.call(r,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(r,t))},o)}catch(t){o(t)}}(t,r,e,n,i),1}catch(t){return n.call(i,t),1}}function Ne(t){t.h||(t.h=!0,ue(t.gc,t))}function _e(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Oe(t,e,n,i){if(n==ve&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ce(e,n,i);else try{e.c?e.g.call(e.f):Ce(e,n,i)}catch(t){Re.call(null,t)}L(ge,e)}function Ce(t,e,n){e==pe?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}fe.prototype.then=function(t,e,n){return Ae(this,v(t)?t:null,v(e)?e:null,n)},fe.prototype.$goog_Thenable=!0,(t=fe.prototype).oa=function(t,e){return(t=be(t,t,e)).c=!0,Ee(this,t),this},t.o=function(t,e){return Ae(this,null,t,e)},t.cancel=function(t){var e;this.a==de&&(e=new De(t),ue(function(){!function t(e,n){if(e.a==de)if(e.c){var i=e.c;if(i.b){for(var r=0,o=null,a=null,s=i.b;s&&(s.c||(r++,!((o=s.a==e?s:o)&&1<r)));s=s.next)o||(a=s);o&&(i.a==de&&1==r?t(i,n):(a?((r=a).next==i.f&&(i.f=r),r.next=r.next.next):_e(i),Oe(i,o,ve,n)))}e.c=null}else ke(e,ve,n)}(this,e)},this))},t.$c=function(t){this.a=de,ke(this,pe,t)},t.ad=function(t){this.a=de,ke(this,ve,t)},t.gc=function(){for(var t;t=_e(this);)Oe(this,t,this.a,this.i);this.h=!1};var Re=se;function De(t){C.call(this,t)}function Pe(){this.ya=this.ya,this.pa=this.pa}w(De,C);var Le=0,xe={};function Me(t){t.ya||(t.ya=!0,t.Da(),0==Le)||(t=t,t=Object.prototype.hasOwnProperty.call(t,n)&&t[n]||(t[n]=++i),delete xe[t])}Pe.prototype.ya=!(De.prototype.name="cancel"),Pe.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var je=Object.freeze||function(t){return t},Ue=!Ht||9<=Number(Zt),Ve=Ht&&!$t("9"),Fe=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{l.addEventListener("test",a,e),l.removeEventListener("test",a,e)}catch(t){}return t}();function qe(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function He(t,e){if(qe.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Bt){t:{try{Vt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ke[t.pointerType]||"",(this.a=t).defaultPrevented&&this.preventDefault()}}qe.prototype.preventDefault=function(){this.defaultPrevented=!0},w(He,qe);var Ke=je({2:"touch",3:"pen",4:"mouse"});He.prototype.preventDefault=function(){He.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ve)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}},He.prototype.g=function(){return this.a};var Ge="closure_listenable_"+(1e6*Math.random()|0),Be=0;function We(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.Wa=r,this.key=++Be,this.wa=this.Qa=!1}function Xe(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function Je(t){this.src=t,this.a={},this.b=0}function Ye(t,e){var n=e.type;n in t.a&&G(t.a[n],e)&&(Xe(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function ze(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.wa&&o.listener==e&&o.capture==!!n&&o.Wa==i)return r}return-1}Je.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ze(t,e,i,r);return-1<a?(e=t[a],n||(e.Qa=!1)):((e=new We(e,this.src,o,!!i,r)).Qa=n,t.push(e)),e};var $e="closure_lm_"+(1e6*Math.random()|0),Ze={};function Qe(t,e,n,i,r){if(i&&i.once)en(t,e,n,i,r);else if(Array.isArray(e))for(var o=0;o<e.length;o++)Qe(t,e[o],n,i,r);else n=ln(n),t&&t[Ge]?dn(t,e,n,m(i)?!!i.capture:!!i,r):tn(t,e,n,!1,i,r)}function tn(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a,s,u=m(r)?!!r.capture:!!r,c=cn(t);if(c||(t[$e]=c=new Je(t)),!(n=c.add(e,n,i,u,o)).proxy)if(a=un,s=Ue?function(t){return a.call(s.src,s.listener,t)}:function(t){if(!(t=a.call(s.src,s.listener,t)))return t},(n.proxy=i=s).src=t,i.listener=n,t.addEventListener)void 0===(r=!Fe?u:r)&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(on(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}}function en(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)en(t,e[o],n,i,r);else n=ln(n),t&&t[Ge]?pn(t,e,n,m(i)?!!i.capture:!!i,r):tn(t,e,n,!0,i,r)}function nn(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)nn(t,e[o],n,i,r);else i=m(i)?!!i.capture:!!i,n=ln(n),t&&t[Ge]?(t=t.v,(e=String(e).toString())in t.a&&(-1<(n=ze(o=t.a[e],n,i,r))&&(Xe(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):(t=t&&cn(t))&&(e=t.a[e.toString()],(n=(t=-1)<(t=e?ze(e,n,i,r):t)?e[t]:null)&&rn(n))}function rn(t){var e,n,i;"number"!=typeof t&&t&&!t.wa&&((e=t.src)&&e[Ge]?Ye(e.v,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(on(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=cn(e))?(Ye(n,t),0==n.b&&(n.src=null,e[$e]=null)):Xe(t)))}function on(t){return t in Ze?Ze[t]:Ze[t]="on"+t}function an(t,e,n,i){var r=!0;if((t=cn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=sn(o,i),r=r&&!1!==o)}return r}function sn(t,e){var n=t.listener,i=t.Wa||t.src;return t.Qa&&rn(t),n.call(i,e)}function un(t,e){if(t.wa)return!0;if(Ue)return sn(t,new He(e,this));if(!e)t:{e=["window","event"];for(var n=l,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}if(e=new He(i=e,this),n=!0,!(i.keyCode<0||null!=i.returnValue)){t:{var r=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(t){r=!0}!r&&null!=i.returnValue||(i.returnValue=!0)}for(i=[],r=e.b;r;r=r.parentNode)i.push(r);for(t=t.type,r=i.length-1;0<=r;r--){e.b=i[r];var o=an(i[r],t,!0,e),n=n&&o}for(r=0;r<i.length;r++)e.b=i[r],o=an(i[r],t,!1,e),n=n&&o}return n}function cn(t){return(t=t[$e])instanceof Je?t:null}var hn="__closure_events_fn_"+(1e9*Math.random()>>>0);function ln(e){return v(e)?e:(e[hn]||(e[hn]=function(t){return e.handleEvent(t)}),e[hn])}function fn(){Pe.call(this),this.v=new Je(this),(this.bc=this).hb=null}function dn(t,e,n,i,r){t.v.add(String(e),n,!1,i,r)}function pn(t,e,n,i,r){t.v.add(String(e),n,!0,i,r)}function vn(t,e,n,i){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a,s,u=e[o];u&&!u.wa&&u.capture==n&&(a=u.listener,s=u.Wa||u.src,u.Qa&&Ye(t.v,u),r=!1!==a.call(s,i)&&r)}return r&&!i.defaultPrevented}function mn(t,e,n){if(v(t))n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:l.setTimeout(t,e||0)}function gn(n){var i=null;return new fe(function(t,e){-1==(i=mn(function(){t(void 0)},n))&&e(Error("Failed to schedule timer."))}).o(function(t){throw l.clearTimeout(i),t})}function bn(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function yn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(p(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function wn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof wn)for(n=t.Y(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function In(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Tn(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Tn(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}w(fn,Pe),fn.prototype[Ge]=!0,fn.prototype.addEventListener=function(t,e,n,i){Qe(this,t,e,n,i)},fn.prototype.removeEventListener=function(t,e,n,i){nn(this,t,e,n,i)},fn.prototype.dispatchEvent=function(t){var e;if(n=this.hb)for(e=[];n;n=n.hb)e.push(n);var n=this.bc,i=t.type||t;if("string"==typeof t?t=new qe(t,n):t instanceof qe?t.target=t.target||n:(a=t,lt(t=new qe(i,n),a)),a=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.b=e[r],a=vn(o,i,!0,t)&&a;if(a=vn(o=t.b=n,i,!0,t)&&a,a=vn(o,i,!1,t)&&a,e)for(r=0;r<e.length;r++)a=vn(o=t.b=e[r],i,!1,t)&&a;return a},fn.prototype.Da=function(){if(fn.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Xe(n[i]);delete e.a[t],e.b--}}this.hb=null},(t=wn.prototype).X=function(){In(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return In(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Tn(this.b,t)?this.b[t]:e},t.set=function(t,e){Tn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var En=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function An(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof An?(this.i=void 0!==e?e:t.i,kn(this,t.c),this.l=t.l,this.a=t.a,Sn(this,t.g),this.f=t.f,Nn(this,Wn(t.b)),this.h=t.h):t&&(n=String(t).match(En))?(this.i=!!e,kn(this,n[1]||"",!0),this.l=Dn(n[2]||""),this.a=Dn(n[3]||"",!0),Sn(this,n[4]),this.f=Dn(n[5]||"",!0),Nn(this,n[6]||"",!0),this.h=Dn(n[7]||"")):(this.i=!!e,this.b=new Fn(null,this.i))}function kn(t,e,n){t.c=n?Dn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Sn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Nn(t,e,n){var i,r;e instanceof Fn?(t.b=e,i=t.b,(r=t.i)&&!i.f&&(qn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Kn(this,e),Bn(this,n,t))},i)),i.f=r):(n||(e=Pn(e,Un)),t.b=new Fn(e,t.i))}function _n(t,e,n){t.b.set(e,n)}function On(t,e){return t.b.get(e)}function Cn(t){return t instanceof An?new An(t):new An(t,void 0)}function Rn(t,e,n,i){var r=new An(null,void 0);return t&&kn(r,t),e&&(r.a=e),n&&Sn(r,n),i&&(r.f=i),r}function Dn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Pn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ln),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function Ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}An.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Pn(e,xn,!0),":");var n=this.a;return!n&&"file"!=e||(t.push("//"),(e=this.l)&&t.push(Pn(e,xn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Pn(n,"/"==n.charAt(0)?jn:Mn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Pn(n,Vn)),t.join("")},An.prototype.resolve=function(t){var e=new An(this),n=!!t.c;n?kn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var i=t.f;if(n)Sn(e,t.g);else if(n=!!t.f)if("/"!=i.charAt(0)&&(this.a&&!this.f?i="/"+i:-1!=(r=e.f.lastIndexOf("/"))&&(i=e.f.substr(0,r+1)+i)),".."==(r=i)||"."==r)i="";else if(it(r,"./")||it(r,"/.")){for(var i=0==r.lastIndexOf("/",0),r=r.split("/"),o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r;return n?e.f=i:n=""!==t.b.toString(),n?Nn(e,Wn(t.b)):n=!!t.h,n&&(e.h=t.h),e};var xn=/[#\/\?@]/g,Mn=/[#\?:]/g,jn=/[#\?]/g,Un=/[#\?@]/g,Vn=/#/g;function Fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function qn(n){n.a||(n.a=new wn,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i,r=t[n].indexOf("="),o=null;0<=r?(i=t[n].substring(0,r),o=t[n].substring(r+1)):i=t[n],e(i,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function Hn(t){var e=yn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Fn(null,void 0);t=bn(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];Array.isArray(o)?Bn(n,r,o):n.add(r,o)}return n}function Kn(t,e){qn(t),e=Xn(t,e),Tn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Tn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&In(t)))}function Gn(t,e){return qn(t),e=Xn(t,e),Tn(t.a.b,e)}function Bn(t,e,n){Kn(t,e),0<n.length&&(t.c=null,t.a.set(Xn(t,e),X(n)),t.b+=n.length)}function Wn(t){var e=new Fn;return e.c=t.c,t.a&&(e.a=new wn(t.a),e.b=t.b),e}function Xn(t,e){return e=String(e),e=t.f?e.toLowerCase():e}function Jn(t){var e=[];return function t(e,n,i){if(null==n)i.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var r=n;n=r.length,i.push("[");for(var o="",a=0;a<n;a++)i.push(o),t(e,r[a],i),o=",";return void i.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(r in i.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,r)&&(a=n[r],"function"!=typeof a&&(i.push(o),Zn(r,i),i.push(":"),t(e,a,i),o=","));return void i.push("}")}n=n.valueOf()}switch(typeof n){case"string":Zn(n,i);break;case"number":i.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":i.push(String(n));break;case"function":i.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Yn,t,e),e.join("")}function Yn(){}(t=Fn.prototype).add=function(t,e){qn(this),this.c=null,t=Xn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(n,i){qn(this),this.a.forEach(function(t,e){V(t,function(t){n.call(i,t,e,this)},this)},this)},t.Y=function(){qn(this);for(var t=this.a.X(),e=this.a.Y(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.X=function(t){qn(this);var e=[];if("string"==typeof t)Gn(this,t)&&(e=W(e,this.a.get(Xn(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},t.set=function(t,e){return qn(this),this.c=null,Gn(this,t=Xn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.X(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.X(i),o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(String(i[o]))),t.push(a)}return this.c=t.join("&")};var zn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},$n=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Zn(t,e){e.push('"',t.replace($n,function(t){var e=zn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),zn[t]=e),e}),'"')}function Qn(){var t=bi();return Ht&&Zt&&11==Zt||/Edge\/\d+/.test(t)}function ti(){return l.window&&l.window.location.href||self&&self.location&&self.location.href||""}function ei(t,e){e=e||l.window;var n="about:blank";t&&(n=St(Ct(t)||Pt)),e.location.href=n}function ni(t){return!!((t=(t||bi()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ii(t){t=t||l.window;try{t.close()}catch(t){}}function ri(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=bi().toLowerCase(),i&&(e.target=i,it(n,"crios/")&&(e.target="_blank")),vi(bi())==di&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof kt?n:Ct(void 0!==n.href?n.href:String(n))||Pt,n=t.target||n.target,r=[],t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0))}var a=r.join(",");if((at("iPhone")&&!at("iPod")&&!at("iPad")||at("iPad")||at("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(ft(a=ae(document,"A"),"HTMLAnchorElement"),e=e instanceof kt?e:Rt(e),a.href=St(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Mt("",i,n,a),t=St(e),a&&(Gt&&it(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ut(t)+'">',t=new Lt(t=(i=bt())?i.createHTML(t):t,0,xt),i=a.document)&&(i.write((o=t)instanceof Lt&&o.constructor===Lt?o.a:(D("expected object of type SafeHtml, got '"+o+"' of type "+d(o)),"type_error:SafeHtml")),i.close())):(a=Mt(e,i,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var oi=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ai=/^[^@]+@[^@]+$/;function si(){var e=null;return new fe(function(t){"complete"==l.document.readyState?t():(e=function(){t()},en(window,"load",e))}).o(function(t){throw nn(window,"load",e),t})}function ui(t){return t=t||bi(),!("file:"!==Ei()&&"ionic:"!==Ei()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function ci(){var t=l.window;try{return t&&t!=t.top}catch(t){return}}function hi(){return void 0!==l.WorkerGlobalScope&&"function"==typeof l.importScripts}function li(){return Zl.default.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":Zl.default.INTERNAL.hasOwnProperty("node")?"Node":hi()?"Worker":"Browser"}function fi(){var t=li();return"ReactNative"===t||"Node"===t}var di="Firefox",pi="Chrome";function vi(t){var e=t.toLowerCase();return it(e,"opera/")||it(e,"opr/")||it(e,"opios/")?"Opera":it(e,"iemobile")?"IEMobile":it(e,"msie")||it(e,"trident/")?"IE":it(e,"edge/")?"Edge":it(e,"firefox/")?di:it(e,"silk/")?"Silk":it(e,"blackberry")?"Blackberry":it(e,"webos")?"Webos":!it(e,"safari/")||it(e,"chrome/")||it(e,"crios/")||it(e,"android")?!it(e,"chrome/")&&!it(e,"crios/")||it(e,"edge/")?it(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":pi:"Safari"}var mi={md:"FirebaseCore-web",od:"FirebaseUI-web"};function gi(t,e){e=e||[];var n,i=[],r={};for(n in mi)r[mi[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=li())?i=vi(r=bi()):"Worker"===i&&(i=vi(r=bi())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function bi(){return l.navigator&&l.navigator.userAgent||""}function yi(t,e){t=t.split("."),e=e||l;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return e=n!=t.length?void 0:e}function wi(){try{var t=l.localStorage,e=_i();if(t)return t.setItem(e,"1"),t.removeItem(e),!Qn()||!!l.indexedDB}catch(t){return hi()&&!!l.indexedDB}return!1}function Ii(){return(Ti()||"chrome-extension:"===Ei()||ui())&&!fi()&&wi()&&!hi()}function Ti(){return"http:"===Ei()||"https:"===Ei()}function Ei(){return l.location&&l.location.protocol||null}function Ai(t){return!ni(t=t||bi())&&vi(t)!=di}function ki(t){return void 0===t?null:Jn(t)}function Si(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Ni(t){if(null!==t)return JSON.parse(t)}function _i(t){return t||Math.floor(1e9*Math.random()).toString()}function Oi(t){return"Safari"!=vi(t=t||bi())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Ci(){var t=l.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Ri(t,e){if(e<t)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=bi(),e=li(),this.b=ni(t)||"ReactNative"===e}function Di(){var t=l.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Pi(){var e=l.document,n=null;return Di()||!e?ye():new fe(function(t){n=function(){Di()&&(e.removeEventListener("visibilitychange",n,!1),t())},e.addEventListener("visibilitychange",n,!1)}).o(function(t){throw e.removeEventListener("visibilitychange",n,!1),t})}function Li(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function xi(){return yi("fireauth.oauthhelper",l)||yi("fireauth.iframe",l)}Ri.prototype.get=function(){var t=l.navigator;return!t||"boolean"!=typeof t.onLine||!Ti()&&"chrome-extension:"!==Ei()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Mi,ji={};function Ui(t){ji[t]||(ji[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Vi={};Object.defineProperty(Vi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Vi,"abcd",{configurable:!0,enumerable:!0,value:2}),Mi=2==Vi.abcd}catch(t){Mi=!1}function Fi(t,e,n){Mi?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function qi(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Fi(t,n,e[n])}function Hi(t){var e={};return qi(e,t),e}function Ki(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Fi(e,n,Ki(t[n]));return e}function Gi(t){var e=t&&(t[Yi]?"phone":null);if(!(e&&t&&t[Ji]))throw new T("internal-error","Internal assert: invalid MultiFactorInfo object");Fi(this,"uid",t[Ji]),Fi(this,"displayName",t[Wi]||null);var n=null;Fi(this,"enrollmentTime",n=t[Xi]?new Date(t[Xi]).toUTCString():n),Fi(this,"factorId",e)}function Bi(t){try{var e=new zi(t)}catch(t){e=null}return e}Gi.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Wi="displayName",Xi="enrolledAt",Ji="mfaEnrollmentId",Yi="phoneInfo";function zi(t){Gi.call(this,t),Fi(this,"phoneNumber",t[Yi])}function $i(t){var e={},n=t[er],i=t[ir],r=t[rr];if(t=Bi(t[nr]),!r||r!=Qi&&r!=tr&&!n||r==tr&&!i||r==Zi&&!t)throw Error("Invalid checkActionCode response!");r==tr?(e[ar]=n||null,e[ur]=n||null,e[or]=i):(e[ar]=i||null,e[ur]=i||null,e[or]=n||null),e[sr]=t||null,Fi(this,hr,r),Fi(this,cr,Ki(e))}w(zi,Gi),zi.prototype.w=function(){var t=zi.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var Zi="REVERT_SECOND_FACTOR_ADDITION",Qi="EMAIL_SIGNIN",tr="VERIFY_AND_CHANGE_EMAIL",er="email",nr="mfaInfo",ir="newEmail",rr="requestType",or="email",ar="fromEmail",sr="multiFactorInfo",ur="previousEmail",cr="data",hr="operation";function lr(t){var e=On(t=Cn(t),fr)||null,n=On(t,dr)||null,i=(i=On(t,mr)||null)&&br[i]||null;if(!e||!n||!i)throw new T("argument-error",fr+", "+dr+"and "+mr+" are required in a valid action code URL.");qi(this,{apiKey:e,operation:i,code:n,continueUrl:On(t,pr)||null,languageCode:On(t,vr)||null,tenantId:On(t,gr)||null})}var fr="apiKey",dr="oobCode",pr="continueUrl",vr="languageCode",mr="mode",gr="tenantId",br={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:Zi,signIn:Qi,verifyAndChangeEmail:tr,verifyEmail:"VERIFY_EMAIL"};function yr(t){try{return new lr(t)}catch(t){return null}}function wr(t){if(void 0===(e=t[kr]))throw new T("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new T("invalid-continue-uri");if(this.h=e,this.b=this.a=null,this.g=!1,(i=t[Ir])&&"object"==typeof i){var e=i[_r],n=i[Sr],i=i[Nr];if("string"==typeof e&&e.length){if(this.a=e,void 0!==n&&"boolean"!=typeof n)throw new T("argument-error",Sr+" property must be a boolean when specified.");if(this.g=!!n,void 0!==i&&("string"!=typeof i||"string"==typeof i&&!i.length))throw new T("argument-error",Nr+" property must be a non empty string when specified.");this.b=i||null}else{if(void 0!==e)throw new T("argument-error",_r+" property must be a non empty string when specified.");if(void 0!==n||void 0!==i)throw new T("missing-android-pkg-name")}}else if(void 0!==i)throw new T("argument-error",Ir+" property must be a non null object when specified.");if(this.f=null,(e=t[Ar])&&"object"==typeof e){if("string"==typeof(e=e[Or])&&e.length)this.f=e;else if(void 0!==e)throw new T("argument-error",Or+" property must be a non empty string when specified.")}else if(void 0!==e)throw new T("argument-error",Ar+" property must be a non null object when specified.");if(void 0!==(e=t[Er])&&"boolean"!=typeof e)throw new T("argument-error",Er+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Tr])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new T("argument-error",Tr+" property must be a non empty string when specified.");this.i=t||null}var Ir="android",Tr="dynamicLinkDomain",Er="handleCodeInApp",Ar="iOS",kr="url",Sr="installApp",Nr="minimumVersion",_r="packageName",Or="bundleId";function Cr(t){var e,n={};for(e in n.continueUrl=t.h,n.canHandleCodeInApp=t.c,(n.androidPackageName=t.a)&&(n.androidMinimumVersion=t.b,n.androidInstallApp=t.g),n.iOSBundleId=t.f,n.dynamicLinkDomain=t.i,n)null===n[e]&&delete n[e];return n}var Rr=null;function Dr(t){var e=[];return function(i,t){function e(t){for(;r<i.length;){var e=i.charAt(r++),n=Rr[e];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(e))throw Error("Unknown base64 encoding at char: "+e)}return t}!function(){if(!Rr){Rr={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;n<5;n++)for(var i=t.concat(e[n].split("")),r=0;r<i.length;r++){var o=i[r];void 0===Rr[o]&&(Rr[o]=r)}}}();for(var r=0;;){var n=e(-1),o=e(0),a=e(64),s=e(64);if(64===s&&-1===n)break;t(n<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(t,function(t){e.push(t)}),e}function Pr(t){var e=xr(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Lr(t){try{return new Pr(t)}catch(t){return null}}function xr(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var i=Dr(t);for(t=[],n=e=0;e<i.length;){var r,o,a,s=i[e++];s<128?t[n++]=String.fromCharCode(s):191<s&&s<224?(r=i[e++],t[n++]=String.fromCharCode((31&s)<<6|63&r)):239<s&&s<365?(a=((7&s)<<18|(63&(r=i[e++]))<<12|(63&(o=i[e++]))<<6|63&i[e++])-65536,t[n++]=String.fromCharCode(55296+(a>>10)),t[n++]=String.fromCharCode(56320+(1023&a))):(r=i[e++],o=i[e++],t[n++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o))}return JSON.parse(t.join(""))}catch(t){}return null}Pr.prototype.T=function(){return this.f},Pr.prototype.l=function(){return this.c},Pr.prototype.toString=function(){return this.h};var Mr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),jr=["client_id","response_type","scope","redirect_uri","state"],Ur={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:jr},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:jr},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:jr},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Mr},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Vr(t){for(var e in Ur)if(Ur[e].fa==t)return Ur[e];return null}function Fr(t){var e={};e["facebook.com"]=Br,e["google.com"]=Xr,e["github.com"]=Wr,e["twitter.com"]=Jr;var n=t&&t[Hr];try{if(n)return new(e[n]||Gr)(t);if(void 0!==t[qr])return new Kr(t)}catch(t){}return null}var qr="idToken",Hr="providerId";function Kr(t){var e,n=t[Hr];if(n||!t[qr]||(e=Lr(t[qr]))&&e.b&&(n=e.b),!n)throw Error("Invalid additional user info!");e=!1,void 0!==t.isNewUser?e=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(e=!0),Fi(this,"providerId",n="anonymous"==n||"custom"==n?null:n),Fi(this,"isNewUser",e)}function Gr(t){Kr.call(this,t),Fi(this,"profile",Ki((t=Ni(t.rawUserInfo||"{}"))||{}))}function Br(t){if(Gr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Wr(t){if(Gr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Fi(this,"username",this.profile&&this.profile.login||null)}function Xr(t){if(Gr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Jr(t){if(Gr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Fi(this,"username",t.screenName||null)}function Yr(t){var e=On(i=Cn(t),"link"),n=On(Cn(e),"link"),i=On(i,"deep_link_id");return On(Cn(i),"link")||i||n||e||t}function zr(t,e){if(!t&&!e)throw new T("internal-error","Internal assert: no raw session string available");if(t&&e)throw new T("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?$r:Zr}w(Gr,Kr),w(Br,Gr),w(Wr,Gr),w(Xr,Gr),w(Jr,Gr);var $r="enroll",Zr="signin";function Qr(){}function to(t,n){return t.then(function(t){if(t[Ka]){var e=Lr(t[Ka]);if(!e||n!=e.i)throw new T("user-mismatch");return t}throw new T("user-mismatch")}).o(function(t){throw t&&t.code&&t.code==k+"user-not-found"?new T("user-mismatch"):t})}function eo(t,e){if(!e)throw new T("internal-error","failed to construct a credential");this.a=e,Fi(this,"providerId",t),Fi(this,"signInMethod",t)}function no(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function io(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new eo(t.providerId,t.pendingToken)}catch(t){}return null}function ro(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Fi(this,"idToken",e.idToken),e.accessToken&&Fi(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Fi(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new T("internal-error","failed to construct a credential");Fi(this,"accessToken",e.oauthToken),Fi(this,"secret",e.oauthTokenSecret)}Fi(this,"providerId",t),Fi(this,"signInMethod",n)}function oo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Hn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function ao(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new ro(t.providerId,e,t.signInMethod)}catch(t){}}return null}function so(t,e){this.Qc=e||[],qi(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=(Vr(t)||{}).Ja||null,this.pb=null}function uo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new T("argument-error",'SAML provider IDs must be prefixed with "saml."');so.call(this,t,[])}function co(t){so.call(this,t,jr),this.a=[]}function ho(){co.call(this,"facebook.com")}function lo(t){if(!t)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return m(t)&&(e=t.accessToken),(new ho).credential({accessToken:e})}function fo(){co.call(this,"github.com")}function po(t){if(!t)throw new T("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return m(t)&&(e=t.accessToken),(new fo).credential({accessToken:e})}function vo(){co.call(this,"google.com"),this.Ca("profile")}function mo(t,e){var n=t;return m(t)&&(n=t.idToken,e=t.accessToken),(new vo).credential({idToken:n,accessToken:e})}function go(){so.call(this,"twitter.com",Mr)}function bo(t,e){var n=t;if(!(n=!m(n)?{oauthToken:t,oauthTokenSecret:e}:n).oauthToken||!n.oauthTokenSecret)throw new T("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new ro("twitter.com",n,"twitter.com")}function yo(t,e,n){this.a=t,this.f=e,Fi(this,"providerId","password"),Fi(this,"signInMethod",n===Io.EMAIL_LINK_SIGN_IN_METHOD?Io.EMAIL_LINK_SIGN_IN_METHOD:Io.EMAIL_PASSWORD_SIGN_IN_METHOD)}function wo(t){return t&&t.email&&t.password?new yo(t.email,t.password,t.signInMethod):null}function Io(){qi(this,{providerId:"password",isOAuthProvider:!1})}function To(t,e){if(!(e=Eo(e)))throw new T("argument-error","Invalid email link!");return new yo(t,e.code,Io.EMAIL_LINK_SIGN_IN_METHOD)}function Eo(t){return(t=yr(t=Yr(t)))&&t.operation===Qi?t:null}function Ao(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new T("internal-error");this.a=t,Fi(this,"providerId","phone"),this.fa="phone",Fi(this,"signInMethod","phone")}function ko(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var n={};return V(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(t){e[t]&&(n[t]=e[t])}),new Ao(n)}return null}function So(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function No(t){try{this.a=t||Zl.default.auth()}catch(t){throw new T("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}qi(this,{providerId:"phone",isOAuthProvider:!1})}function _o(t,e){if(!t)throw new T("missing-verification-id");if(!e)throw new T("missing-verification-code");return new Ao({fb:t,eb:e})}function Oo(t){if(t.temporaryProof&&t.phoneNumber)return new Ao({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return mo(o,n);case"facebook.com":return lo(n);case"github.com":return po(n);case"twitter.com":return bo(n,i);default:return n||i||o||a?a?0==e.indexOf("saml.")?new eo(e,a):new ro(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new co(e).credential({idToken:o,accessToken:n,rawNonce:r}):null}}catch(t){return null}}function Co(t){if(!t.isOAuthProvider)throw new T("invalid-oauth-provider")}function Ro(t,e,n,i,r,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=i||null,this.i=o||null,this.h=a||null,this.a=r||null,!this.g&&!this.a)throw new T("invalid-auth-event");if(this.g&&this.a)throw new T("invalid-auth-event");if(this.g&&!this.f)throw new T("invalid-auth-event")}function Do(t){return(t=t||{}).type?new Ro(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&E(t.error),t.postBody,t.tenantId):null}function Po(){this.b=null,this.a=[]}zr.prototype.Ha=function(){return this.a?ye(this.a):ye(this.b)},zr.prototype.w=function(){return this.type==$r?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},Qr.prototype.ka=function(){},Qr.prototype.b=function(){},Qr.prototype.c=function(){},Qr.prototype.w=function(){},eo.prototype.ka=function(t){return ls(t,no(this))},eo.prototype.b=function(t,e){var n=no(this);return n.idToken=e,fs(t,n)},eo.prototype.c=function(t,e){return to(ds(t,no(this)),e)},eo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},ro.prototype.ka=function(t){return ls(t,oo(this))},ro.prototype.b=function(t,e){var n=oo(this);return n.idToken=e,fs(t,n)},ro.prototype.c=function(t,e){return to(ds(t,oo(this)),e)},ro.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},so.prototype.Ka=function(t){return this.Jb=ct(t),this},w(uo,so),w(co,so),co.prototype.Ca=function(t){return K(this.a,t)||this.a.push(t),this},co.prototype.Rb=function(){return X(this.a)},co.prototype.credential=function(t,e){e=m(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null};if(!e.idToken&&!e.accessToken)throw new T("argument-error","credential failed: must provide the ID token and/or the access token.");return new ro(this.providerId,e,this.providerId)},w(ho,co),Fi(ho,"PROVIDER_ID","facebook.com"),Fi(ho,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),w(fo,co),Fi(fo,"PROVIDER_ID","github.com"),Fi(fo,"GITHUB_SIGN_IN_METHOD","github.com"),w(vo,co),Fi(vo,"PROVIDER_ID","google.com"),Fi(vo,"GOOGLE_SIGN_IN_METHOD","google.com"),w(go,so),Fi(go,"PROVIDER_ID","twitter.com"),Fi(go,"TWITTER_SIGN_IN_METHOD","twitter.com"),yo.prototype.ka=function(t){return this.signInMethod==Io.EMAIL_LINK_SIGN_IN_METHOD?Js(t,Is,{email:this.a,oobCode:this.f}):Js(t,Ks,{email:this.a,password:this.f})},yo.prototype.b=function(t,e){return this.signInMethod==Io.EMAIL_LINK_SIGN_IN_METHOD?Js(t,Ts,{idToken:e,email:this.a,oobCode:this.f}):Js(t,xs,{idToken:e,email:this.a,password:this.f})},yo.prototype.c=function(t,e){return to(this.ka(t),e)},yo.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},qi(Io,{PROVIDER_ID:"password"}),qi(Io,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),qi(Io,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Ao.prototype.ka=function(t){return t.gb(So(this))},Ao.prototype.b=function(t,e){var n=So(this);return n.idToken=e,Js(t,Bs,n)},Ao.prototype.c=function(t,e){var n=So(this);return n.operation="REAUTH",to(t=Js(t,Ws,n),e)},Ao.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},No.prototype.gb=function(i,r){var o=this.a.a;return ye(r.verify()).then(function(e){if("string"!=typeof e)throw new T("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");if("recaptcha"!==r.type)throw new T("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.');var t=m(i)?i.session:null,n=m(i)?i.phoneNumber:i,t=t&&t.type==$r?t.Ha().then(function(t){return Js(o,js,{idToken:t,phoneEnrollmentInfo:{phoneNumber:n,recaptchaToken:e}}).then(function(t){return t.phoneSessionInfo.sessionInfo})}):t&&t.type==Zr?t.Ha().then(function(t){return t={mfaPendingCredential:t,mfaEnrollmentId:i.multiFactorHint&&i.multiFactorHint.uid||i.multiFactorUid,phoneSignInInfo:{recaptchaToken:e}},Js(o,Us,t).then(function(t){return t.phoneResponseInfo.sessionInfo})}):Js(o,Ps,{phoneNumber:n,recaptchaToken:e});return t.then(function(t){return"function"==typeof r.reset&&r.reset(),t},function(t){throw"function"==typeof r.reset&&r.reset(),t})})},qi(No,{PROVIDER_ID:"phone"}),qi(No,{PHONE_SIGN_IN_METHOD:"phone"}),Ro.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Ro.prototype.T=function(){return this.h},Ro.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Lo,xo=null;function Mo(t){var e="unauthorized-domain",n=void 0,i=Cn(t);t=i.a,"chrome-extension"==(i=i.c)?n=jt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=jt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",T.call(this,e,n)}function jo(t,e,n){T.call(this,t,n),(t=e||{}).Kb&&Fi(this,"email",t.Kb),t.ea&&Fi(this,"phoneNumber",t.ea),t.credential&&Fi(this,"credential",t.credential),t.$b&&Fi(this,"tenantId",t.$b)}function Uo(t){if(t.code){var e=t.code||"";0==e.indexOf(k)&&(e=e.substring(k.length));var n={credential:Oo(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new T(e,t.message||void 0);return new jo(e,n,t.message)}return null}function Vo(){}function Fo(t){return t.c||(t.c=t.b())}function qo(){}function Ho(t){if(t.f||"undefined"!=typeof XMLHttpRequest||"undefined"==typeof ActiveXObject)return t.f;for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}function Ko(){}function Go(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=b(this.qc,this),this.a.onerror=b(this.Tb,this),this.a.onprogress=b(this.rc,this),this.a.ontimeout=b(this.vc,this)}function Bo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Wo(t,e,n){this.reset(t,e,n,void 0,void 0)}function Xo(t){this.f=t,this.b=this.c=this.a=null}function Jo(t,e){this.name=t,this.value=e}w(Mo,T),w(jo,T),jo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&lt(t,e),t},jo.prototype.toJSON=function(){return this.w()},Vo.prototype.c=null,w(qo,Vo),qo.prototype.a=function(){var t=Ho(this);return t?new ActiveXObject(t):new XMLHttpRequest},qo.prototype.b=function(){var t={};return Ho(this)&&(t[0]=!0,t[1]=!0),t},Lo=new qo,w(Ko,Vo),Ko.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Go;throw Error("Unsupported browser")},Ko.prototype.b=function(){return{}},(t=Go.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Bo(this,4)},t.Tb=function(){this.status=500,this.response=this.responseText="",Bo(this,4)},t.vc=function(){this.Tb()},t.rc=function(){this.status=200,Bo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Wo.prototype.a=null,Wo.prototype.reset=function(t,e,n,i,r){delete this.a},Jo.prototype.toString=function(){return this.name};var Yo=new Jo("SEVERE",1e3),zo=new Jo("WARNING",900),$o=new Jo("CONFIG",700),Zo=new Jo("FINE",500);Xo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c||(e.a?t(e.a):(D("Root logger has no level set."),null))}(this).value)for(v(e)&&(e=e()),t=new Wo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Qo,ta={},ea=null;function na(t){var e,n,i;return ea||(ea=new Xo(""),(ta[""]=ea).c=$o),(e=ta[t])||(e=new Xo(t),i=t.lastIndexOf("."),n=t.substr(i+1),(i=na(t.substr(0,i))).b||(i.b={}),(i.b[n]=e).a=i,ta[t]=e),e}function ia(t,e){t&&t.log(Zo,e,void 0)}function ra(t){this.f=t}function oa(t){fn.call(this),this.u=t,this.h=void 0,this.readyState=aa,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=na("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}w(ra,Vo),ra.prototype.a=function(){return new oa(this.f)},ra.prototype.b=(Qo={},function(){return Qo}),w(oa,fn);var aa=0;function sa(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function ua(t){t.readyState=4,t.g=null,t.c=null,t.m=null,ca(t)}function ca(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ha(t){fn.call(this),this.headers=new wn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=la,this.u=this.S=!1}(t=oa.prototype).open=function(t,e){if(this.readyState!=aa)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,ca(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ua(this)),this.readyState=aa},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,ca(this)),this.a&&(this.readyState=3,ca(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==l.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,sa(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},t.pc=function(t){var e;this.a&&((e=this.m.decode(t.value||new Uint8Array(0),{stream:!t.done}))&&(this.response=this.responseText+=e),(t.done?ua:ca)(this),3==this.readyState&&sa(this))},t.tc=function(t){this.a&&(this.response=this.responseText=t,ua(this))},t.sc=function(t){this.a&&(this.response=t,ua(this))},t.Va=function(t){var e=this.i;e&&e.log(zo,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&ua(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(zo,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(zo,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}for(var t=[],e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(oa.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),w(ha,fn);var la="";ha.prototype.b=na("goog.net.XhrIo");var fa=/^https?$/i,da=["POST","PUT"];function pa(e,t,n,i,r){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.P=n,e.J=!1,e.c=!0,e.a=(e.D||Lo).a(),e.C=e.D?Fo(e.D):Fo(Lo),e.a.onreadystatechange=b(e.Wb,e);try{ia(e.b,Ea(e,"Opening Xhr")),e.N=!0,e.a.open(n,String(t),!0),e.N=!1}catch(t){return ia(e.b,Ea(e,"Error opening Xhr: "+t.message)),void ma(e,t)}t=i||"";var o,a=new wn(e.headers);r&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)V(t,e,void 0);else for(var n=yn(t),i=bn(t),r=i.length,o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}(r,function(t,e){a.set(e,t)}),r=function(t){t:{for(var e=va,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(a.Y()),i=l.FormData&&t instanceof l.FormData,!K(da,n)||r||i||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(t,e){this.a.setRequestHeader(e,t)},e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.S&&(e.a.withCredentials=e.S);try{wa(e),0<e.g&&(e.u=(o=e.a,Ht&&$t(9)&&"number"==typeof o.timeout&&void 0!==o.ontimeout),ia(e.b,Ea(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.u)),e.u?(e.a.timeout=e.g,e.a.ontimeout=b(e.Ma,e)):e.s=mn(e.Ma,e.g,e)),ia(e.b,Ea(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(t){ia(e.b,Ea(e,"Send error: "+t.message)),ma(e,t)}}function va(t){return"content-type"==t.toLowerCase()}function ma(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ga(t),ya(t)}function ga(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ba(e){if(e.c&&void 0!==h)if(e.C[1]&&4==Ia(e)&&2==Ta(e))ia(e.b,Ea(e,"Local request error detected and ignored"));else if(e.i&&4==Ia(e))mn(e.Wb,0,e);else if(e.dispatchEvent("readystatechange"),4==Ia(e)){ia(e.b,Ea(e,"Request complete")),e.c=!1;try{var t,n,i,r,o=Ta(e);t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break t;default:a=!1}if((t=a)||((n=0===o)&&(!(r=String(e.l).match(En)[1]||null)&&l.self&&l.self.location&&(r=(i=l.self.location.protocol).substr(0,i.length-1)),n=!fa.test(r?r.toLowerCase():"")),t=n),t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var s=2<Ia(e)?e.a.statusText:""}catch(t){ia(e.b,"Can not get status: "+t.message),s=""}e.h=s+" ["+Ta(e)+"]",ga(e)}}finally{ya(e)}}}function ya(e,t){if(e.a){wa(e);var n=e.a,i=e.C[0]?a:null;e.a=null,e.C=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){(e=e.b)&&e.log(Yo,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function wa(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(l.clearTimeout(t.s),t.s=null)}function Ia(t){return t.a?t.a.readyState:0}function Ta(t){try{return 2<Ia(t)?t.a.status:-1}catch(t){return-1}}function Ea(t,e){return e+" ["+t.P+" "+t.l+" "+Ta(t)+"]"}function Aa(t){var e=xa;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function ka(t,e,n){t.a=!0,t.c=n,t.f=!e,Oa(t)}function Sa(t){if(t.a){if(!t.v)throw new Ca;t.v=!1}}function Na(t,e,n,i){t.g.push([e,n,i]),t.a&&Oa(t)}function _a(t){return H(t.g,function(t){return v(t[1])})}function Oa(e){var n;e.h&&e.a&&_a(e)&&(i=e.h,(n=Pa[i])&&(l.clearTimeout(n.a),delete Pa[i]),e.h=0),e.b&&(e.b.l--,delete e.b);for(var i=e.c,t=n=!1;e.g.length&&!e.i;){var r=(a=e.g.shift())[0],o=a[1],a=a[2];if(r=e.f?o:r)try{var s=r.call(a||e.s,i);void 0!==s&&(e.f=e.f&&(s==i||s instanceof Error),e.c=i=s),(O(i)||"function"==typeof l.Promise&&i instanceof l.Promise)&&(t=!0,e.i=!0)}catch(t){i=t,e.f=!0,_a(e)||(n=!0)}}e.c=i,t&&(s=b(e.m,e,!0),t=b(e.m,e,!1),i instanceof Aa?(Na(i,s,t),i.C=!0):i.then(s,t)),n&&(i=new Da(i),Pa[i.a]=i,e.h=i.a)}function Ca(){C.call(this)}function Ra(){C.call(this)}function Da(t){this.a=l.setTimeout(b(this.c,this),0),this.b=t}(t=ha.prototype).Ma=function(){void 0!==h&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ia(this.b,Ea(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ia(this.b,Ea(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ya(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ya(this,!0)),ha.bb.Da.call(this)},t.Wb=function(){this.ya||(this.N||this.i||this.f?ba(this):this.Jc())},t.Jc=function(){ba(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case la:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Yo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return ia(this.b,"Can not get response: "+t.message),null}},Aa.prototype.cancel=function(t){var e;this.a?this.c instanceof Aa&&this.c.cancel():(this.b&&(e=this.b,delete this.b,t?e.cancel(t):(e.l--,e.l<=0&&e.cancel())),this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Ra,Sa(this),ka(this,!1,t)))},Aa.prototype.m=function(t,e){this.i=!1,ka(this,t,e)},Aa.prototype.then=function(t,e,n){var i,r,o=new fe(function(t,e){i=t,r=e});return Na(this,i,function(t){t instanceof Ra?o.cancel():r(t)}),o.then(t,e,n)},Aa.prototype.$goog_Thenable=!0,w(Ca,C),Ca.prototype.message="Deferred has already fired",Ca.prototype.name="AlreadyCalledError",w(Ra,C),Ra.prototype.message="Deferred was canceled",Ra.prototype.name="CanceledError",Da.prototype.c=function(){throw delete Pa[this.a],this.b};var Pa={};function La(t){var e=document,n=wt(t).toString(),i=ae(document,"SCRIPT"),r={Xb:i,Ma:void 0},o=new Aa(r),a=window.setTimeout(function(){Ma(i,!0);var t=new Va(Ua,"Timeout reached for loading script "+n);Sa(o),ka(o,!1,t)},5e3);return r.Ma=a,i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ma(i,!1,a),Sa(o),ka(o,!0,null))},i.onerror=function(){Ma(i,!0,a);var t=new Va(ja,"Error while loading script "+n);Sa(o),ka(o,!1,t)},lt(r={},{type:"text/javascript",charset:"UTF-8"}),ee(i,r),r=t,ft(t=i,"HTMLScriptElement"),t.src=wt(r),(r=(r=t.ownerDocument&&t.ownerDocument.defaultView)&&r!=l?f(r.document):s=null===s?f(l.document):s)&&t.setAttribute("nonce",r),((e=((r=e)||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:r.documentElement).appendChild(i),o}function xa(){var t;this&&this.Xb&&((t=this.Xb)&&"SCRIPT"==t.tagName&&Ma(t,!0,this.Ma))}function Ma(t,e,n){null!=n&&l.clearTimeout(n),t.onload=a,t.onerror=a,t.onreadystatechange=a,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var ja=0,Ua=1;function Va(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),C.call(this,n),this.code=t}function Fa(t){this.f=t}function qa(t,e,n){if(this.c=t,this.l=(t=e||{}).secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||Ga,this.g=ct(t.secureTokenHeaders||Ba),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||Wa,this.a=ct(t.firebaseHeaders||Xa),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==li(),!(n=l.XMLHttpRequest||n&&Zl.default.INTERNAL.node&&Zl.default.INTERNAL.node.XMLHttpRequest)&&!hi())throw new T("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,hi()?this.f=new ra(self):fi()?this.f=new Fa(n):this.f=new Ko,this.b=null}w(Va,C),w(Fa,Vo),Fa.prototype.a=function(){return new this.f},Fa.prototype.b=function(){return{}};var Ha,Ka="idToken",Ga=new Ri(3e4,6e4),Ba={"Content-Type":"application/x-www-form-urlencoded"},Wa=new Ri(3e4,6e4),Xa={"Content-Type":"application/json"};function Ja(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Ya(t,e){e&&(t.l=za("https://securetoken.googleapis.com/v1/token",e),t.h=za("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=za("https://identitytoolkit.googleapis.com/v2/",e))}function za(t,e){return t=Cn(t),e=Cn(e.url),t.f=t.a+t.f,kn(t,e.c),t.a=e.a,Sn(t,e.g),t.toString()}function $a(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function Za(t,e,n,i,r,o,a){var s;(t=((s=vi(s=bi())==pi&&(s=s.match(/\sChrome\/(\d+)/i))&&2==s.length?parseInt(s[1],10):null)&&s<30||Ht&&Zt&&!(9<Zt))&&!hi()?(Ha=Ha||new fe(function(t,e){var n,i;n=t,i=e,((window.gapi||{}).client||{}).request?n():(l[ts]=function(){((window.gapi||{}).client||{}).request?n():i(Error("CORS_UNSUPPORTED"))},function(t,e){Na(t,null,e,void 0)}(La(It(Qa,{onload:ts})),function(){i(Error("CORS_UNSUPPORTED"))}))}),b(t.s,t)):b(t.u,t))(e,n,i,r,o,a)}qa.prototype.T=function(){return this.b},qa.prototype.u=function(t,n,e,i,r,o){if(hi()&&(void 0===l.fetch||void 0===l.Headers||void 0===l.Request))throw new T("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a,s=new ha(this.f);o&&(s.g=Math.max(0,o),a=setTimeout(function(){s.dispatchEvent("timeout")},o)),dn(s,"complete",function(){a&&clearTimeout(a);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return ia(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(t){e=null}n&&n(e)}),pn(s,"ready",function(){a&&clearTimeout(a),Me(this)}),pn(s,"timeout",function(){a&&clearTimeout(a),Me(this),n&&n(null)}),pa(s,t,e,i,r)};var Qa=new dt(gt,"https://apis.google.com/js/client.js?onload=%{onload}"),ts="__fcb"+Math.floor(1e6*Math.random()).toString();function es(t,e,n,i,r,o,a){var s=Cn(e+n);_n(s,"key",t.c),a&&_n(s,"cb",Date.now().toString());var u="GET"==i;if(u)for(var c in r)r.hasOwnProperty(c)&&_n(s,c,r[c]);return new fe(function(e,n){Za(t,s.toString(),function(t){t?t.error?n(zs(t,o||{})):e(t):n(new T("network-request-failed"))},i,u?void 0:Jn(Si(r)),t.a,t.v.get())})}function ns(t){if("string"!=typeof(t=t.email)||!ai.test(t))throw new T("invalid-email")}function is(t){"email"in t&&ns(t)}function rs(t){if(!t[Ka]){if(t.mfaPendingCredential)throw new T("multi-factor-auth-required",null,ct(t));throw new T("internal-error")}}function os(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new T("internal-error")}else{if(!t.sessionInfo)throw new T("missing-verification-id");if(!t.code)throw new T("missing-verification-code")}}qa.prototype.s=function(t,n,i,r,o){var a=this;Ha.then(function(){window.gapi.client.setApiKey(a.c);var e=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:i,body:r,headers:o,authType:"none",callback:function(t){window.gapi.auth.setToken(e),n&&n(t)}})}).o(function(t){n&&n({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},qa.prototype.Ab=function(){return Js(this,Ms,{})},qa.prototype.Cb=function(t,e){return Js(this,Ls,{idToken:t,email:e})},qa.prototype.Db=function(t,e){return Js(this,xs,{idToken:t,password:e})};var as={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ss(t){if(!t.phoneVerificationInfo)throw new T("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new T("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new T("missing-verification-code")}function us(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new T("internal-error")}function cs(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(Gn(t=new Fn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function hs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Uo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Uo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Uo(t)):t.errorMessage&&(e=Ys(t.errorMessage)),e)throw e;rs(t)}function ls(t,e){return e.returnIdpCredential=!0,Js(t,Vs,e)}function fs(t,e){return e.returnIdpCredential=!0,Js(t,qs,e)}function ds(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Js(t,Fs,e)}function ps(t){if(!t.oobCode)throw new T("invalid-action-code")}(t=qa.prototype).Eb=function(t,i){var r={idToken:t},o=[];return st(as,function(t,e){var n=i[e];null===n?o.push(t):e in i&&(r[e]=n)}),o.length&&(r.deleteAttribute=o),Js(this,Ls,r)},t.wb=function(t,e){return lt(t={requestType:"PASSWORD_RESET",email:t},e),Js(this,Os,t)},t.xb=function(t,e){return lt(t={requestType:"EMAIL_SIGNIN",email:t},e),Js(this,Ss,t)},t.vb=function(t,e){return lt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Js(this,Ns,t)},t.Fb=function(t,e,n){return lt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Js(this,_s,t)},t.gb=function(t){return Js(this,Gs,t)},t.ob=function(t,e){return Js(this,Ds,{oobCode:t,newPassword:e})},t.Sa=function(t){return Js(this,ms,{oobCode:t})},t.kb=function(t){return Js(this,vs,{oobCode:t})};var vs={endpoint:"setAccountInfo",A:ps,Z:"email",B:!0},ms={endpoint:"resetPassword",A:ps,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new T("internal-error")},B:!0},gs={endpoint:"signupNewUser",A:function(t){if(ns(t),!t.password)throw new T("weak-password")},G:rs,V:!0,B:!0},bs={endpoint:"createAuthUri",B:!0},ys={endpoint:"deleteAccount",O:["idToken"]},ws={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new T("internal-error")}},Is={endpoint:"emailLinkSignin",O:["email","oobCode"],A:ns,G:rs,V:!0,B:!0},Ts={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:ns,G:rs,V:!0},Es={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:ss,G:rs,B:!0,Na:!0},As={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:ss,G:rs,B:!0,Na:!0},ks={endpoint:"getAccountInfo"},Ss={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new T("internal-error");ns(t)},Z:"email",B:!0},Ns={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new T("internal-error")},Z:"email",B:!0},_s={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new T("internal-error")},Z:"email",B:!0},Os={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new T("internal-error");ns(t)},Z:"email",B:!0},Cs={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},Rs={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new T("internal-error")}},Ds={endpoint:"resetPassword",A:ps,Z:"email",B:!0},Ps={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Ls={endpoint:"setAccountInfo",O:["idToken"],A:is,V:!0},xs={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(is(t),!t.password)throw new T("weak-password")},G:rs,V:!0},Ms={endpoint:"signupNewUser",G:rs,V:!0,B:!0},js={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new T("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new T("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new T("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new T("internal-error")},B:!0,Na:!0},Us={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new T("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new T("internal-error")},B:!0,Na:!0},Vs={endpoint:"verifyAssertion",A:us,Za:cs,G:hs,V:!0,B:!0},Fs={endpoint:"verifyAssertion",A:us,Za:cs,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new T("user-not-found");if(t.errorMessage)throw Ys(t.errorMessage);rs(t)},V:!0,B:!0},qs={endpoint:"verifyAssertion",A:function(t){if(us(t),!t.idToken)throw new T("internal-error")},Za:cs,G:hs,V:!0},Hs={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new T("invalid-custom-token")},G:rs,V:!0,B:!0},Ks={endpoint:"verifyPassword",A:function(t){if(ns(t),!t.password)throw new T("wrong-password")},G:rs,V:!0,B:!0},Gs={endpoint:"verifyPhoneNumber",A:os,G:rs,B:!0},Bs={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new T("internal-error");os(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Uo(t);rs(t)}},Ws={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:os,G:rs,B:!0},Xs={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[Ka]^!!t.refreshToken)throw new T("internal-error")},B:!0,Na:!0};function Js(t,e,n){if(!function(t,e){if(!e||!e.length)return 1;if(t){for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return}return 1}}(n,e.O))return we(new T("internal-error"));var i,r=!!e.Na,o=e.Vb||"POST";return ye(n).then(e.A).then(function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),es(t,r?t.i:t.h,e.endpoint,o,n,e.Ib,e.mb||!1)}).then(function(t){return i=t,e.Za?e.Za(n,i):i}).then(e.G).then(function(){if(!e.Z)return i;if(!(e.Z in i))throw new T("internal-error");return i[e.Z]})}function Ys(t){return zs({error:{errors:[{message:t}],code:400,message:t}})}function zs(t,e){var n,i=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(i=r[i]?new T(r[i]):null)return i;for(n in i=t.error&&t.error.message||"",lt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=i.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===i.indexOf(n))return new T(r[n],e);return new T("internal-error",e=!e&&t?ki(t):e)}function $s(t){var o;this.b=t,this.a=null,this.sb=(o=this,(eu=eu||new fe(function(t,e){function n(){Ci(),yi("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Ci(),e(Error("Network Error"))},timeout:Qs.get()})}var i;yi("gapi.iframes.Iframe")?t():yi("gapi.load")?n():(i="__iframefcb"+Math.floor(1e6*Math.random()).toString(),l[i]=function(){yi("gapi.load")?n():e(Error("Network Error"))},ye(La(i=It(Zs,{onload:i}))).o(function(){e(Error("Network Error"))}))}).o(function(t){throw eu=null,t})).then(function(){return new fe(function(i,r){yi("gapi.iframes.getContext")().open({where:document.body,url:o.b,messageHandlersFilter:yi("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(t){function e(){clearTimeout(n),i()}o.a=t,o.a.restyle({setHideOnLeave:!1});var n=setTimeout(function(){r(Error("Network Error"))},tu.get());t.ping(e).then(e,function(){r(Error("Network Error"))})})})}))}var Zs=new dt(gt,"https://apis.google.com/js/api.js?onload=%{onload}"),Qs=new Ri(3e4,6e4),tu=new Ri(5e3,15e3),eu=null;function nu(t,e,n,i){this.l=t,this.h=e,this.i=n,this.g=i,this.f=null,t=this.g?Rn((t=Cn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):Rn("https",this.l,null,"/__/auth/iframe"),this.a=t,_n(this.a,"apiKey",this.h),_n(this.a,"appName",this.i),this.b=null,this.c=[]}function iu(t,e,n,i,r,o){this.u=t,this.s=e,this.c=n,this.m=i,this.v=o,this.i=this.g=this.l=null,this.a=r,this.h=this.f=null}function ru(t){try{return Zl.default.app(t).auth().Ga()}catch(t){return[]}}function ou(t,e,n,i,r,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=i||null,this.i=r||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function au(t){var s=ti();return Js(t,Cs,{}).then(function(t){return t.authorizedDomains||[]}).then(function(t){t:{for(var e=(n=Cn(s)).c,n=n.a,i=0;i<t.length;i++){var r=t[i],o=n,a=e;if(o=0==r.indexOf("chrome-extension://")?Cn(r).a==o&&"chrome-extension"==a:("http"==a||"https"==a)&&(oi.test(r)?o==r:(r=r.split(".").join("\\."),new RegExp("^(.+\\."+r+"|"+r+")$","i").test(o)))){t=!0;break t}}t=!1}if(!t)throw new Mo(ti())})}function su(r){return r.m||(r.m=si().then(function(){var t,e,n,i;r.u||(t=r.c,e=r.i,n=ru(r.b),(i=new nu(r.s,r.g,r.b,r.f)).f=t,i.b=e,i.c=X(n||[]),r.u=i.toString()),r.v=new $s(r.u),function(i){if(!i.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.sb.then(function(){t.a.register("authEvent",e,yi("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(i.v,function(t){var e={};if(t&&t.authEvent){var n=!1;for(t=Do(t.authEvent),e=0;e<i.h.length;e++)n=i.h[e](t)||n;return(e={}).status=n?"ACK":"ERROR",ye(e)}return e.status="ERROR",ye(e)})}(r)}),r.m)}function uu(t){return t.l||(t.C=t.c?gi(t.c,ru(t.b)):null,t.l=new qa(t.g,_(t.i),t.C),t.f&&Ya(t.l,t.f)),t.l}function cu(t,e,n,i,r,o,a,s,u,c,h,l){return(t=new iu(t,e,n,i,r,l)).l=o,t.g=a,t.i=s,t.b=ct(u||null),t.f=c,t.zb(h).toString()}function hu(t){if(this.a=t||Zl.default.INTERNAL.reactNative&&Zl.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new T("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function lu(t){this.b=t,this.a={},this.f=b(this.c,this)}nu.prototype.toString=function(){return this.f?_n(this.a,"v",this.f):Kn(this.a.b,"v"),this.b?_n(this.a,"eid",this.b):Kn(this.a.b,"eid"),this.c.length?_n(this.a,"fw",this.c.join(",")):Kn(this.a.b,"fw"),this.a.toString()},iu.prototype.zb=function(t){return this.h=t,this},iu.prototype.toString=function(){var t;if(_n(t=this.v?Rn((t=Cn(this.v.url)).c,t.a,t.g,"/emulator/auth/handler"):Rn("https",this.u,null,"/__/auth/handler"),"apiKey",this.s),_n(t,"appName",this.c),_n(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=Zl.default.app(this.c).auth().la()}catch(t){n=null}for(i in e.pb=n,_n(t,"providerId",this.a.providerId),e=Si((n=this.a).Jb))e[i]=e[i].toString();for(var i=n.Qc,e=ct(e),r=0;r<i.length;r++){var o=i[r];o in e&&delete e[o]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),ut(e)||_n(t,"customParameters",ki(e))}if("function"==typeof this.a.Rb&&((n=this.a.Rb()).length&&_n(t,"scopes",n.join(","))),this.l?_n(t,"redirectUrl",this.l):Kn(t.b,"redirectUrl"),this.g?_n(t,"eventId",this.g):Kn(t.b,"eventId"),this.i?_n(t,"v",this.i):Kn(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!On(t,a)&&_n(t,a,this.b[a]);return this.h?_n(t,"tid",this.h):Kn(t.b,"tid"),this.f?_n(t,"eid",this.f):Kn(t.b,"eid"),(a=ru(this.c)).length&&_n(t,"fw",a.join(",")),t.toString()},(t=ou.prototype).Pb=function(e,n,t){var i=new T("popup-closed-by-user"),r=new T("web-storage-unsupported"),o=this,a=!1;return this.ma().then(function(){var t,i;i={type:"webStorageSupport"},su(t=o).then(function(){return e=t.v,n=i,e.sb.then(function(){return new fe(function(t){e.a.send(n.type,n,t,yi("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})});var e,n}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}).then(function(t){t||(e&&ii(e),n(r),a=!0)})}).o(function(){}).then(function(){if(!a)return n=e,new fe(function(e){return function t(){gn(2e3).then(function(){return n&&!n.closed?t():void e()})}()});var n}).then(function(){if(!a)return gn(t).then(function(){n(i)})})},t.Yb=function(){var t=bi();return!Ai(t)&&!Oi(t)},t.Ub=function(){return!1},t.Nb=function(e,t,n,i,r,o,a,s){if(!e)return we(new T("popup-blocked"));if(a&&!Ai())return this.ma().o(function(t){ii(e),r(t)}),i(),ye();this.a||(this.a=au(uu(this)));var u=this;return this.a.then(function(){var t=u.ma().o(function(t){throw ii(e),r(t),t});return i(),t}).then(function(){Co(n),a||ei(cu(u.s,u.g,u.b,t,n,null,o,u.c,void 0,u.i,s,u.f),e)}).o(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},t.Ob=function(t,e,n,i){this.a||(this.a=au(uu(this)));var r=this;return this.a.then(function(){Co(e),ei(cu(r.s,r.g,r.b,t,e,ti(),n,r.c,void 0,r.i,i,r.f))}).o(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ma=function(){var t=this;return su(this).then(function(){return t.v.sb}).o(function(){throw t.a=null,new T("network-request-failed")})},t.ac=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ta=function(e){B(this.h,function(t){return t==e})},(t=hu.prototype).get=function(t){return ye(this.a.getItem(t)).then(function(t){return t&&Ni(t)})},t.set=function(t,e){return ye(this.a.setItem(t,ki(e)))},t.U=function(t){return ye(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var fu,du=[];function pu(t,e,n){ut(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function vu(t){this.a=t}function mu(t){this.c=t,this.b=!1,this.a=[]}function gu(i,t,e,n){var r,o,a,s,u=e||{},c=null;if(i.b)return we(Error("connection_unavailable"));var h=n?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new fe(function(e,n){l?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout(function(){n(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){n(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?e(t.data.response):n(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),n(Error("invalid_response"))))}},i.a.push(c),l.port1.addEventListener("message",o),i.c.postMessage({eventType:t,eventId:r,data:u},[l.port2])):n(Error("connection_unavailable"))}).then(function(t){return bu(i,c),t}).o(function(t){throw bu(i,c),t})}function bu(t,e){var n,i;e&&(n=e.messageChannel,i=e.onMessage,n&&(n.port1.removeEventListener("message",i),n.port1.close()),B(t.a,function(t){return t==e}))}function yu(){if(!Eu())throw new T("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=l.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t,e,n,i=this;hi()&&self?(this.v=(n=hi()?self:null,V(du,function(t){t.b==n&&(e=t)}),e||(e=new lu(n),du.push(e)),e),pu(this.v,"keyChanged",function(t,n){return _u(i).then(function(e){return 0<e.length&&V(i.a,function(t){t(e)}),{keyProcessed:K(e,n.key)}})}),pu(this.v,"ping",function(){return ye(["keyChanged"])})):((t=l.navigator)&&t.serviceWorker?ye().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).o(function(){return null}):ye(null)).then(function(t){(i.h=t)&&(i.g=new mu(new vu(t)),gu(i.g,"ping",null,!0).then(function(t){t[0].fulfilled&&K(t[0].value,"keyChanged")&&(i.s=!0)}).o(function(){}))})}function wu(r){return new fe(function(e,n){var t=r.m.open("firebaseLocalStorageDb",1);t.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},t.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},t.onsuccess=function(t){var i;(t=t.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(t):(i=r,new fe(function(t,e){var n=i.m.deleteDatabase("firebaseLocalStorageDb");n.onsuccess=function(){t()},n.onerror=function(t){e(Error(t.target.error))}}).then(function(){return wu(r)}).then(function(t){e(t)}).o(function(t){n(t)}))}})}function Iu(t){return t.i||(t.i=wu(t)),t.i}function Tu(r,t){var o=0;return new fe(function e(n,i){Iu(r).then(t).then(n).o(function(t){return 3<++o?void i(t):Iu(r).then(function(t){return t.close(),r.i=void 0,e(n,i)}).o(function(t){i(t)})})})}function Eu(){try{return l.indexedDB}catch(t){return}}function Au(t){return t.objectStore("firebaseLocalStorage")}function ku(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Su(t){return new fe(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Nu(t,e){return t.g&&t.h&&((n=l.navigator)&&n.serviceWorker&&n.serviceWorker.controller||null)===t.h?gu(t.g,"keyChanged",{key:e},t.s).then(function(){}).o(function(){}):ye();var n}function _u(i){return Iu(i).then(function(t){var r=Au(ku(t,!1));return r.getAll?Su(r.getAll()):new fe(function(e,n){var i=[],t=r.openCursor();t.onsuccess=function(t){(t=t.target.result)?(i.push(t.value),t.continue()):e(i)},t.onerror=function(t){n(t.target.error)}})}).then(function(t){var e={},n=[];if(0==i.b){for(n=0;n<t.length;n++)e[t[n].fbase_key]=t[n].value;n=function t(e,n){var i,r=[];for(i in e)i in n&&typeof e[i]==typeof n[i]?"object"==typeof e[i]&&null!=e[i]&&null!=n[i]?0<t(e[i],n[i]).length&&r.push(i):e[i]!==n[i]&&r.push(i):r.push(i);for(i in n)i in e||r.push(i);return r}(i.c,e),i.c=e}return n})}function Ou(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Cu(t){var i=this,r=null;this.a=[],this.type="indexedDB",this.c=t,this.b=ye().then(function(){if(Eu()){var e=_i(),n="__sak"+e;return fu=fu||new yu,(r=fu).set(n,e).then(function(){return r.get(n)}).then(function(t){if(t!==e)throw Error("indexedDB not supported!");return r.U(n)}).then(function(){return r}).o(function(){return i.c})}return i.c}).then(function(t){return i.type=t.type,t.ca(function(e){V(i.a,function(t){t(e)})}),t})}function Ru(){this.a={},this.type="inMemory"}function Du(){if(!function(){var t="Node"==li();if(!(t=Pu()||t&&Zl.default.INTERNAL.node&&Zl.default.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==li())throw new T("internal-error","The LocalStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=Pu()||Zl.default.INTERNAL.node.localStorage,this.type="localStorage"}function Pu(){try{var t=l.localStorage,e=_i();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Lu(){this.type="nullStorage"}function xu(){if(!function(){var t="Node"==li();if(!(t=Mu()||t&&Zl.default.INTERNAL.node&&Zl.default.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==li())throw new T("internal-error","The SessionStorage compatibility library was not found.");throw new T("web-storage-unsupported")}this.a=Mu()||Zl.default.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Mu(){try{var t=l.sessionStorage,e=_i();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function ju(){var t={};t.Browser=Fu,t.Node=qu,t.ReactNative=Hu,t.Worker=Ku,this.a=t[li()]}lu.prototype.c=function(n){var e,i=n.data.eventType,r=n.data.eventId,t=this.a[i];t&&0<t.length&&(n.ports[0].postMessage({status:"ack",eventId:r,eventType:i,response:null}),e=[],V(t,function(t){e.push(ye().then(function(){return t(n.origin,n.data.data)}))}),Te(e).then(function(t){var e=[];V(t,function(t){e.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})}),V(e,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:e})}))},vu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},mu.prototype.close=function(){for(;0<this.a.length;)bu(this,this.a[0]);this.b=!0},(t=yu.prototype).set=function(i,r){var o=this,a=!1;return Tu(this,function(t){return Su((t=Au(ku(t,!0))).get(i))}).then(function(n){return Tu(o,function(t){if(t=Au(ku(t,!0)),n)return n.value=r,Su(t.put(n));o.b++,a=!0;var e={};return e.fbase_key=i,e.value=r,Su(t.add(e))})}).then(function(){return o.c[i]=r,Nu(o,i)}).oa(function(){a&&o.b--})},t.get=function(e){return Tu(this,function(t){return Su(Au(ku(t,!1)).get(e))}).then(function(t){return t&&t.value})},t.U=function(e){var n=this,i=!1;return Tu(this,function(t){return i=!0,n.b++,Su(Au(ku(t,!0)).delete(e))}).then(function(){return delete n.c[e],Nu(n,e)}).oa(function(){i&&n.b--})},t.ca=function(t){var n;0==this.a.length&&(Ou(n=this),function e(){n.f=setTimeout(function(){n.l=_u(n).then(function(e){0<e.length&&V(n.a,function(t){t(e)})}).then(function(){e()}).o(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()),this.a.push(t)},t.ia=function(e){B(this.a,function(t){return t==e}),0==this.a.length&&Ou(this)},(t=Cu.prototype).get=function(e){return this.b.then(function(t){return t.get(e)})},t.set=function(e,n){return this.b.then(function(t){return t.set(e,n)})},t.U=function(e){return this.b.then(function(t){return t.U(e)})},t.ca=function(t){this.a.push(t)},t.ia=function(e){B(this.a,function(t){return t==e})},(t=Ru.prototype).get=function(t){return ye(this.a[t])},t.set=function(t,e){return this.a[t]=e,ye()},t.U=function(t){return delete this.a[t],ye()},t.ca=function(){},t.ia=function(){},(t=Du.prototype).get=function(t){var e=this;return ye().then(function(){return Ni(e.a.getItem(t))})},t.set=function(e,n){var i=this;return ye().then(function(){var t=ki(n);null===t?i.U(e):i.a.setItem(e,t)})},t.U=function(t){var e=this;return ye().then(function(){e.a.removeItem(t)})},t.ca=function(t){l.window&&Qe(l.window,"storage",t)},t.ia=function(t){l.window&&nn(l.window,"storage",t)},(t=Lu.prototype).get=function(){return ye(null)},t.set=function(){return ye()},t.U=function(){return ye()},t.ca=function(){},t.ia=function(){},(t=xu.prototype).get=function(t){var e=this;return ye().then(function(){return Ni(e.a.getItem(t))})},t.set=function(e,n){var i=this;return ye().then(function(){var t=ki(n);null===t?i.U(e):i.a.setItem(e,t)})},t.U=function(t){var e=this;return ye().then(function(){e.a.removeItem(t)})},t.ca=function(){},t.ia=function(){};var Uu,Vu,Fu={F:Du,cb:xu},qu={F:Du,cb:xu},Hu={F:hu,cb:Lu},Ku={F:Du,cb:Lu},Gu={rd:"local",NONE:"none",td:"session"};function Bu(){var t=!(Oi(bi())||!ci()),e=Ai(),n=wi();this.m=t,this.h=e,this.l=n,this.a={},t=Uu=Uu||new ju;try{this.g=!Qn()&&xi()||!l.indexedDB?new t.a.F:new Cu(new(hi()?Ru:t.a.F))}catch(t){this.g=new Ru,this.h=!0}try{this.i=new t.a.cb}catch(t){this.i=new Ru}this.v=new Ru,this.f=b(this.Zb,this),this.b={}}function Wu(){return Vu=Vu||new Bu}function Xu(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function Ju(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Yu(t,e,n){return n=Ju(e,n),"local"==e.F&&(t.b[n]=null),Xu(t,e.F).U(n)}function zu(t){t.c&&(clearInterval(t.c),t.c=null)}function $u(t){this.a=t,this.b=Wu()}(t=Bu.prototype).get=function(t,e){return Xu(this,t.F).get(Ju(t,e))},t.set=function(e,t,n){var i=Ju(e,n),r=this,o=Xu(this,e.F);return o.set(i,t).then(function(){return o.get(i)}).then(function(t){"local"==e.F&&(r.b[i]=t)})},t.addListener=function(t,e,n){var i;t=Ju(t,e),this.l&&(this.b[t]=l.localStorage.getItem(t)),ut(this.a)&&(Xu(this,"local").ca(this.f),this.h||(Qn()||!xi())&&l.indexedDB||!this.l||(zu(i=this),i.c=setInterval(function(){for(var t in i.a){var e=l.localStorage.getItem(t),n=i.b[t];e!=n&&(i.b[t]=e,e=new He({type:"storage",key:t,target:window,oldValue:n,newValue:e,a:!0}),i.Zb(e))}},1e3))),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Ju(t,e),this.a[t]&&(B(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),ut(this.a)&&(Xu(this,"local").ia(this.f),zu(this))},t.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var i=this.b[n];void 0===i&&(i=null);var r=l.localStorage.getItem(n);r!==i&&(this.b[n]=r,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Xu(this,"local").ia(this.f):zu(this),this.m)if(n=l.localStorage.getItem(e),(i=t.a.newValue)!==n)null!==i?l.localStorage.setItem(e,i):l.localStorage.removeItem(e);else if(this.b[e]===i&&void 0===t.a.a)return;var o=this,n=function(){void 0===t.a.a&&o.b[e]===l.localStorage.getItem(e)||(o.b[e]=l.localStorage.getItem(e),o.nb(e))};Ht&&Zt&&10==Zt&&l.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else V(t,b(this.nb,this))},t.nb=function(t){this.a[t]&&V(this.a[t],function(t){t()})};var Zu,Qu={name:"authEvent",F:"local"};function tc(){this.a=Wu()}function ec(t,e){this.b=nc,this.f=l.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=l.Int32Array?new Int32Array(64):Array(64),void 0===Zu&&(Zu=l.Int32Array?new Int32Array(cc):cc),this.reset()}w(ec,function(){this.b=-1});for(var nc=64,ic=nc-1,rc=[],oc=0;oc<ic;oc++)rc[oc]=0;var ac=W(128,rc);function sc(t){for(var e=t.f,n=t.l,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;e<64;e++){var r=0|n[e-15],i=0|n[e-2],o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.a[0],r=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;e<64;e++){var f=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|Zu[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=r,r=i,i=a+f|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function uc(t,e,n){void 0===n&&(n=e.length);var i=0,r=t.c;if("string"==typeof e)for(;i<n;)t.f[r++]=e.charCodeAt(i++),r==t.b&&(sc(t),r=0);else{if(!p(e))throw Error("message must be string or array");for(;i<n;){var o=e[i++];if(!("number"==typeof o&&0<=o&&o<=255&&o==(0|o)))throw Error("message must be a byte array");t.f[r++]=o,r==t.b&&(sc(t),r=0)}}t.c=r,t.g+=n}ec.prototype.reset=function(){this.g=this.c=0,this.a=l.Int32Array?new Int32Array(this.h):X(this.h)};var cc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function hc(){ec.call(this,8,lc)}w(hc,ec);var lc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function fc(t,e,n,i,r,o){this.v=t,this.i=e,this.l=n,this.m=i||null,this.u=r||null,this.s=o,this.h=e+":"+n,this.C=new tc,this.g=new $u(this.h),this.f=null,this.b=[],this.a=this.c=null}function dc(t){return new T("invalid-cordova-configuration",t)}function pc(t){var e=new hc;uc(e,t),t=[];var n=8*e.g;e.c<56?uc(e,ac,56-e.c):uc(e,ac,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(sc(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return q(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}function vc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function mc(s){return s.f||(s.f=s.ma().then(function(){return new fe(function(n){function e(i){t=!0,a&&a.cancel(),gc(r).then(function(t){var e,n=o;t&&i&&i.url&&(e=null,n=(e=-1!=(n=Yr(i.url)).indexOf("/__/auth/callback")?(e="object"==typeof(e=Ni(On(e=Cn(n),"firebaseError")||null))?E(e):null)?new Ro(t.c,t.b,null,null,e,null,t.T()):new Ro(t.c,t.b,n,t.f,null,null,t.T()):e)||o),vc(r,n)})}var r,o,t,a,i;s.Ea(function t(e){return n(e),s.Ta(t),!1}),r=s,o=new Ro("unknown",null,null,null,new T("no-auth-event")),t=!1,a=gn(500).then(function(){return gc(r).then(function(){t||vc(r,o)})}),i=l.handleOpenURL,l.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(yi("BuildInfo.packageName",l).toLowerCase()+"://")&&e({url:t}),"function"==typeof i)try{i(t)}catch(t){console.error(t)}},xo=xo||new Po,function(t){var n=xo;n.a.push(t),n.b||(n.b=function(t){for(var e=0;e<n.a.length;e++)n.a[e](t)},"function"==typeof(t=yi("universalLinks.subscribe",l))&&t(null,n.b))}(e)})})),s.f}function gc(e){var t,n=null;return(t=e.g).b.get(Qu,t.a).then(Do).then(function(t){return n=t,Yu((t=e.g).b,Qu,t.a)}).then(function(){return n})}function bc(t){this.a=t,this.b=Wu()}(t=fc.prototype).ma=function(){return this.Ia||(this.Ia=(ui(void 0)?si().then(function(){return new fe(function(t,e){var n=l.document,i=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(i),t()},!1)})}):we(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof yi("universalLinks.subscribe",l))throw dc("cordova-universal-links-plugin-fix is not installed");if(void 0===yi("BuildInfo.packageName",l))throw dc("cordova-plugin-buildinfo is not installed");if("function"!=typeof yi("cordova.plugins.browsertab.openUrl",l))throw dc("cordova-plugin-browsertab is not installed");if("function"!=typeof yi("cordova.InAppBrowser.open",l))throw dc("cordova-plugin-inappbrowser is not installed")},function(){throw new T("cordova-not-ready")}))},t.Pb=function(t,e){return e(new T("operation-not-supported-in-this-environment")),ye()},t.Nb=function(){return we(new T("operation-not-supported-in-this-environment"))},t.ac=function(){return!1},t.Yb=function(){return!0},t.Ub=function(){return!0},t.Ob=function(t,e,n,i){if(this.c)return we(new T("redirect-operation-pending"));var r=this,o=l.document,a=null,s=null,u=null,c=null;return this.c=ye().then(function(){return Co(e),mc(r)}).then(function(){return function(n,t,e,i,r){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Ro(t,i,null,o,new T("no-auth-event"),null,r),s=yi("BuildInfo.packageName",l);if("string"!=typeof s)throw new T("invalid-cordova-configuration");var u=yi("BuildInfo.displayName",l),c={};if(bi().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!bi().toLowerCase().match(/android/))return we(new T("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),o=pc(o),c.sessionId=o;var h=cu(n.v,n.i,n.l,t,e,null,i,n.m,c,n.u,r,n.s);return n.ma().then(function(){var t=n.h;return n.C.a.set(Qu,a.w(),t)}).then(function(){var t=yi("cordova.plugins.browsertab.isAvailable",l);if("function"!=typeof t)throw new T("invalid-cordova-configuration");var e=null;t(function(t){if(t){if("function"!=typeof(e=yi("cordova.plugins.browsertab.openUrl",l)))throw new T("invalid-cordova-configuration");e(h)}else{if("function"!=typeof(e=yi("cordova.InAppBrowser.open",l)))throw new T("invalid-cordova-configuration");t=bi(),n.a=e(h,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n,i)}).then(function(){return new fe(function(e,t){s=function(){var t=yi("cordova.plugins.browsertab.close",l);return e(),"function"==typeof t&&t(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.Ea(s),u=function(){a=a||gn(2e3).then(function(){t(new T("redirect-cancelled-by-user"))})},c=function(){Di()&&u()},o.addEventListener("resume",u,!1),bi().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).o(function(t){return gc(r).then(function(){throw t})})}).oa(function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&r.Ta(s),r.c=null})},t.Ea=function(e){this.b.push(e),mc(this).o(function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new Ro("unknown",null,null,null,new T("no-auth-event")),e(t))})},t.Ta=function(e){B(this.b,function(t){return t==e})};var yc={name:"pendingRedirect",F:"session"};function wc(t){return Yu(t.b,yc,t.a)}function Ic(t,e,n,i){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=i,this.h=[],this.f=!1,this.l=b(this.s,this),this.b=new Mc,this.C=new qc,this.g=new bc(Lc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Tc(this.D,this.v,this.m,A,this.J)}function Tc(t,e,n,i,r){var o=Zl.default.SDK_VERSION||null;return new(ui()?fc:ou)(t,e,n,o,i,r)}function Ec(e){e.f||(e.f=!0,e.a.Ea(e.l));var n=e.a;return e.a.ma().o(function(t){throw e.a==n&&e.reset(),t})}function Ac(n){n.a.Yb()&&Ec(n).o(function(t){var e=new Ro("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Cc(t)&&n.s(e)}),n.a.Ub()||jc(n.b)}function kc(n,t){K(n.h,t)||n.h.push(t),n.f||(t=n.g).b.get(yc,t.a).then(function(t){return"pending"==t}).then(function(t){t?wc(n.g).then(function(){Ec(n).o(function(t){var e=new Ro("unknown",null,null,null,new T("operation-not-supported-in-this-environment"));Cc(t)&&n.s(e)})}):Ac(n)}).o(function(){Ac(n)})}function Sc(t,e){B(t.h,function(t){return t==e})}Ic.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Tc(this.D,this.v,this.m,null,this.J),this.i={}},Ic.prototype.s=function(t){if(!t)throw new T("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,i),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return jc(this.b),e};var Nc=new Ri(2e3,1e4),_c=new Ri(3e4,6e4);function Oc(t,e,n,i,r,o,a){return t.a.Nb(e,n,i,function(){t.f||(t.f=!0,t.a.Ea(t.l))},function(){t.reset()},r,o,a)}function Cc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Rc(e,t,n,i,r){var o,a;return(a=e.g).b.set(yc,"pending",a.a).then(function(){return e.a.Ob(t,n,i,r).o(function(t){if(Cc(t))throw new T("operation-not-supported-in-this-environment");return o=t,wc(e.g).then(function(){throw o})}).then(function(){return e.a.ac()?new fe(function(){}):wc(e.g).then(function(){return e.ra()}).then(function(){}).o(function(){})})})}function Dc(t,e,n,i,r){return t.a.Pb(i,function(t){e.na(n,null,t,r)},Nc.get())}Ic.prototype.ra=function(){return this.b.ra()};var Pc={};function Lc(t,e,n){return t=t+":"+e,t=n?t+":"+n.url:t}function xc(t,e,n,i){var r=Lc(e,n,i);return Pc[r]||(Pc[r]=new Ic(t,e,n,i)),Pc[r]}function Mc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function jc(t){t.g||(t.g=!0,Fc(t,!1,null,null))}function Uc(t){t.g&&!t.i&&Fc(t,!1,null,null)}function Vc(t,e){if(t.b=function(){return ye(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Fc(t,e,n,i){e?i?function(t,e){if(t.b=function(){return we(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):Vc(t,n):Vc(t,{user:null}),t.f=[],t.c=[]}function qc(){}function Hc(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function Kc(t,e){this.a=e,Fi(this,"verificationId",t)}function Gc(t,e,n,i){return new No(t).gb(e,n).then(function(t){return new Kc(t,i)})}function Bc(t){var e=xr(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new T("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");qi(this,{token:t,expirationTime:Li(1e3*e.exp),authTime:Li(1e3*e.auth_time),issuedAtTime:Li(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Wc(t,e,n){var i=e&&e[Jc];if(!i)throw new T("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=ct(e),this.g=n,this.c=new zr(null,i),this.b=[];var r=this;V(e[Xc]||[],function(t){(t=Bi(t))&&r.b.push(t)}),Fi(this,"auth",this.a),Fi(this,"session",this.c),Fi(this,"hints",this.b)}Mc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Mc.prototype.h=function(t,e){var n,i,r,o;t?(this.reset(),this.g=!0,n=t.c,i=t.b,r=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code,this.i=!(!r&&!o),"unknown"!=n||r||o?t.a?(Fc(this,!0,null,t.a),ye()):e.Fa(n,i)?function(e,t,n){n=n.Fa(t.c,t.b);var i=t.g,r=t.f,o=t.i,a=t.T(),s=!!t.c.match(/Redirect$/);n(i,r,a,o).then(function(t){Fc(e,s,t,null)}).o(function(t){Fc(e,s,null,t)})}(this,t,e):we(new T("invalid-auth-event")):(Fc(this,!1,null,null),ye())):we(new T("invalid-auth-event"))},Mc.prototype.ra=function(){var r=this;return new fe(function(t,e){var n,i;r.b?r.b().then(t,e):(r.f.push(t),r.c.push(e),n=r,i=new T("timeout"),n.a&&n.a.cancel(),n.a=gn(_c.get()).then(function(){n.b||(n.g=!0,Fc(n,!0,null,i))}))})},qc.prototype.h=function(t,e){var n,i,r,o,a;t?(n=t.c,i=t.b,t.a?(e.na(t.c,null,t.a,t.b),ye()):e.Fa(n,i)?(r=e,o=(t=t).b,a=t.c,r.Fa(a,o)(t.g,t.f,t.T(),t.i).then(function(t){r.na(a,t,null,o)}).o(function(t){r.na(a,null,t,o)})):we(new T("invalid-auth-event"))):we(new T("invalid-auth-event"))},Kc.prototype.confirm=function(t){return t=_o(this.verificationId,t),this.a(t)};var Xc="mfaInfo",Jc="mfaPendingCredential";function Yc(t,e,n,i){T.call(this,"multi-factor-auth-required",i,e),this.b=new Wc(t,e,n),Fi(this,"resolver",this.b)}function zc(t,e,n){if(t&&m(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Yc(e,t.serverResponse,n,t.message)}catch(t){}return null}function $c(){}function Zc(t){Fi(this,"factorId",t.fa),this.a=t}function Qc(t){if(Zc.call(this,t),this.a.fa!=No.PROVIDER_ID)throw new T("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function th(t,e){for(var n in qe.call(this,t),e)this[n]=e[n]}function eh(t,e){this.a=t,this.b=[],this.c=b(this.yc,this),Qe(this.a,"userReloaded",this.c);var i=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&V(e.multiFactor.enrolledFactors,function(t){var e=null,n={};if(t){t.uid&&(n[Ji]=t.uid),t.displayName&&(n[Wi]=t.displayName),t.enrollmentTime&&(n[Xi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(n[Yi]=t.phoneNumber);try{e=new zi(n)}catch(t){}t=e}else t=null;t&&i.push(t)}),nh(this,i)}function nh(t,e){t.b=e,Fi(t,"enrolledFactors",e)}function ih(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function rh(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}function oh(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function ah(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function sh(t,e){t.b=Lr(e[Ka]||""),t.a=e.refreshToken,ah(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function uh(e,t){return i=e.f,r=t,new fe(function(e,n){"refresh_token"==r.grant_type&&r.refresh_token||"authorization_code"==r.grant_type&&r.code?Za(i,i.l+"?key="+encodeURIComponent(i.c),function(t){t?t.error?n(zs(t)):t.access_token&&t.refresh_token?e(t):n(new T("internal-error")):n(new T("network-request-failed"))},"POST",Hn(r).toString(),i.g,i.m.get()):n(new T("internal-error"))}).then(function(t){return e.b=Lr(t.access_token),e.a=t.refresh_token,ah(e,t.expires_in),{accessToken:e.b.toString(),refreshToken:e.a}}).o(function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t});var i,r}function ch(t,e){this.a=t||null,this.b=e||null,qi(this,{lastSignInTime:Li(e||null),creationTime:Li(t||null)})}function hh(t,e,n,i,r,o){qi(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})}function lh(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i,r=Zl.default.SDK_VERSION?gi(Zl.default.SDK_VERSION):null;this.a=new qa(this.l,_(A),r),(this.u=t.emulatorConfig||null)&&Ya(this.a,this.u),this.h=new oh(this.a),wh(this,e[Ka]),sh(this.h,e),Fi(this,"refreshToken",this.h.a),Eh(this,n||{}),fn.call(this),this.P=!1,this.s&&Ii()&&(this.b=xc(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=(i=this,new ih(function(){return i.I(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var t=i.h.c-Date.now()-3e5;return 0<t?t:0})),this.ba=b(this.ib,this);var o=this;this.za=null,this.Pa=function(t){o.xa(t.h)},this.qa=null,this.Ba=function(t){fh(o,t.c)},this.$=null,this.aa=[],this.Oa=function(t){vh(o,t.f)},this.ja=null,this.S=new eh(this,n),Fi(this,"multiFactor",this.S)}function fh(t,e){t.u=e,Ya(t.a,e),t.b&&(e=t.b,t.b=xc(t.s,t.l,t.m,t.u),t.P&&(Sc(e,t),kc(t.b,t)))}function dh(t,e){t.qa&&nn(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&Qe(e,"languageCodeChanged",t.Pa)}function ph(t,e){t.$&&nn(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&Qe(e,"emulatorConfigChanged",t.Ba)}function vh(t,e){t.aa=e,$a(t.a,Zl.default.SDK_VERSION?gi(Zl.default.SDK_VERSION,t.aa):null)}function mh(t,e){t.ja&&nn(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&Qe(e,"frameworkChanged",t.Oa)}function gh(e){try{return Zl.default.app(e.m).auth()}catch(t){throw new T("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function bh(t){t.J||t.D.b||(t.D.start(),nn(t,"tokenChanged",t.ba),Qe(t,"tokenChanged",t.ba))}function yh(t){nn(t,"tokenChanged",t.ba),t.D.stop()}function wh(t,e){t.Aa=e,Fi(t,"_lat",e)}function Ih(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return Te(e).then(function(){return t})}function Th(t){t.b&&!t.P&&(t.P=!0,kc(t.b,t))}function Eh(t,e){qi(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new ch(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Ah(){}function kh(t){return ye().then(function(){if(t.J)throw new T("app-deleted")})}function Sh(t){return q(t.providerData,function(t){return t.providerId})}function Nh(t,e){e&&(_h(t,e.providerId),t.providerData.push(e))}function _h(t,e){B(t.providerData,function(t){return t.providerId==e})}function Oh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Fi(t,e,n)}function Ch(e,t){var n,i;e!=t&&(qi(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,tenantId:t.tenantId,providerData:[]}),t.metadata?Fi(e,"metadata",new ch((i=t.metadata).a,i.b)):Fi(e,"metadata",new ch),V(t.providerData,function(t){Nh(e,t)}),n=e.h,i=t.h,n.b=i.b,n.a=i.a,n.c=i.c,Fi(e,"refreshToken",e.h.a),nh(e.S,t.S.b))}function Rh(i){return i.I().then(function(t){var e,n=i.isAnonymous;return Js((e=i).a,ks,{idToken:t}).then(b(e.Kc,e)).then(function(){return n||Oh(i,"isAnonymous",!1),t})})}function Dh(t,e){e[Ka]&&t.Aa!=e[Ka]&&(sh(t.h,e),t.dispatchEvent(new th("tokenChanged")),wh(t,e[Ka]),Oh(t,"refreshToken",t.h.a))}function Ph(t,e){return Rh(t).then(function(){if(K(Sh(t),e))return Ih(t).then(function(){throw new T("provider-already-linked")})})}function Lh(t,e,n){return Hi({user:t,credential:Oo(e),additionalUserInfo:e=Fr(e),operationType:n})}function xh(t,e){return Dh(t,e),t.reload().then(function(){return t})}function Mh(n,i,t,e,r){if(!Ii())return we(new T("operation-not-supported-in-this-environment"));if(n.i&&!r)return we(n.i);var o=Vr(t.providerId),a=_i(n.uid+":::"),s=null,u=ri(s=(!Ai()||ci())&&n.s&&t.isOAuthProvider?cu(n.s,n.l,n.m,i,t,null,a,Zl.default.SDK_VERSION||null,null,null,n.tenantId,n.u):s,o&&o.va,o&&o.ua);return e=e().then(function(){if(Uh(n),!r)return n.I().then(function(){})}).then(function(){return Oc(n.b,u,i,t,a,!!s,n.tenantId)}).then(function(){return new fe(function(t,e){n.na(i,null,new T("cancelled-popup-request"),n.g||null),n.f=t,n.C=e,n.g=a,n.c=Dc(n.b,n,i,u,a)})}).then(function(t){return u&&ii(u),t?Hi(t):null}).o(function(t){throw u&&ii(u),t}),Vh(n,e,r)}function jh(e,t,n,i,r){if(!Ii())return we(new T("operation-not-supported-in-this-environment"));if(e.i&&!r)return we(e.i);var o=null,a=_i(e.uid+":::");return i=i().then(function(){if(Uh(e),!r)return e.I().then(function(){})}).then(function(){return e.ga=a,Ih(e)}).then(function(t){return t=e.ha?(t=e.ha).b.set(Hh,e.w(),t.a):t}).then(function(){return Rc(e.b,t,n,a,e.tenantId)}).o(function(t){if(o=t,e.ha)return Kh(e.ha);throw o}).then(function(){if(o)throw o}),Vh(e,i,r)}function Uh(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new T("internal-error");throw new T("auth-domain-config-required")}}function Vh(n,t,e){var i,r=(t=t,e=e,(i=n).i&&!e?(t.cancel(),we(i.i)):t.o(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(i.i||i.dispatchEvent(new th("userInvalidated")),i.i=t),t}));return n.N.push(r),r.oa(function(){G(n.N,r)}),r.o(function(t){var e=null;throw(e=t&&"auth/multi-factor-auth-required"===t.code?zc(t.w(),gh(n),b(n.jc,n)):e)||t})}function Fh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Ka]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var i=t.stsTokenManager.expirationTime;i&&(n.expiresIn=(i-Date.now())/1e3);var r=new lh(e,n,t);return t.providerData&&V(t.providerData,function(t){t&&Nh(r,Hi(t))}),t.redirectEventId&&(r.ga=t.redirectEventId),r}function qh(t){this.a=t,this.b=Wu()}Wc.prototype.Rc=function(t){var n=this;return t.tb(this.a.a,this.c).then(function(t){var e=ct(n.f);return delete e[Xc],delete e[Jc],lt(e,t),n.g(e)})},w(Yc,T),$c.prototype.tb=function(t,e,n){return e.type==$r?(o=this,a=t,s=n,e.Ha().then(function(t){return t={idToken:t},void 0!==s&&(t.displayName=s),lt(t,{phoneVerificationInfo:So(o.a)}),Js(a,Es,t)})):(i=this,r=t,e.Ha().then(function(t){return lt(t={mfaPendingCredential:t},{phoneVerificationInfo:So(i.a)}),Js(r,As,t)}));var i,r,o,a,s},w(Zc,$c),w(Qc,Zc),w(th,qe),(t=eh.prototype).yc=function(t){var e;nh(this,(t=t.hd,e=[],V(t.mfaInfo||[],function(t){(t=Bi(t))&&e.push(t)}),e))},t.Sb=function(){return this.a.I().then(function(t){return new zr(t,null)})},t.fc=function(e,n){var i=this,r=this.a.a;return this.Sb().then(function(t){return e.tb(r,t,n)}).then(function(t){return Dh(i.a,t),i.a.reload()})},t.bd=function(t){var n=this,i="string"==typeof t?t:t.uid,e=this.a.a;return this.a.I().then(function(t){return Js(e,Xs,{idToken:t,mfaEnrollmentId:i})}).then(function(t){var e=F(n.b,function(t){return t.uid!=i});return nh(n,e),Dh(n.a,t),n.a.reload().o(function(t){if("auth/user-token-expired"!=t.code)throw t})})},t.w=function(){return{multiFactor:{enrolledFactors:q(this.b,function(t){return t.w()})}}},ih.prototype.start=function(){this.a=this.c,function e(n,t){n.stop();n.b=gn(rh(n,t)).then(Pi).then(function(){return n.h()}).then(function(){e(n,!0)}).o(function(t){n.i(t)&&e(n,!1)})}(this,!0)},ih.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},oh.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},oh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?we(new T("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?uh(this,{grant_type:"refresh_token",refresh_token:this.a}):ye(null):ye({accessToken:this.b.toString(),refreshToken:this.a})},ch.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},w(lh,fn),lh.prototype.xa=function(t){this.za=t,Ja(this.a,t)},lh.prototype.la=function(){return this.za},lh.prototype.Ga=function(){return X(this.aa)},lh.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},Fi(lh.prototype,"providerId","firebase"),(t=lh.prototype).reload=function(){var t=this;return Vh(this,kh(this).then(function(){return Rh(t).then(function(){return Ih(t)}).then(Ah)}))},t.oc=function(t){return this.I(t).then(function(t){return new Bc(t)})},t.I=function(t){var e=this;return Vh(this,kh(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new T("internal-error");return t.accessToken!=e.Aa&&(wh(e,t.accessToken),e.dispatchEvent(new th("tokenChanged"))),Oh(e,"refreshToken",t.refreshToken),t.accessToken}))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new T("internal-error");Eh(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e,n=(e=(e=t).providerUserInfo)&&e.length?q(e,function(t){return new hh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[],i=0;i<n.length;i++)Nh(this,n[i]);Oh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new th("userReloaded",{hd:t}))},t.Lc=function(t){return Ui("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},t.ub=function(t){var e=this,n=null;return Vh(this,t.c(this.a,this.uid).then(function(t){return Dh(e,t),n=Lh(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},t.Cc=function(t){return Ui("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},t.rb=function(e){var n=this,i=null;return Vh(this,Ph(this,e.providerId).then(function(){return n.I()}).then(function(t){return e.b(n.a,t)}).then(function(t){return i=Lh(n,t,"link"),xh(n,t)}).then(function(){return i}))},t.Dc=function(t,e){var n=this;return Vh(this,Ph(this,"phone").then(function(){return Gc(gh(n),t,e,b(n.rb,n))}))},t.Mc=function(t,e){var n=this;return Vh(this,ye().then(function(){return Gc(gh(n),t,e,b(n.ub,n))}),!0)},t.Cb=function(e){var n=this;return Vh(this,this.I().then(function(t){return n.a.Cb(t,e)}).then(function(t){return Dh(n,t),n.reload()}))},t.ed=function(e){var n=this;return Vh(this,this.I().then(function(t){return e.b(n.a,t)}).then(function(t){return Dh(n,t),n.reload()}))},t.Db=function(e){var n=this;return Vh(this,this.I().then(function(t){return n.a.Db(t,e)}).then(function(t){return Dh(n,t),n.reload()}))},t.Eb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return kh(this);var n=this;return Vh(this,this.I().then(function(t){return n.a.Eb(t,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(t){return Dh(n,t),Oh(n,"displayName",t.displayName||null),Oh(n,"photoURL",t.photoUrl||null),V(n.providerData,function(t){"password"===t.providerId&&(Fi(t,"displayName",n.displayName),Fi(t,"photoURL",n.photoURL))}),Ih(n)}).then(Ah))},t.cd=function(e){var n=this;return Vh(this,Rh(this).then(function(t){return K(Sh(n),e)?Js(n.a,ws,{idToken:t,deleteProvider:[e]}).then(function(t){var e={};return V(t.providerUserInfo||[],function(t){e[t.providerId]=!0}),V(Sh(n),function(t){e[t]||_h(n,t)}),e[No.PROVIDER_ID]||Fi(n,"phoneNumber",null),Ih(n)}):Ih(n).then(function(){throw new T("no-such-provider")})}))},t.delete=function(){var e=this;return Vh(this,this.I().then(function(t){return Js(e.a,ys,{idToken:t})}).then(function(){e.dispatchEvent(new th("userDeleted"))})).then(function(){for(var t=0;t<e.N.length;t++)e.N[t].cancel("app-deleted");dh(e,null),ph(e,null),mh(e,null),e.N=[],e.J=!0,yh(e),Fi(e,"refreshToken",null),e.b&&Sc(e.b,e)})},t.Gb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?b(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?b(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?b(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?b(this.Mb,this):null},t.Ec=function(t){var e=this;return Mh(this,"linkViaPopup",t,function(){return Ph(e,t.providerId).then(function(){return Ih(e)})},!1)},t.Nc=function(t){return Mh(this,"reauthViaPopup",t,function(){return ye()},!0)},t.Fc=function(t){var e=this;return jh(this,"linkViaRedirect",t,function(){return Ph(e,t.providerId)},!1)},t.Oc=function(t){return jh(this,"reauthViaRedirect",t,function(){return ye()},!0)},t.Lb=function(e,n,t,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return t=this.I().then(function(t){return fs(r.a,{requestUri:e,postBody:i,sessionId:n,idToken:t})}).then(function(t){return o=Lh(r,t,"link"),xh(r,t)}).then(function(){return o}),Vh(this,t)},t.Mb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Vh(this,ye().then(function(){return to(ds(r.a,{requestUri:t,sessionId:e,postBody:i,tenantId:n}),r.uid)}).then(function(t){return o=Lh(r,t,"reauthenticate"),Dh(r,t),r.i=null,r.reload()}).then(function(){return o}),!0)},t.vb=function(e){var n=this,i=null;return Vh(this,this.I().then(function(t){return i=t,void 0===e||ut(e)?{}:Cr(new wr(e))}).then(function(t){return n.a.vb(i,t)}).then(function(t){if(n.email!=t)return n.reload()}).then(function(){}))},t.Fb=function(e,n){var i=this,r=null;return Vh(this,this.I().then(function(t){return r=t,void 0===n||ut(n)?{}:Cr(new wr(n))}).then(function(t){return i.a.Fb(r,e,t)}).then(function(t){if(i.email!=t)return i.reload()}).then(function(){}))},t.jc=function(t){var e=null,n=this;return Vh(this,t=to(ye(t),n.uid).then(function(t){return e=Lh(n,t,"reauthenticate"),Dh(n,t),n.i=null,n.reload()}).then(function(){return e}),!0)},t.toJSON=function(){return this.w()},t.w=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&lt(e,this.metadata.w()),V(this.providerData,function(t){e.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(t))}),lt(e,this.S.w()),e};var Hh={name:"redirectUser",F:"session"};function Kh(t){return Yu(t.b,Hh,t.a)}function Gh(t){var e,n,i,r;this.a=t,this.b=Wu(),this.c=null,this.f=(n=Xh("local"),i=Xh("session"),r=Xh("none"),function(n,i,r){var o=Ju(i,r),a=Xu(n,i.F);return n.get(i,r).then(function(t){var e=null;try{e=Ni(l.localStorage.getItem(o))}catch(t){}if(e&&!t)return l.localStorage.removeItem(o),n.set(i,e,r);e&&t&&"localStorage"!=a.type&&l.localStorage.removeItem(o)})}((e=this).b,n,e.a).then(function(){return e.b.get(i,e.a)}).then(function(t){return t?i:e.b.get(r,e.a).then(function(t){return t?r:e.b.get(n,e.a).then(function(t){return t?n:e.b.get(Wh,e.a).then(function(t){return t?Xh(t):n})})})}).then(function(t){return e.c=t,Bh(e,t.F)}).o(function(){e.c||(e.c=n)})),this.b.addListener(Xh("local"),this.a,b(this.g,this))}function Bh(t,e){var n,s,i=[];for(n in Gu)Gu[n]!==e&&i.push(Yu(t.b,Xh(Gu[n]),t.a));return i.push(Yu(t.b,Wh,t.a)),s=i,new fe(function(n,e){var i=s.length,r=[];if(i)for(var t=function(t,e){i--,r[t]=e,0==i&&n(r)},o=function(t){e(t)},a=0;a<s.length;a++)Ie(s[a],y(t,a),o);else n(r)})}Gh.prototype.g=function(){var e=this,n=Xh("local");$h(this,function(){return ye().then(function(){return e.c&&"local"!=e.c.F?e.b.get(n,e.a):null}).then(function(t){if(t)return Bh(e,"local").then(function(){e.c=n})})})};var Wh={name:"persistence",F:"session"};function Xh(t){return{name:"authUser",F:t}}function Jh(t,e){return $h(t,function(){return t.b.set(t.c,e.w(),t.a)})}function Yh(t){return $h(t,function(){return Yu(t.b,t.c,t.a)})}function zh(t,e,n){return $h(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Fh(t||{})})})}function $h(t,e){return t.f=t.f.then(e,e),t.f}function Zh(t){if(this.l=!1,Fi(this,"settings",new Hc),Fi(this,"app",t),!this.app.options||!this.app.options.apiKey)throw new T("invalid-api-key");var n,e,i,r,o,a;t=Zl.default.SDK_VERSION?gi(Zl.default.SDK_VERSION):null,this.a=new qa(this.app.options&&this.app.options.apiKey,_(A),t),this.P=[],this.s=[],this.N=[],this.Pa=Zl.default.INTERNAL.createSubscribe(b(this.zc,this)),this.W=void 0,this.ib=Zl.default.INTERNAL.createSubscribe(b(this.Ac,this)),ol(this,null),this.i=new Gh(this.app.options.apiKey+":"+this.app.name),this.D=new qh(this.app.options.apiKey+":"+this.app.name),this.$=hl(this,(e=(n=this).app.options.authDomain,t=function(e){var t=function(t,e){return t.b.get(Hh,t.a).then(function(t){return t&&e&&(t.authDomain=e),Fh(t||{})})}(e.D,e.app.options.authDomain).then(function(t){return(e.m=t)&&(t.ha=e.D),Kh(e.D)});return hl(e,t)}(n).then(function(){return zh(n.i,e,n.R)}).then(function(e){return e?(e.ha=n.D,n.m&&(n.m.ga||null)==(e.ga||null)?e:e.reload().then(function(){return Jh(n.i,e).then(function(){return e})}).o(function(t){return"auth/network-request-failed"==t.code?e:Yh(n.i)})):null}).then(function(t){ol(n,t||null)}),hl(n,t))),this.h=hl(this,(i=this).$.then(function(){return il(i)}).o(function(){}).then(function(){if(!i.l)return i.ja()}).o(function(){}).then(function(){var t;i.l||(i.ba=!0,(t=i.i).b.addListener(Xh("local"),t.a,i.ja))})),this.ba=!1,this.ja=b(this.Zc,this),this.Ba=b(this.da,this),this.qa=b(this.mc,this),this.za=b(this.wc,this),this.Aa=b(this.xc,this),this.b=null,o=(r=this).app.options.authDomain,a=r.app.options.apiKey,o&&Ii()&&(r.Oa=r.$.then(function(){var t;if(!r.l)return r.b=xc(o,a,r.app.name,r.R),kc(r.b,r),sl(r)&&Th(sl(r)),r.m&&(Th(r.m),(t=r.m).xa(r.la()),dh(t,r),vh(t=r.m,r.J),mh(t,r),fh(t=r.m,r.R),ph(t,r),r.m=null),r.b})),this.INTERNAL={},this.INTERNAL.delete=b(this.delete,this),this.INTERNAL.logFramework=b(this.Gc,this),this.u=0,fn.call(this),t=this,Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){var t;return t=this.R?Hi({protocol:(t=Cn(this.R.url)).c,host:t.a,port:t.g,options:Hi({disableWarnings:this.R.ec})}):null},enumerable:!1}),this.J=[],this.R=null}function Qh(t){qe.call(this,"languageCodeChanged"),this.h=t}function tl(t){qe.call(this,"emulatorConfigChanged"),this.c=t}function el(t){qe.call(this,"frameworkChanged"),this.f=t}function nl(t){return t.Oa||we(new T("auth-domain-config-required"))}function il(t){if(!Ii())return we(new T("operation-not-supported-in-this-environment"));var e=nl(t).then(function(){return t.b.ra()}).then(function(t){return t?Hi(t):null});return hl(t,e)}function rl(o,a){var s={};return s.apiKey=o.app.options.apiKey,s.authDomain=o.app.options.authDomain,s.appName=o.app.name,o.R&&(s.emulatorConfig=o.R),o.$.then(function(){return t=s,e=a,n=o.D,i=o.Ga(),r=new lh(t,e),n&&(r.ha=n),i&&vh(r,i),r.reload().then(function(){return r});var t,e,n,i,r}).then(function(t){return sl(o)&&t.uid==sl(o).uid?Ch(sl(o),t):(ol(o,t),Th(t)),o.da(t)}).then(function(){cl(o)})}function ol(t,e){var n,i;sl(t)&&(n=sl(t),i=t.Ba,B(n.W,function(t){return t==i}),nn(sl(t),"tokenChanged",t.qa),nn(sl(t),"userDeleted",t.za),nn(sl(t),"userInvalidated",t.Aa),yh(sl(t))),e&&(e.W.push(t.Ba),Qe(e,"tokenChanged",t.qa),Qe(e,"userDeleted",t.za),Qe(e,"userInvalidated",t.Aa),0<t.u&&bh(e)),Fi(t,"currentUser",e),e&&(e.xa(t.la()),dh(e,t),vh(e,t.J),mh(e,t),fh(e,t.R),ph(e,t))}function al(n,t){var e=null,i=null;return hl(n,t.then(function(t){return e=Oo(t),i=Fr(t),rl(n,t)},function(t){var e=null;throw(e=t&&"auth/multi-factor-auth-required"===t.code?zc(t.w(),n,b(n.kc,n)):e)||t}).then(function(){return Hi({user:sl(n),credential:e,additionalUserInfo:i,operationType:"signIn"})}))}function sl(t){return t.currentUser}function ul(t){return sl(t)&&sl(t)._lat||null}function cl(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](ul(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](ul(t))}}function hl(t,e){return t.P.push(e),e.oa(function(){G(t.P,e)}),e}function ll(){}function fl(){this.a={},this.b=1e12}Gh.prototype.yb=function(e){var n=null,i=this;return function(t){var e=new T("invalid-persistence-type"),n=new T("unsupported-persistence-type");t:{for(i in Gu)if(Gu[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(li()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Eu()&&"none"!==t)throw n;break;default:if(!wi()&&"none"!==t)throw n}}(e),$h(this,function(){return e!=i.c.F?i.b.get(i.c,i.a).then(function(t){return n=t,Bh(i,e)}).then(function(){if(i.c=Xh(e),n)return i.b.set(i.c,n,i.a)}):ye()})},w(Zh,fn),w(Qh,qe),w(tl,qe),w(el,qe),(t=Zh.prototype).yb=function(t){return t=this.i.yb(t),hl(this,t)},t.xa=function(t){this.aa===t||this.l||(this.aa=t,Ja(this.a,this.aa),this.dispatchEvent(new Qh(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=l.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.R){if(!/^https?:\/\//.test(t))throw new T("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");e=!!e&&!!e.disableWarnings,n=e,"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),l.document&&!n&&si().then(function(){var t=l.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),l.document.body.appendChild(t)}),this.R={url:t,ec:e},this.settings.jb=!0,Ya(this.a,this.R),this.dispatchEvent(new tl(this.R))}var n},t.Gc=function(t){this.J.push(t),$a(this.a,Zl.default.SDK_VERSION?gi(Zl.default.SDK_VERSION,this.J):null),this.dispatchEvent(new el(this.J))},t.Ga=function(){return X(this.J)},t.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:this.app.options.apiKey,authDomain:this.app.options.authDomain,appName:this.app.name,currentUser:sl(this)&&sl(this).w()}},t.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,i){"signInViaPopup"==t&&this.g==i&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?b(this.ic,this):null},t.ic=function(t,e,n,i){var r=this,o={requestUri:t,postBody:i,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),r.$.then(function(){return al(r,ls(r.a,o))})},t.Xc=function(e){if(!Ii())return we(new T("operation-not-supported-in-this-environment"));var n=this,t=Vr(e.providerId),i=_i(),r=null,o=ri(r=(!Ai()||ci())&&this.app.options.authDomain&&e.isOAuthProvider?cu(this.app.options.authDomain,this.app.options.apiKey,this.app.name,"signInViaPopup",e,null,i,Zl.default.SDK_VERSION||null,null,null,this.T(),this.R):r,t&&t.va,t&&t.ua);return hl(this,t=nl(this).then(function(t){return Oc(t,o,"signInViaPopup",e,i,!!r,n.T())}).then(function(){return new fe(function(t,e){n.na("signInViaPopup",null,new T("cancelled-popup-request"),n.g),n.f=t,n.C=e,n.g=i,n.c=Dc(n.b,n,"signInViaPopup",o,i)})}).then(function(t){return o&&ii(o),t?Hi(t):null}).o(function(t){throw o&&ii(o),t}))},t.Yc=function(t){if(!Ii())return we(new T("operation-not-supported-in-this-environment"));var e=this;return hl(this,nl(this).then(function(){return $h(t=e.i,function(){return t.b.set(Wh,t.c.F,t.a)});var t}).then(function(){return Rc(e.b,"signInViaRedirect",t,void 0,e.T())}))},t.ra=function(){var e=this;return il(this).then(function(t){return e.b&&Uc(e.b.b),t}).o(function(t){throw e.b&&Uc(e.b.b),t})},t.dd=function(t){if(!t)return we(new T("null-user"));if(this.S!=t.tenantId)return we(new T("tenant-id-mismatch"));var e=this,n={};n.apiKey=this.app.options.apiKey,n.authDomain=this.app.options.authDomain,n.appName=this.app.name;var i,r,o,a,s,u=(i=t,r=n,o=e.D,a=e.Ga(),s=i.h,(n={})[Ka]=s.b&&s.b.toString(),n.refreshToken=s.a,r=new lh(r||{apiKey:i.l,authDomain:i.s,appName:i.m},n),o&&(r.ha=o),a&&vh(r,a),Ch(r,i),r);return hl(this,this.h.then(function(){if(e.app.options.apiKey!=t.l)return u.reload()}).then(function(){return sl(e)&&t.uid==sl(e).uid?(Ch(sl(e),t),e.da(t)):(ol(e,u),Th(u),e.da(u))}).then(function(){cl(e)}))},t.Bb=function(){var t=this,e=this.h.then(function(){return t.b&&Uc(t.b.b),sl(t)?(ol(t,null),Yh(t.i).then(function(){cl(t)})):ye()});return hl(this,e)},t.Zc=function(){var i=this;return zh(this.i,this.app.options.authDomain).then(function(t){if(!i.l){var e,n;if((e=sl(i)&&t)&&(e=sl(i).uid,n=t.uid,e=null!=e&&""!==e&&null!=n&&""!==n&&e==n),e)return Ch(sl(i),t),sl(i).I();(sl(i)||t)&&(ol(i,t),t&&(Th(t),t.ha=i.D),i.b&&kc(i.b,i),cl(i))}})},t.da=function(t){return Jh(this.i,t)},t.mc=function(){cl(this),this.da(sl(this))},t.wc=function(){this.Bb()},t.xc=function(){this.Bb()},t.kc=function(t){var e=this;return this.h.then(function(){return al(e,ye(t))})},t.zc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(sl(e))})},t.Ac=function(t){var e,n,i=this;n=function(){t.next(sl(i))},(e=this).N.push(n),hl(e,e.h.then(function(){!e.l&&K(e.N,n)&&e.W!==e.getUid()&&(e.W=e.getUid(),n(ul(e)))}))},t.Ic=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof t?t(sl(i)):"function"==typeof t.next&&t.next(sl(i))}),this.Pa(t,e,n)},t.Hc=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then(function(){i.W=i.getUid(),"function"==typeof t?t(sl(i)):"function"==typeof t.next&&t.next(sl(i))}),this.ib(t,e,n)},t.nc=function(t){var e=this,n=this.h.then(function(){return sl(e)?sl(e).I(t).then(function(t){return{accessToken:t}}):null});return hl(this,n)},t.Tc=function(t){var n=this;return this.h.then(function(){return al(n,Js(n.a,Hs,{token:t}))}).then(function(t){var e=t.user;return Oh(e,"isAnonymous",!1),n.da(e),t})},t.Uc=function(t,e){var n=this;return this.h.then(function(){return al(n,Js(n.a,Ks,{email:t,password:e}))})},t.dc=function(t,e){var n=this;return this.h.then(function(){return al(n,Js(n.a,gs,{email:t,password:e}))})},t.ab=function(t){var e=this;return this.h.then(function(){return al(e,t.ka(e.a))})},t.Sc=function(t){return Ui("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},t.Ab=function(){var n=this;return this.h.then(function(){var t=sl(n);if(t&&t.isAnonymous){var e=Hi({providerId:null,isNewUser:!1});return Hi({user:t,credential:null,additionalUserInfo:e,operationType:"signIn"})}return al(n,n.a.Ab()).then(function(t){var e=t.user;return Oh(e,"isAnonymous",!0),n.da(e),t})})},t.getUid=function(){return sl(this)&&sl(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&sl(this)&&bh(sl(this))},t.Pc=function(e){var n=this;V(this.s,function(t){t==e&&n.u--}),this.u<0&&(this.u=0),0==this.u&&sl(this)&&yh(sl(this)),this.removeAuthTokenListener(e)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),hl(this,this.h.then(function(){e.l||K(e.s,t)&&t(ul(e))}))},t.removeAuthTokenListener=function(e){B(this.s,function(t){return t==e})},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(Xh("local"),t.a,this.ja),this.b&&(Sc(this.b,this),Uc(this.b.b)),Promise.resolve()},t.hc=function(t){return hl(this,Js(this.a,bs,{identifier:t,continueUri:Ti()?ti():"http://localhost"}).then(function(t){return t.signinMethods||[]}))},t.Bc=function(t){return!!Eo(t)},t.xb=function(e,n){var i=this;return hl(this,ye().then(function(){var t=new wr(n);if(!t.c)throw new T("argument-error",Er+" must be true when sending sign in link to email");return Cr(t)}).then(function(t){return i.a.xb(e,t)}).then(function(){}))},t.jd=function(t){return this.Sa(t).then(function(t){return t.data.email})},t.ob=function(t,e){return hl(this,this.a.ob(t,e).then(function(){}))},t.Sa=function(t){return hl(this,this.a.Sa(t).then(function(t){return new $i(t)}))},t.kb=function(t){return hl(this,this.a.kb(t).then(function(){}))},t.wb=function(e,t){var n=this;return hl(this,ye().then(function(){return void 0===t||ut(t)?{}:Cr(new wr(t))}).then(function(t){return n.a.wb(e,t)}).then(function(){}))},t.Wc=function(t,e){return hl(this,Gc(this,t,e,b(this.ab,this)))},t.Vc=function(n,i){var r=this;return hl(this,ye().then(function(){var t=i||ti(),e=To(n,t);if(!(t=Eo(t)))throw new T("argument-error","Invalid email link!");if(t.tenantId!==r.T())throw new T("tenant-id-mismatch");return r.ab(e)}))},ll.prototype.render=function(){},ll.prototype.reset=function(){},ll.prototype.getResponse=function(){},ll.prototype.execute=function(){};var dl=null;function pl(t,e){return(e=vl(e))&&t.a[e]||null}function vl(t){return(t=void 0===t?1e12:t)?t.toString():null}function ml(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=te(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():Qe(this.f,"click",this.i)}function gl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function bl(){}function yl(){}fl.prototype.render=function(t,e){return this.a[this.b.toString()]=new ml(t,e),this.b++},fl.prototype.reset=function(t){var e=pl(this,t);t=vl(t),e&&t&&(e.delete(),delete this.a[t])},fl.prototype.getResponse=function(t){return(t=pl(this,t))?t.getResponse():null},fl.prototype.execute=function(t){(t=pl(this,t))&&t.execute()},ml.prototype.getResponse=function(){return gl(this),this.b},ml.prototype.execute=function(){gl(this);var n=this;this.a||(this.a=setTimeout(function(){n.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var t=n.c.callback,e=n.c["expired-callback"];if(t)try{t(n.b)}catch(t){}n.a=setTimeout(function(){if(n.a=null,n.b=null,e)try{e()}catch(t){}n.h&&n.execute()},6e4)},500))},ml.prototype.delete=function(){gl(this),this.g=!0,clearTimeout(this.a),this.a=null,nn(this.f,"click",this.i)},Fi(bl,"FACTOR_ID","phone"),yl.prototype.g=function(){return ye(dl=dl||new fl)},yl.prototype.c=function(){};var wl=null;function Il(){this.b=l.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Tl=new dt(gt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),El=new Ri(3e4,6e4);Il.prototype.g=function(r){var o=this;return new fe(function(t,e){var i=setTimeout(function(){e(new T("network-request-failed"))},El.get());!l.grecaptcha||r!==o.f&&!o.b?(l[o.a]=function(){var n;l.grecaptcha?(o.f=r,n=l.grecaptcha.render,l.grecaptcha.render=function(t,e){return t=n(t,e),o.b++,t},clearTimeout(i),t(l.grecaptcha)):(clearTimeout(i),e(new T("internal-error"))),delete l[o.a]},ye(La(It(Tl,{onload:o.a,hl:r||""}))).o(function(){clearTimeout(i),e(new T("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),t(l.grecaptcha))})},Il.prototype.c=function(){this.b--};var Al=null;function kl(t,e,n,i,r,o,a){if(Fi(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,a=a?wl=wl||new yl:Al=Al||new Il,this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[_l])throw new T("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Ol],!l.document)throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!te(e)||!this.i&&te(e).hasChildNodes())throw new T("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new qa(t,o||null,r||null),this.u=i||function(){return null};var s=this;this.l=[];var u=this.a[Sl];this.a[Sl]=function(t){var e;Cl(s,t),"function"==typeof u?u(t):"string"!=typeof u||"function"==typeof(e=yi(u,l))&&e(t)};var c=this.a[Nl];this.a[Nl]=function(){var t;Cl(s,null),"function"==typeof c?c():"string"!=typeof c||"function"==typeof(t=yi(c,l))&&t()}}var Sl="callback",Nl="expired-callback",_l="sitekey",Ol="size";function Cl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Rl(t,e){return t.h.push(e),e.oa(function(){G(t.h,e)}),e}function Dl(t){if(t.J)throw new T("internal-error","RecaptchaVerifier instance has been destroyed.")}function Pl(t,e,n){var i=!1;try{this.b=n||Zl.default.app()}catch(t){throw new T("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new T("invalid-api-key");n=this.b.options.apiKey;var r=this,o=null;try{o=this.b.auth().Ga()}catch(t){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=Zl.default.SDK_VERSION?gi(Zl.default.SDK_VERSION,o):null,kl.call(this,n,t,e,function(){try{var e=r.b.auth().la()}catch(t){e=null}return e},o,_(A),i)}function Ll(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new T("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].M(n[r])&&!o){if(e=e[r],r<0||r>=xl.length)throw new T("internal-error","Argument validator received an unsupported number of arguments.");n=xl[r],i=(i?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}i=null}}if(i)throw new T("argument-error",t+" failed: "+i)}(t=kl.prototype).Ia=function(){var e=this;return this.f||(this.f=Rl(this,ye().then(function(){if(Ti()&&!hi())return si();throw new T("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return e.m.g(e.u())}).then(function(t){return e.g=t,Js(e.s,Rs,{})}).then(function(t){e.a[_l]=t.recaptchaSiteKey}).o(function(t){throw e.f=null,t})))},t.render=function(){Dl(this);var n=this;return Rl(this,this.Ia().then(function(){var t,e;return null===n.c&&(e=n.v,n.i||(t=te(e),e=oe("DIV"),t.appendChild(e)),n.c=n.g.render(e,n.a)),n.c}))},t.verify=function(){Dl(this);var r=this;return Rl(this,this.render().then(function(e){return new fe(function(n){var i,t=r.g.getResponse(e);t?n(t):(r.l.push(i=function(t){var e;t&&(e=i,B(r.l,function(t){return t==e}),n(t))}),r.i&&r.g.execute(r.c))})}))},t.reset=function(){Dl(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Dl(this),this.J=!0,this.m.c();for(var t,e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=te(this.v);for(;t=e.firstChild;)e.removeChild(t)}},w(Pl,kl);var xl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ml(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function jl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Ul(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:m}}function Vl(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function Fl(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function ql(n){return{name:n?n+"Credential":"credential",K:n?"a valid "+n+" credential":"a valid credential",optional:!1,M:function(t){if(!t)return!1;var e=!n||t.providerId===n;return!(!t.ka||!e)}}}function Hl(){return{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}}function Kl(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}}function Gl(t,e){return m(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Bl(t){return m(t)&&"string"==typeof t.uid}function Wl(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}}function Xl(e,n,t,i){return{name:t||"",K:e.K+" or "+n.K,optional:!!i,M:function(t){return e.M(t)||n.M(t)}}}function Jl(t,e){for(var n in e){var i=e[n].name;t[i]=$l(i,t[n],e[n].j)}}function Yl(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:y(function(t){return this[t]},n),set:y(function(t,e,n,i){Ll(t,[n],[i],!0),this[e]=i},i,n,e[n].lb),enumerable:!0})}}function zl(t,e,n,i){t[e]=$l(e,n,i)}function $l(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return Ll(o,n,t),e.apply(this,t)}if(!n)return e;var r,o=(t=(t=t).split("."))[t.length-1];for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}Jl(Zh.prototype,{kb:{name:"applyActionCode",j:[Ml("code")]},Sa:{name:"checkActionCode",j:[Ml("code")]},ob:{name:"confirmPasswordReset",j:[Ml("code"),Ml("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Ml("email"),Ml("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Ml("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Ml("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Xl(Ul(),Vl(),"nextOrObserver"),Vl("opt_error",!0),Vl("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Xl(Ul(),Vl(),"nextOrObserver"),Vl("opt_error",!0),Vl("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Ml("email"),Xl(Ul("opt_actionCodeSettings",!0),Fl(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Ml("email"),Ul("actionCodeSettings")]},yb:{name:"setPersistence",j:[Ml("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[ql()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[ql()]},Tc:{name:"signInWithCustomToken",j:[Ml("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Ml("email"),Ml("password")]},Vc:{name:"signInWithEmailLink",j:[Ml("email"),Ml("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Ml("phoneNumber"),Wl()]},Xc:{name:"signInWithPopup",j:[Kl()]},Yc:{name:"signInWithRedirect",j:[Kl()]},dd:{name:"updateCurrentUser",j:[Xl({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof lh)}},Fl(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ml(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Ml("url"),Ul("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Ml("code")]}}),Yl(Zh.prototype,{lc:{name:"languageCode",lb:Xl(Ml(),Fl(),"languageCode")},ti:{name:"tenantId",lb:Xl(Ml(),Fl(),"tenantId")}}),(Zh.Persistence=Gu).LOCAL="local",Zh.Persistence.SESSION="session",Zh.Persistence.NONE="none",Jl(lh.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[jl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[jl("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[ql()]},rb:{name:"linkWithCredential",j:[ql()]},Dc:{name:"linkWithPhoneNumber",j:[Ml("phoneNumber"),Wl()]},Ec:{name:"linkWithPopup",j:[Kl()]},Fc:{name:"linkWithRedirect",j:[Kl()]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ql()]},ub:{name:"reauthenticateWithCredential",j:[ql()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Ml("phoneNumber"),Wl()]},Nc:{name:"reauthenticateWithPopup",j:[Kl()]},Oc:{name:"reauthenticateWithRedirect",j:[Kl()]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[Xl(Ul("opt_actionCodeSettings",!0),Fl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ml(null,!0)]},cd:{name:"unlink",j:[Ml("provider")]},Cb:{name:"updateEmail",j:[Ml("email")]},Db:{name:"updatePassword",j:[Ml("password")]},ed:{name:"updatePhoneNumber",j:[ql("phone")]},Eb:{name:"updateProfile",j:[Ul("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Ml("email"),Xl(Ul("opt_actionCodeSettings",!0),Fl(null,!0),"opt_actionCodeSettings",!0)]}}),Jl(fl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jl(ll.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jl(fe.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Yl(Hc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:jl("appVerificationDisabledForTesting")}}),Jl(Kc.prototype,{confirm:{name:"confirm",j:[Ml("verificationCode")]}}),zl(Qr,"fromJSON",function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[ao,wo,ko,io],i=0;i<n.length;i++)if(e=n[i](t))return e;return null},[Xl(Ml(),Ul(),"json")]),zl(Io,"credential",function(t,e){return new yo(t,e)},[Ml("email"),Ml("password")]),Jl(yo.prototype,{w:{name:"toJSON",j:[Ml(null,!0)]}}),Jl(ho.prototype,{Ca:{name:"addScope",j:[Ml("scope")]},Ka:{name:"setCustomParameters",j:[Ul("customOAuthParameters")]}}),zl(ho,"credential",lo,[Xl(Ml(),Ul(),"token")]),zl(Io,"credentialWithLink",To,[Ml("email"),Ml("emailLink")]),Jl(fo.prototype,{Ca:{name:"addScope",j:[Ml("scope")]},Ka:{name:"setCustomParameters",j:[Ul("customOAuthParameters")]}}),zl(fo,"credential",po,[Xl(Ml(),Ul(),"token")]),Jl(vo.prototype,{Ca:{name:"addScope",j:[Ml("scope")]},Ka:{name:"setCustomParameters",j:[Ul("customOAuthParameters")]}}),zl(vo,"credential",mo,[Xl(Ml(),Xl(Ul(),Fl()),"idToken"),Xl(Ml(),Fl(),"accessToken",!0)]),Jl(go.prototype,{Ka:{name:"setCustomParameters",j:[Ul("customOAuthParameters")]}}),zl(go,"credential",bo,[Xl(Ml(),Ul(),"token"),Ml("secret",!0)]),Jl(co.prototype,{Ca:{name:"addScope",j:[Ml("scope")]},credential:{name:"credential",j:[Xl(Ml(),Xl(Ul(),Fl()),"optionsOrIdToken"),Xl(Ml(),Fl(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Ul("customOAuthParameters")]}}),Jl(ro.prototype,{w:{name:"toJSON",j:[Ml(null,!0)]}}),Jl(eo.prototype,{w:{name:"toJSON",j:[Ml(null,!0)]}}),zl(No,"credential",_o,[Ml("verificationId"),Ml("verificationCode")]),Jl(No.prototype,{gb:{name:"verifyPhoneNumber",j:[Xl(Ml(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?Gl(t.session,$r)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Gl(t.session,Zr)&&Bl(t.multiFactorHint):t.session&&t.multiFactorUid?Gl(t.session,Zr)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),Wl()]}}),Jl(Ao.prototype,{w:{name:"toJSON",j:[Ml(null,!0)]}}),Jl(T.prototype,{toJSON:{name:"toJSON",j:[Ml(null,!0)]}}),Jl(jo.prototype,{toJSON:{name:"toJSON",j:[Ml(null,!0)]}}),Jl(Mo.prototype,{toJSON:{name:"toJSON",j:[Ml(null,!0)]}}),Jl(Yc.prototype,{toJSON:{name:"toJSON",j:[Ml(null,!0)]}}),Jl(Wc.prototype,{Rc:{name:"resolveSignIn",j:[Hl()]}}),Jl(eh.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[Hl(),Ml("displayName",!0)]},bd:{name:"unenroll",j:[Xl({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Bl},Ml(),"multiFactorInfoIdentifier")]}}),Jl(Pl.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),zl(lr,"parseLink",yr,[Ml("link")]),zl(bl,"assertion",function(t){return new Qc(t)},[ql("phone")]),function(){if(void 0===Zl.default||!Zl.default.INTERNAL||!Zl.default.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Qi,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:Zi,VERIFY_AND_CHANGE_EMAIL:tr,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Zh,AuthCredential:Qr,Error:T};zl(t,"EmailAuthProvider",Io,[]),zl(t,"FacebookAuthProvider",ho,[]),zl(t,"GithubAuthProvider",fo,[]),zl(t,"GoogleAuthProvider",vo,[]),zl(t,"TwitterAuthProvider",go,[]),zl(t,"OAuthProvider",co,[Ml("providerId")]),zl(t,"SAMLAuthProvider",uo,[Ml("providerId")]),zl(t,"PhoneAuthProvider",No,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof Zh)}}]),zl(t,"RecaptchaVerifier",Pl,[Xl(Ml(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Ul("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof Zl.default.app.App)}}]),zl(t,"ActionCodeURL",lr,[]),zl(t,"PhoneMultiFactorGenerator",bl,[]),Zl.default.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Zh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(t){t.getProvider("auth-internal").initialize()}}),Zl.default.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:b((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:b(t.nc,t),addAuthTokenListener:b(t.cc,t),removeAuthTokenListener:b(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),Zl.default.registerVersion("@firebase/auth","0.16.8"),Zl.default.INTERNAL.extendNamespace({User:lh})}()}.apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}.apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-auth.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-auth.js.map

const auth = firebase.auth();

function signUp(){
    var email = document.getElementById("email");
    var password = document.getElementById("password");
    const promise = auth.createUserWithEmailAndPassword(email.value, password.value);
    promise.catch(function(e){
        console.log(e.message); 
        if(e.message == "The password must be 6 characters long or more.")
        {
            document.getElementById('email-message').innerHTML = "Empty Password. The password must be 6 characters long or more.";
            document.getElementById('email-message').style.color = "#ff0000";
            errorM = e.message;
            window.setTimeout(function(){document.getElementById('email-message').style.color = "transparent";},3000);
        }
        else if(e.message == "Password should be at least 6 characters"){
            document.getElementById('email-message').innerHTML = "Password should be at least 6 characters";
            document.getElementById('email-message').style.color = "#ff0000";
            errorM = e.message;
            window.setTimeout(function(){document.getElementById('email-message').style.color = "transparent";},3000);
        }
        else if(e.message == "The email address is already in use by another account.")
        {
            document.getElementById('email-message').innerHTML = "The email address is already in use by another account.";
            document.getElementById('email-message').style.color = "#ff0000";
            errorM = e.message;
            window.setTimeout(function(){document.getElementById('email-message').style.color = "transparent";},3000);
        }
        else if(e.message == "The email address is badly formatted."){
            document.getElementById('email-message').innerHTML = "Please enter a valid email address.";
            document.getElementById('email-message').style.color = "#ff0000";
            errorM = e.message;
            window.setTimeout(function(){document.getElementById('email-message').style.color = "transparent";},3000);           
        }
    });
}

function signIn(){
    var email = document.getElementById("email1");
    var password = document.getElementById("password1");
    let errorM;
    const promise = auth.signInWithEmailAndPassword(email.value, password.value);
    promise.catch(function(e){
        console.log(e.message); 
        if(e.message == "The email address is badly formatted.")
        {
            document.getElementById('email-message1').innerHTML = "Please enter a valid email address.";
            document.getElementById('email-message1').style.color = "#ff0000";
            errorM = e.message;
            window.setTimeout(function(){document.getElementById('email-message1').style.color = "transparent";},3000);
        }
        else if(e.message == "The password is invalid or the user does not have a password.")
        {
            document.getElementById('email-message1').innerHTML = "Password blank or does not match email record";
            document.getElementById('email-message1').style.color = "#ff0000";
            errorM = e.message;
            window.setTimeout(function(){document.getElementById('email-message1').style.color = "transparent";},3000);
        }
        else if(e.message == "There is no user record corresponding to this identifier. The user may have been deleted.")
        {
            document.getElementById('email-message1').innerHTML = "Invalid email and password combination or The user may have been deleted";
            document.getElementById('email-message1').style.color = "#ff0000";
            errorM = e.message;
            window.setTimeout(function(){document.getElementById('email-message1').style.color = "transparent";},3000);
        }
    });
}

function resetPass(){
    var email = document.getElementById("email2").value;
    console.log(email);
    auth.sendPasswordResetEmail(email).then(() => {
        console.log("Password reset Email Sent");
        document.getElementById('email-message2').innerHTML = "An email has been sent to your inbox with password reset link. Kindly check.";
        document.getElementById('email-message2').setAttribute("style", "color: #27a300; font-size: 20px; margin-top: 20px;");
    }).catch(error =>{
        console.log(error);
    })
}

function signOut(){
    auth.signOut();
    if(window.location.pathname != "/signup.html"){
        window.location.href = "/signup.html";
    }

}

var counter = 0;

auth.onAuthStateChanged(function(user){

    if(user){
        var email = user.email;
        var name   = email.substring(0, email.lastIndexOf("@"));
        var domain = email.substring(email.lastIndexOf("@") +1);
        var div = document.getElementById('user');
        div.innerHTML += "<i class='fas fa-user'></i> welcome <span class='username' id='username'></span>" + name + "<span> </span><i class='fas fa-chevron-circle-down' id='menuArrow'></i><div id='myDropdown' class='dropdown-content'><li><button onclick='signOut()' id='signOut' class='signOut'> Sign Out </button></li></div>";
        $(".read-full-article").empty();
        $(".read-full-article").html("Read Full Article");
        $(document).on('click', '#user', function(){
            $('#myDropdown').toggle();
            $("#menuArrow").toggleClass("rotated");
        });
        console.log(user.email);
        document.getElementById('signUp').style.width = "228px";
        document.getElementById('signUp').style.boxShadow = "none";
        var div1 = document.getElementById('signUp');
        div1.innerHTML = "";
        div1.innerHTML += "Creating An Account <img src='https://i.gifer.com/ZZ5H.gif' style='width:25px'>";

        auth.onAuthStateChanged(function(user){
            var email = user.email;
            console.log(user.email);
            counter = 1;
            if(user.email){
                $(".background-gradient").hide();
                $(".central-popup").hide();
                $(".close").hide();
                $(".login-button-top").hide();
            }
        });

        document.getElementById('signIn').style.width = "176px";
        document.getElementById('signIn').style.boxShadow = "none";
        var div = document.getElementById('signIn');
        div.innerHTML = "";
        div.innerHTML += "Logging You In <img src='https://i.gifer.com/ZZ5H.gif' style='width:25px'>";
    }

    else{
        var div = document.getElementById('user');
        div.innerHTML = "";
        div.innerHTML += "<span class='login-button-top'><i class='fas fa-user'></i><span> Login</span></span>";
        $(".read-full-article").html("Login To Apply");
    }
    $(document).on('click', '.login-button-top', function(){
        if(user){
            document.getElementsByClassName("read-full-article")[0].style.display="none";
            document.getElementsByClassName("bottom-gradient")[0].style.display="none";
            document.getElementsByClassName("content")[0].style.height="auto";
            document.getElementsByClassName("content")[0].style.backgroundColor="#fffeef";
        }      
        else{
            if(counter==0)
            {
            console.log("Login To Apply");
            $(".background-gradient").show();
            $(".central-popup").show();
            $(".close").show();
            }
        }
        });
});

    $(".close").click(function () {
    $(".background-gradient").hide();
    $(".central-popup").hide();
    $(".close").hide();
    });

    $(document).on('click', '.forgotPass', function(){
        $(".forgot").show();
        $(".middle").hide();
        $(".bottom").hide();
        $(".three").hide();
        $(".one-message").show();
        $("#message-text").html("Enter Email To Reset Password");
    });

    $(document).on('click', '.signin', function(){
        $(".bottom").show();
        $(".two-message").show();
        $(".three").show();
        $(".middle").hide();
        $(".one-message").hide();
        $(".forgot").hide();
        $("#message-text").html("Login To The Site");
    });

    window.setTimeout(function () {
        $(document).on('click', '.signup', function(){
            $(".middle").show();
            $(".one-message").show();
            $(".bottom").hide();
            $(".two-message").hide();
            $(".three").hide();
            $(".forgot").hide();
            $("#message-text").html("Create An Account");
        });
    }, 1500);